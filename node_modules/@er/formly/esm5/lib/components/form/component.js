/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectorRef, Component, Input } from '@angular/core';
import { BaseFormComponent } from '@er/core';
import { Subject } from 'rxjs';
var FormlyFormComponent = /** @class */ (function (_super) {
    tslib_1.__extends(FormlyFormComponent, _super);
    function FormlyFormComponent(cd) {
        var _this = _super.call(this, cd) || this;
        _this.cd = cd;
        _this.options = {};
        _this.valueChanges$ = new Subject();
        return _this;
    }
    Object.defineProperty(FormlyFormComponent.prototype, "formlyOptions", {
        get: /**
         * @return {?}
         */
        function () {
            return tslib_1.__assign({ fieldChanges: this.valueChanges$ }, this.options);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormlyFormComponent.prototype, "submitTips", {
        get: /**
         * @return {?}
         */
        function () {
            var _this = this;
            if (!this.form.valid) {
                /** @type {?} */
                var fields = this.getFormErrorFields();
                /** @type {?} */
                var labels_1 = [];
                fields.forEach(function (field) {
                    /** @type {?} */
                    var formlyField = _this.formlyField(field);
                    if (formlyField) {
                        /** @type {?} */
                        var label = formlyField.templateOptions && formlyField.templateOptions.label || field;
                        labels_1.push(label.replace(':', ''));
                    }
                });
                return "\u8BF7\u6B63\u786E\u5199\u4EE5\u4E0B\u4FE1\u606F\uFE0F\uFF1A" + labels_1.join(',');
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    FormlyFormComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        _super.prototype.ngOnInit.call(this);
        /** @type {?} */
        var valueChanges$ = this.options.fieldChanges || this.valueChanges$;
        if (this.valueChanges) {
            this.$subscriptions = valueChanges$.subscribe(function (event) {
                _this.valueChanges(tslib_1.__assign({}, event, { formlyForm: _this }));
            });
        }
    };
    /**
     * @param {?=} other
     * @return {?}
     */
    FormlyFormComponent.prototype.getEventContext = /**
     * @param {?=} other
     * @return {?}
     */
    function (other) {
        return _super.prototype.getEventContext.call(this, {
            fields: this.fields,
            formOptions: this.options,
            formProps: this.formProps,
            formlyForm: this
        });
    };
    /**
     * @param {?} key
     * @return {?}
     */
    FormlyFormComponent.prototype.formlyField = /**
     * @param {?} key
     * @return {?}
     */
    function (key) {
        /** @type {?} */
        var props = this.fields.filter(function (prop) { return prop.key === key; });
        return (props && props.length === 1) ? props[0] : undefined;
    };
    FormlyFormComponent.decorators = [
        { type: Component, args: [{
                    selector: 'er-formly-form',
                    template: "<div [ngClass]=\"styleClass\" [ngStyle]=\"style\">\n  <ng-container *ngIf=\"header\">\n    <er-dyna-content [content]=\"header\"></er-dyna-content>\n  </ng-container>\n  <ng-container *ngIf=\"template(templateNames.header)\">\n    <ng-container *ngTemplateOutlet=\"template(templateNames.header);\n                                     context: getEventContext()\"></ng-container>\n  </ng-container>\n\n  <form [formGroup]=\"form\" [ngClass]=\"formStyleClass || 'mt-2'\" [ngStyle]=\"formStyle\" novalidate>\n    <formly-form [form]=\"form\"\n                 [options]=\"formlyOptions\"\n                 [(model)]=\"model\"\n                 [fields]=\"fields\"\n                 class=\"formly-form\">\n      <ng-content></ng-content>\n      <ng-container *ngTemplateOutlet=\"template(templateNames.buttons,default)\"></ng-container>\n    </formly-form>\n  </form>\n  <ng-container *ngIf=\"footer\">\n    <er-dyna-content [content]=\"footer\"></er-dyna-content>\n  </ng-container>\n  <ng-container *ngIf=\"template(templateNames.footer)\">\n    <ng-container *ngTemplateOutlet=\"template(templateNames.footer);\n                                     context: getEventContext()\"></ng-container>\n  </ng-container>\n</div>\n\n<ng-template #default>\n  <div [ngClass]=\"buttonsStyleClass\">\n    <er-button [stateKey]=\"formId\"\n               icon=\"fa fa-save\"\n               label=\"\u63D0&nbsp;&nbsp;&nbsp;\u4EA4\"\n               title=\"\u4FDD\u7559\u6570\u636E\u5230\u670D\u52A1\u7AEF\"\n               class=\"mr-2\"\n               type=\"button\"\n               [pTooltip]=\"submitTips\"\n               tooltipPosition=\"top\"\n               [tooltipDisabled]=\"form.valid\"\n               [disabled]=\"!form.valid\"\n               (onClick)=\"submit()\"\n               [styleClass]=\"submitBtnStyleClass\"\n    ></er-button>\n    <er-button icon=\"fa fa-circle-o\"\n               class=\"mr-2\"\n               label=\"\u91CD&nbsp;&nbsp;&nbsp;\u586B\"\n               title=\"\u6062\u590D\u5230\u4FEE\u6539\u524D\u7684\u72B6\u6001\"\n               [styleClass]=\"resetBtnStyleClass\"\n               (onClick)=\"resetModel()\">\n    </er-button>\n\n    <ng-container *ngFor=\"let btn of buttons\">\n      <er-button class=\"mr-2\" erPropsBind [props]=\"btn\" [context]=\"getEventContext(btn.context)\"></er-button>\n    </ng-container>\n\n  </div>\n</ng-template>\n"
                }] }
    ];
    /** @nocollapse */
    FormlyFormComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef }
    ]; };
    FormlyFormComponent.propDecorators = {
        fields: [{ type: Input }],
        options: [{ type: Input }]
    };
    return FormlyFormComponent;
}(BaseFormComponent));
export { FormlyFormComponent };
if (false) {
    /** @type {?} */
    FormlyFormComponent.prototype.fields;
    /** @type {?} */
    FormlyFormComponent.prototype.options;
    /** @type {?} */
    FormlyFormComponent.prototype.formProps;
    /** @type {?} */
    FormlyFormComponent.prototype.valueChanges$;
    /**
     * @type {?}
     * @protected
     */
    FormlyFormComponent.prototype.cd;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVyL2Zvcm1seS8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2Zvcm0vY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFDLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbEUsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sVUFBVSxDQUFDO0FBSTNDLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFHN0I7SUFJeUMsK0NBQWlCO0lBVXhELDZCQUFzQixFQUFxQjtRQUEzQyxZQUNFLGtCQUFNLEVBQUUsQ0FBQyxTQUNWO1FBRnFCLFFBQUUsR0FBRixFQUFFLENBQW1CO1FBTmxDLGFBQU8sR0FBc0IsRUFBRSxDQUFDO1FBSXpDLG1CQUFhLEdBQW9DLElBQUksT0FBTyxFQUFFLENBQUM7O0lBSS9ELENBQUM7SUFFRCxzQkFBSSw4Q0FBYTs7OztRQUFqQjtZQUNFLDBCQUNFLFlBQVksRUFBRSxJQUFJLENBQUMsYUFBYSxJQUM3QixJQUFJLENBQUMsT0FBTyxFQUNmO1FBQ0osQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSwyQ0FBVTs7OztRQUFkO1lBQUEsaUJBYUM7WUFaQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUU7O29CQUNkLE1BQU0sR0FBRyxJQUFJLENBQUMsa0JBQWtCLEVBQUU7O29CQUNsQyxRQUFNLEdBQUcsRUFBRTtnQkFDakIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFBLEtBQUs7O3dCQUNaLFdBQVcsR0FBRyxLQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQztvQkFDM0MsSUFBSSxXQUFXLEVBQUU7OzRCQUNULEtBQUssR0FBRyxXQUFXLENBQUMsZUFBZSxJQUFJLFdBQVcsQ0FBQyxlQUFlLENBQUMsS0FBSyxJQUFJLEtBQUs7d0JBQ3ZGLFFBQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztxQkFDckM7Z0JBQ0gsQ0FBQyxDQUFDLENBQUM7Z0JBQ0gsT0FBTyxpRUFBYSxRQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBRyxDQUFDO2FBQ3hDO1FBQ0gsQ0FBQzs7O09BQUE7Ozs7SUFFRCxzQ0FBUTs7O0lBQVI7UUFBQSxpQkFXQztRQVZDLGlCQUFNLFFBQVEsV0FBRSxDQUFDOztZQUNYLGFBQWEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksSUFBSSxJQUFJLENBQUMsYUFBYTtRQUNyRSxJQUFJLElBQUksQ0FBQyxZQUFZLEVBQUU7WUFDckIsSUFBSSxDQUFDLGNBQWMsR0FBRyxhQUFhLENBQUMsU0FBUyxDQUFDLFVBQUEsS0FBSztnQkFDakQsS0FBSSxDQUFDLFlBQVksc0JBQ1osS0FBSyxJQUNSLFVBQVUsRUFBRSxLQUFJLElBQ2hCLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQzs7Ozs7SUFFRCw2Q0FBZTs7OztJQUFmLFVBQWdCLEtBQU07UUFDcEIsT0FBTyxpQkFBTSxlQUFlLFlBQUM7WUFDM0IsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNO1lBQ25CLFdBQVcsRUFBRSxJQUFJLENBQUMsT0FBTztZQUN6QixTQUFTLEVBQUUsSUFBSSxDQUFDLFNBQVM7WUFDekIsVUFBVSxFQUFFLElBQUk7U0FDakIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQzs7Ozs7SUFFRCx5Q0FBVzs7OztJQUFYLFVBQVksR0FBRzs7WUFDUCxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxJQUFJLENBQUMsR0FBRyxLQUFLLEdBQUcsRUFBaEIsQ0FBZ0IsQ0FBQztRQUMxRCxPQUFPLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQzlELENBQUM7O2dCQWpFRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLGdCQUFnQjtvQkFDMUIsNjFFQUF1QjtpQkFDeEI7Ozs7Z0JBWE8saUJBQWlCOzs7eUJBY3RCLEtBQUs7MEJBRUwsS0FBSzs7SUEyRFIsMEJBQUM7Q0FBQSxBQW5FRCxDQUl5QyxpQkFBaUIsR0ErRHpEO1NBL0RZLG1CQUFtQjs7O0lBRTlCLHFDQUF1Qzs7SUFFdkMsc0NBQXlDOztJQUV6Qyx3Q0FBcUI7O0lBRXJCLDRDQUErRDs7Ozs7SUFFbkQsaUNBQStCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBJbnB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0Jhc2VGb3JtQ29tcG9uZW50fSBmcm9tICdAZXIvY29yZSc7XG5pbXBvcnQge0Zvcm1Qcm9wc30gZnJvbSAnQGVyL3R5cGVzJztcbmltcG9ydCB7Rm9ybWx5Rm9ybU9wdGlvbnN9IGZyb20gJ0BuZ3gtZm9ybWx5L2NvcmUnO1xuaW1wb3J0IHtGb3JtbHlWYWx1ZUNoYW5nZUV2ZW50fSBmcm9tICdAbmd4LWZvcm1seS9jb3JlL2xpYi9jb21wb25lbnRzL2Zvcm1seS5maWVsZC5jb25maWcnO1xuaW1wb3J0IHtTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7RXJGb3JtbHlGaWVsZENvbmZpZ30gZnJvbSAnLi4vLi4vYmFzZS9maWVsZC1jb25maWcnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdlci1mb3JtbHktZm9ybScsXG4gIHRlbXBsYXRlVXJsOiAndHBsLmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIEZvcm1seUZvcm1Db21wb25lbnQgZXh0ZW5kcyBCYXNlRm9ybUNvbXBvbmVudCB7XG5cbiAgQElucHV0KCkgZmllbGRzOiBFckZvcm1seUZpZWxkQ29uZmlnW107XG5cbiAgQElucHV0KCkgb3B0aW9uczogRm9ybWx5Rm9ybU9wdGlvbnMgPSB7fTtcblxuICBmb3JtUHJvcHM6IEZvcm1Qcm9wcztcblxuICB2YWx1ZUNoYW5nZXMkOiBTdWJqZWN0PEZvcm1seVZhbHVlQ2hhbmdlRXZlbnQ+ID0gbmV3IFN1YmplY3QoKTtcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgY2Q6IENoYW5nZURldGVjdG9yUmVmKSB7XG4gICAgc3VwZXIoY2QpO1xuICB9XG5cbiAgZ2V0IGZvcm1seU9wdGlvbnMoKTogRm9ybWx5Rm9ybU9wdGlvbnMge1xuICAgIHJldHVybiB7XG4gICAgICBmaWVsZENoYW5nZXM6IHRoaXMudmFsdWVDaGFuZ2VzJCxcbiAgICAgIC4uLnRoaXMub3B0aW9uc1xuICAgIH07XG4gIH1cblxuICBnZXQgc3VibWl0VGlwcygpIHtcbiAgICBpZiAoIXRoaXMuZm9ybS52YWxpZCkge1xuICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5nZXRGb3JtRXJyb3JGaWVsZHMoKTtcbiAgICAgIGNvbnN0IGxhYmVscyA9IFtdO1xuICAgICAgZmllbGRzLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICBjb25zdCBmb3JtbHlGaWVsZCA9IHRoaXMuZm9ybWx5RmllbGQoZmllbGQpO1xuICAgICAgICBpZiAoZm9ybWx5RmllbGQpIHtcbiAgICAgICAgICBjb25zdCBsYWJlbCA9IGZvcm1seUZpZWxkLnRlbXBsYXRlT3B0aW9ucyAmJiBmb3JtbHlGaWVsZC50ZW1wbGF0ZU9wdGlvbnMubGFiZWwgfHwgZmllbGQ7XG4gICAgICAgICAgbGFiZWxzLnB1c2gobGFiZWwucmVwbGFjZSgnOicsICcnKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGDor7fmraPnoa7lhpnku6XkuIvkv6Hmga/vuI/vvJoke2xhYmVscy5qb2luKCcsJyl9YDtcbiAgICB9XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBzdXBlci5uZ09uSW5pdCgpO1xuICAgIGNvbnN0IHZhbHVlQ2hhbmdlcyQgPSB0aGlzLm9wdGlvbnMuZmllbGRDaGFuZ2VzIHx8IHRoaXMudmFsdWVDaGFuZ2VzJDtcbiAgICBpZiAodGhpcy52YWx1ZUNoYW5nZXMpIHtcbiAgICAgIHRoaXMuJHN1YnNjcmlwdGlvbnMgPSB2YWx1ZUNoYW5nZXMkLnN1YnNjcmliZShldmVudCA9PiB7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VzKHtcbiAgICAgICAgICAuLi5ldmVudCxcbiAgICAgICAgICBmb3JtbHlGb3JtOiB0aGlzXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0RXZlbnRDb250ZXh0KG90aGVyPykge1xuICAgIHJldHVybiBzdXBlci5nZXRFdmVudENvbnRleHQoe1xuICAgICAgZmllbGRzOiB0aGlzLmZpZWxkcyxcbiAgICAgIGZvcm1PcHRpb25zOiB0aGlzLm9wdGlvbnMsXG4gICAgICBmb3JtUHJvcHM6IHRoaXMuZm9ybVByb3BzLFxuICAgICAgZm9ybWx5Rm9ybTogdGhpc1xuICAgIH0pO1xuICB9XG5cbiAgZm9ybWx5RmllbGQoa2V5KSB7XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLmZpZWxkcy5maWx0ZXIocHJvcCA9PiBwcm9wLmtleSA9PT0ga2V5KTtcbiAgICByZXR1cm4gKHByb3BzICYmIHByb3BzLmxlbmd0aCA9PT0gMSkgPyBwcm9wc1swXSA6IHVuZGVmaW5lZDtcbiAgfVxuXG59XG4iXX0=