/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { CommonsUtils } from '../comm';
export class DataItemUtils {
    /**
     * @param {?} items
     * @param {?} config
     * @return {?}
     */
    static transItems(items, config) {
        if (!config) {
            return items;
        }
        /** @type {?} */
        let _data = [];
        /** @type {?} */
        const groups = {};
        items.map((item) => {
            _data.push(DataItemUtils.transItem(item, config));
        });
        if (config.groupKey) {
            _data.map(item => {
                /** @type {?} */
                const group = DataItemUtils.getItemLabel(item, config.groupKey || 'group');
                if (!groups[group]) {
                    groups[group] = [];
                }
                groups[group].push(item);
            });
            _data = [];
            Object.keys(groups).forEach(group => {
                _data.push({
                    label: group,
                    items: groups[group]
                });
            });
        }
        return _data;
    }
    /**
     * @param {?} item
     * @param {?} config
     * @return {?}
     */
    static transItem(item, config) {
        /** @type {?} */
        const _item = {
            [DataItemUtils.ITEM_LABEL_KEY]: DataItemUtils.getItemLabel(item, config.labelKey || DataItemUtils.ITEM_LABEL_KEY),
            [DataItemUtils.ITEM_VALUE_KEY]: DataItemUtils.getItemValue(item, config.valueKey),
            [DataItemUtils.ITEM_DATA_KEY]: item
        };
        return _item;
    }
    /**
     * @param {?} item
     * @param {?} valueKey
     * @return {?}
     */
    static getItemValue(item, valueKey) {
        if (CommonsUtils.isString(item)) {
            return item;
        }
        if (CommonsUtils.isArray(item)) {
            return item.map(data => DataItemUtils.getItemValue(data, valueKey));
        }
        else {
            if (typeof valueKey === 'function') {
                return valueKey(item);
            }
            else if (CommonsUtils.isArray(valueKey)) {
                /** @type {?} */
                const value = {};
                valueKey.forEach(p => {
                    /** @type {?} */
                    const val = CommonsUtils.get(item, p);
                    if (val) {
                        value[p] = val;
                    }
                });
                return value;
            }
            return valueKey ? CommonsUtils.get(item, valueKey) : item;
        }
    }
    /**
     * @param {?} item
     * @param {?} label
     * @return {?}
     */
    static getItemLabel(item, label) {
        if (CommonsUtils.isFunction(label)) {
            return label(item);
        }
        else if (item) {
            if (CommonsUtils.isArray(label)) {
                /** @type {?} */
                const s = [];
                ((/** @type {?} */ (label))).forEach(key => {
                    /** @type {?} */
                    const lb = DataItemUtils.getLabel(item, key);
                    if (lb) {
                        s.push(lb);
                    }
                });
                return s;
            }
            else {
                return DataItemUtils.getLabel(item, label);
            }
        }
    }
    /**
     * @param {?} item
     * @param {?} labelKey
     * @return {?}
     */
    static getLabel(item, labelKey) {
        /** @type {?} */
        const aLabel = CommonsUtils.get(item, labelKey);
        if (aLabel) {
            return aLabel;
        }
        else if (item[DataItemUtils.ITEM_DATA_KEY]) {
            return CommonsUtils.get(item[DataItemUtils.ITEM_DATA_KEY], labelKey);
        }
        else {
            return item[Object.keys(item)[0]];
        }
    }
}
DataItemUtils.ITEM_LABEL_KEY = 'label';
DataItemUtils.ITEM_VALUE_KEY = 'value';
DataItemUtils.ITEM_GROUP_KEY = 'group';
DataItemUtils.ITEM_GROUP_ITEMS_KEY = 'items';
DataItemUtils.ITEM_DATA_KEY = 'data';
if (false) {
    /** @type {?} */
    DataItemUtils.ITEM_LABEL_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_VALUE_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_GROUP_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_GROUP_ITEMS_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_DATA_KEY;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdXRpbHMvIiwic291cmNlcyI6WyJsaWIvZGF0YS1pdGVtL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRXJDLE1BQU0sT0FBTyxhQUFhOzs7Ozs7SUFZeEIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsTUFBcUI7UUFDNUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNYLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7O1lBQ0csS0FBSyxHQUFVLEVBQUU7O2NBQ2YsTUFBTSxHQUE0QixFQUFFO1FBQzFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtZQUN0QixLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDcEQsQ0FBQyxDQUFDLENBQUM7UUFDSCxJQUFJLE1BQU0sQ0FBQyxRQUFRLEVBQUU7WUFDbkIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTs7c0JBQ1QsS0FBSyxHQUFHLGFBQWEsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxRQUFRLElBQUksT0FBTyxDQUFDO2dCQUMxRSxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUNsQixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO2lCQUNwQjtnQkFDRCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzNCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsS0FBSyxHQUFHLEVBQUUsQ0FBQztZQUNYLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUNsQyxLQUFLLENBQUMsSUFBSSxDQUFDO29CQUNULEtBQUssRUFBRSxLQUFLO29CQUNaLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDO2lCQUNyQixDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztTQUNKO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDOzs7Ozs7SUFFRCxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxNQUFxQjs7Y0FDcEMsS0FBSyxHQUFHO1lBQ1osQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDLEVBQUUsYUFBYSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLFFBQVEsSUFBSSxhQUFhLENBQUMsY0FBYyxDQUFDO1lBQ2pILENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxFQUFFLGFBQWEsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUM7WUFDakYsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLEVBQUUsSUFBSTtTQUNwQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQzs7Ozs7O0lBRUQsTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsUUFBUTtRQUNoQyxJQUFJLFlBQVksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDL0IsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUNELElBQUksWUFBWSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUM5QixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1NBQ3JFO2FBQU07WUFDTCxJQUFJLE9BQU8sUUFBUSxLQUFLLFVBQVUsRUFBRTtnQkFDbEMsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDdkI7aUJBQU0sSUFBSSxZQUFZLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFOztzQkFDbkMsS0FBSyxHQUFHLEVBQUU7Z0JBQ2hCLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUU7OzBCQUNiLEdBQUcsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7b0JBQ3JDLElBQUksR0FBRyxFQUFFO3dCQUNQLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7cUJBQ2hCO2dCQUNILENBQUMsQ0FBQyxDQUFDO2dCQUNILE9BQU8sS0FBSyxDQUFDO2FBQ2Q7WUFDRCxPQUFPLFFBQVEsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztTQUMzRDtJQUNILENBQUM7Ozs7OztJQUVELE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEtBQUs7UUFDN0IsSUFBSSxZQUFZLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQ2xDLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3BCO2FBQU0sSUFBSSxJQUFJLEVBQUU7WUFDZixJQUFJLFlBQVksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7O3NCQUN6QixDQUFDLEdBQUcsRUFBRTtnQkFDWixDQUFDLG1CQUFVLEtBQUssRUFBQSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFOzswQkFDeEIsRUFBRSxHQUFHLGFBQWEsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQztvQkFDNUMsSUFBSSxFQUFFLEVBQUU7d0JBQ04sQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztxQkFDWjtnQkFDSCxDQUFDLENBQUMsQ0FBQztnQkFDSCxPQUFPLENBQUMsQ0FBQzthQUNWO2lCQUFNO2dCQUNMLE9BQU8sYUFBYSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDNUM7U0FDRjtJQUNILENBQUM7Ozs7OztJQUVELE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLFFBQVE7O2NBQ3RCLE1BQU0sR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUM7UUFDL0MsSUFBSSxNQUFNLEVBQUU7WUFDVixPQUFPLE1BQU0sQ0FBQztTQUNmO2FBQU0sSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQzVDLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1NBQ3RFO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbkM7SUFDSCxDQUFDOztBQWxHTSw0QkFBYyxHQUFHLE9BQU8sQ0FBQztBQUV6Qiw0QkFBYyxHQUFHLE9BQU8sQ0FBQztBQUV6Qiw0QkFBYyxHQUFHLE9BQU8sQ0FBQztBQUV6QixrQ0FBb0IsR0FBRyxPQUFPLENBQUM7QUFFL0IsMkJBQWEsR0FBRyxNQUFNLENBQUM7OztJQVI5Qiw2QkFBZ0M7O0lBRWhDLDZCQUFnQzs7SUFFaEMsNkJBQWdDOztJQUVoQyxtQ0FBc0M7O0lBRXRDLDRCQUE4QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RGF0YUl0ZW1Qcm9wc30gZnJvbSAnQGVyL3R5cGVzJztcbmltcG9ydCB7Q29tbW9uc1V0aWxzfSBmcm9tICcuLi9jb21tJztcblxuZXhwb3J0IGNsYXNzIERhdGFJdGVtVXRpbHMge1xuXG4gIHN0YXRpYyBJVEVNX0xBQkVMX0tFWSA9ICdsYWJlbCc7XG5cbiAgc3RhdGljIElURU1fVkFMVUVfS0VZID0gJ3ZhbHVlJztcblxuICBzdGF0aWMgSVRFTV9HUk9VUF9LRVkgPSAnZ3JvdXAnO1xuXG4gIHN0YXRpYyBJVEVNX0dST1VQX0lURU1TX0tFWSA9ICdpdGVtcyc7XG5cbiAgc3RhdGljIElURU1fREFUQV9LRVkgPSAnZGF0YSc7XG5cbiAgc3RhdGljIHRyYW5zSXRlbXMoaXRlbXMsIGNvbmZpZzogRGF0YUl0ZW1Qcm9wcykge1xuICAgIGlmICghY29uZmlnKSB7XG4gICAgICByZXR1cm4gaXRlbXM7XG4gICAgfVxuICAgIGxldCBfZGF0YTogYW55W10gPSBbXTtcbiAgICBjb25zdCBncm91cHM6IHsgW2tleTogc3RyaW5nXToge31bXSB9ID0ge307XG4gICAgaXRlbXMubWFwKChpdGVtOiBhbnkpID0+IHtcbiAgICAgIF9kYXRhLnB1c2goRGF0YUl0ZW1VdGlscy50cmFuc0l0ZW0oaXRlbSwgY29uZmlnKSk7XG4gICAgfSk7XG4gICAgaWYgKGNvbmZpZy5ncm91cEtleSkge1xuICAgICAgX2RhdGEubWFwKGl0ZW0gPT4ge1xuICAgICAgICBjb25zdCBncm91cCA9IERhdGFJdGVtVXRpbHMuZ2V0SXRlbUxhYmVsKGl0ZW0sIGNvbmZpZy5ncm91cEtleSB8fCAnZ3JvdXAnKTtcbiAgICAgICAgaWYgKCFncm91cHNbZ3JvdXBdKSB7XG4gICAgICAgICAgZ3JvdXBzW2dyb3VwXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGdyb3Vwc1tncm91cF0ucHVzaChpdGVtKTtcbiAgICAgIH0pO1xuICAgICAgX2RhdGEgPSBbXTtcbiAgICAgIE9iamVjdC5rZXlzKGdyb3VwcykuZm9yRWFjaChncm91cCA9PiB7XG4gICAgICAgIF9kYXRhLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiBncm91cCxcbiAgICAgICAgICBpdGVtczogZ3JvdXBzW2dyb3VwXVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gX2RhdGE7XG4gIH1cblxuICBzdGF0aWMgdHJhbnNJdGVtKGl0ZW0sIGNvbmZpZzogRGF0YUl0ZW1Qcm9wcykge1xuICAgIGNvbnN0IF9pdGVtID0ge1xuICAgICAgW0RhdGFJdGVtVXRpbHMuSVRFTV9MQUJFTF9LRVldOiBEYXRhSXRlbVV0aWxzLmdldEl0ZW1MYWJlbChpdGVtLCBjb25maWcubGFiZWxLZXkgfHwgRGF0YUl0ZW1VdGlscy5JVEVNX0xBQkVMX0tFWSksXG4gICAgICBbRGF0YUl0ZW1VdGlscy5JVEVNX1ZBTFVFX0tFWV06IERhdGFJdGVtVXRpbHMuZ2V0SXRlbVZhbHVlKGl0ZW0sIGNvbmZpZy52YWx1ZUtleSksXG4gICAgICBbRGF0YUl0ZW1VdGlscy5JVEVNX0RBVEFfS0VZXTogaXRlbVxuICAgIH07XG4gICAgcmV0dXJuIF9pdGVtO1xuICB9XG5cbiAgc3RhdGljIGdldEl0ZW1WYWx1ZShpdGVtLCB2YWx1ZUtleSkge1xuICAgIGlmIChDb21tb25zVXRpbHMuaXNTdHJpbmcoaXRlbSkpIHtcbiAgICAgIHJldHVybiBpdGVtO1xuICAgIH1cbiAgICBpZiAoQ29tbW9uc1V0aWxzLmlzQXJyYXkoaXRlbSkpIHtcbiAgICAgIHJldHVybiBpdGVtLm1hcChkYXRhID0+IERhdGFJdGVtVXRpbHMuZ2V0SXRlbVZhbHVlKGRhdGEsIHZhbHVlS2V5KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWVLZXkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlS2V5KGl0ZW0pO1xuICAgICAgfSBlbHNlIGlmIChDb21tb25zVXRpbHMuaXNBcnJheSh2YWx1ZUtleSkpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB7fTtcbiAgICAgICAgdmFsdWVLZXkuZm9yRWFjaChwID0+IHtcbiAgICAgICAgICBjb25zdCB2YWwgPSBDb21tb25zVXRpbHMuZ2V0KGl0ZW0sIHApO1xuICAgICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICAgIHZhbHVlW3BdID0gdmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZUtleSA/IENvbW1vbnNVdGlscy5nZXQoaXRlbSwgdmFsdWVLZXkpIDogaXRlbTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZ2V0SXRlbUxhYmVsKGl0ZW0sIGxhYmVsKSB7XG4gICAgaWYgKENvbW1vbnNVdGlscy5pc0Z1bmN0aW9uKGxhYmVsKSkge1xuICAgICAgcmV0dXJuIGxhYmVsKGl0ZW0pO1xuICAgIH0gZWxzZSBpZiAoaXRlbSkge1xuICAgICAgaWYgKENvbW1vbnNVdGlscy5pc0FycmF5KGxhYmVsKSkge1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICg8c3RyaW5nW10+bGFiZWwpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICBjb25zdCBsYiA9IERhdGFJdGVtVXRpbHMuZ2V0TGFiZWwoaXRlbSwga2V5KTtcbiAgICAgICAgICBpZiAobGIpIHtcbiAgICAgICAgICAgIHMucHVzaChsYik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gRGF0YUl0ZW1VdGlscy5nZXRMYWJlbChpdGVtLCBsYWJlbCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGdldExhYmVsKGl0ZW0sIGxhYmVsS2V5KSB7XG4gICAgY29uc3QgYUxhYmVsID0gQ29tbW9uc1V0aWxzLmdldChpdGVtLCBsYWJlbEtleSk7XG4gICAgaWYgKGFMYWJlbCkge1xuICAgICAgcmV0dXJuIGFMYWJlbDtcbiAgICB9IGVsc2UgaWYgKGl0ZW1bRGF0YUl0ZW1VdGlscy5JVEVNX0RBVEFfS0VZXSkge1xuICAgICAgcmV0dXJuIENvbW1vbnNVdGlscy5nZXQoaXRlbVtEYXRhSXRlbVV0aWxzLklURU1fREFUQV9LRVldLCBsYWJlbEtleSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBpdGVtW09iamVjdC5rZXlzKGl0ZW0pWzBdXTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==