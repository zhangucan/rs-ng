/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { DateUtils } from '../date';
export class IdCardUtils {
    /**
     * @param {?} idCardNo
     * @return {?}
     */
    static test(idCardNo) {
        /** @type {?} */
        const format = /^(([1][1-5])|([2][1-3])|([3][1-7])|([4][1-6])|([5][0-4])|([6][1-5])|([7][1])|([8][1-2]))\d{4}(([1][9]\d{2})|([2]\d{3}))(([0][1-9])|([1][0-2]))(([0][1-9])|([1-2][0-9])|([3][0-1]))\d{3}[0-9xX]$/;
        if (!format.test(idCardNo)) {
            return { status: false, 'msg': '身份证号码不合规' };
        }
        /** @type {?} */
        const year = idCardNo.substr(6, 4);
        /** @type {?} */
        const month = idCardNo.substr(10, 2);
        /** @type {?} */
        const date = idCardNo.substr(12, 2);
        /** @type {?} */
        const time = Date.parse(month + '-' + date + '-' + year);
        /** @type {?} */
        const now_time = Date.parse(DateUtils.getDate());
        /** @type {?} */
        const dates = (new Date(year, month, 0)).getDate();
        if (time > now_time || date > dates) {
            return { status: false, msg: '出生日期不合规' };
        }
        /** @type {?} */
        const c = new Array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2);
        /** @type {?} */
        const b = new Array('1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2');
        /** @type {?} */
        const id_array = idCardNo.split('');
        /** @type {?} */
        let sum = 0;
        for (let k = 0; k < 17; k++) {
            sum += parseInt(id_array[k]) * c[k];
        }
        if (id_array[17].toUpperCase() !== b[sum % 11].toUpperCase()) {
            return { status: false, msg: '身份证校验码不合规' };
        }
        return { status: true };
    }
    /**
     * @param {?} idCardNo
     * @return {?}
     */
    static parse(idCardNo) {
        if (!IdCardUtils.test(idCardNo).status) {
            return {};
        }
        /** @type {?} */
        const res = {};
        /** @type {?} */
        const idxSexStart = idCardNo.length === 15 ? 14 : 16;
        /** @type {?} */
        const birthYearSpan = idCardNo.length === 15 ? 2 : 4;
        /** @type {?} */
        const idxSex = 1 - idCardNo.substr(idxSexStart, 1) % 2;
        res.gender = (idxSex === 1 ? '女' : '男');
        /** @type {?} */
        const year = (birthYearSpan === 2 ? '19' : '') + idCardNo.substr(6, birthYearSpan);
        /** @type {?} */
        const month = idCardNo.substr(6 + birthYearSpan, 2);
        /** @type {?} */
        const day = idCardNo.substr(8 + birthYearSpan, 2);
        res.birthday = year + '-' + month + '-' + day;
        /** @type {?} */
        const d = DateUtils.getDate();
        /** @type {?} */
        const monthFloor = ((d.getMonth() + 1) < parseInt(month, 10) || (d.getMonth() + 1) === parseInt(month, 10) && d.getDate() < parseInt(day, 10)) ? 1 : 0;
        res.age = d.getFullYear() - parseInt(year, 10) - monthFloor;
        return res;
    }
    ;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdXRpbHMvIiwic291cmNlcyI6WyJsaWIvaWQtY2FyZC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUVsQyxNQUFNLE9BQU8sV0FBVzs7Ozs7SUFFdEIsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFROztjQUVaLE1BQU0sR0FBRyxpTUFBaU07UUFFaE4sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDMUIsT0FBTyxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBQyxDQUFDO1NBQzNDOztjQUVLLElBQUksR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7O2NBQ2hDLEtBQUssR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7O2NBQzlCLElBQUksR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7O2NBQzdCLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7O2NBQ2xELFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsQ0FBQzs7Y0FDMUMsS0FBSyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRTtRQUM5QyxJQUFJLElBQUksR0FBRyxRQUFRLElBQUksSUFBSSxHQUFHLEtBQUssRUFBRTtZQUNuQyxPQUFPLEVBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFDLENBQUM7U0FDeEM7O2NBRUssQ0FBQyxHQUFH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QUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLEdBQUcsUUFBUSxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEosR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLEdBQUcsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsR0FBRyxVQUFVLENBQUM7UUFFNUQsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBQUEsQ0FBQztDQUVIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEYXRlVXRpbHN9IGZyb20gJy4uL2RhdGUnO1xuXG5leHBvcnQgY2xhc3MgSWRDYXJkVXRpbHMge1xuXG4gIHN0YXRpYyB0ZXN0KGlkQ2FyZE5vKSB7XG5cbiAgICBjb25zdCBmb3JtYXQgPSAvXigoWzFdWzEtNV0pfChbMl1bMS0zXSl8KFszXVsxLTddKXwoWzRdWzEtNl0pfChbNV1bMC00XSl8KFs2XVsxLTVdKXwoWzddWzFdKXwoWzhdWzEtMl0pKVxcZHs0fSgoWzFdWzldXFxkezJ9KXwoWzJdXFxkezN9KSkoKFswXVsxLTldKXwoWzFdWzAtMl0pKSgoWzBdWzEtOV0pfChbMS0yXVswLTldKXwoWzNdWzAtMV0pKVxcZHszfVswLTl4WF0kLztcblxuICAgIGlmICghZm9ybWF0LnRlc3QoaWRDYXJkTm8pKSB7XG4gICAgICByZXR1cm4ge3N0YXR1czogZmFsc2UsICdtc2cnOiAn6Lqr5Lu96K+B5Y+356CB5LiN5ZCI6KeEJ307XG4gICAgfVxuXG4gICAgY29uc3QgeWVhciA9IGlkQ2FyZE5vLnN1YnN0cig2LCA0KSxcbiAgICAgIG1vbnRoID0gaWRDYXJkTm8uc3Vic3RyKDEwLCAyKSxcbiAgICAgIGRhdGUgPSBpZENhcmROby5zdWJzdHIoMTIsIDIpLFxuICAgICAgdGltZSA9IERhdGUucGFyc2UobW9udGggKyAnLScgKyBkYXRlICsgJy0nICsgeWVhciksXG4gICAgICBub3dfdGltZSA9IERhdGUucGFyc2UoRGF0ZVV0aWxzLmdldERhdGUoKSksXG4gICAgICBkYXRlcyA9IChuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkpLmdldERhdGUoKTtcbiAgICBpZiAodGltZSA+IG5vd190aW1lIHx8IGRhdGUgPiBkYXRlcykge1xuICAgICAgcmV0dXJuIHtzdGF0dXM6IGZhbHNlLCBtc2c6ICflh7rnlJ/ml6XmnJ/kuI3lkIjop4QnfTtcbiAgICB9XG5cbiAgICBjb25zdCBjID0gbmV3IEFycmF5KDcsIDksIDEwLCA1LCA4LCA0LCAyLCAxLCA2LCAzLCA3LCA5LCAxMCwgNSwgOCwgNCwgMik7XG4gICAgY29uc3QgYiA9IG5ldyBBcnJheSgnMScsICcwJywgJ1gnLCAnOScsICc4JywgJzcnLCAnNicsICc1JywgJzQnLCAnMycsICcyJyk7XG4gICAgY29uc3QgaWRfYXJyYXkgPSBpZENhcmROby5zcGxpdCgnJyk7XG4gICAgbGV0IHN1bSA9IDA7XG4gICAgZm9yIChsZXQgayA9IDA7IGsgPCAxNzsgaysrKSB7XG4gICAgICBzdW0gKz0gcGFyc2VJbnQoaWRfYXJyYXlba10pICogY1trXTtcbiAgICB9XG4gICAgaWYgKGlkX2FycmF5WzE3XS50b1VwcGVyQ2FzZSgpICE9PSBiW3N1bSAlIDExXS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICByZXR1cm4ge3N0YXR1czogZmFsc2UsIG1zZzogJ+i6q+S7veivgeagoemqjOeggeS4jeWQiOinhCd9O1xuICAgIH1cbiAgICByZXR1cm4ge3N0YXR1czogdHJ1ZX07XG4gIH1cblxuICBzdGF0aWMgcGFyc2UoaWRDYXJkTm8pOiB7IGdlbmRlcj86IHN0cmluZywgYmlydGhkYXk/OiBzdHJpbmcsIGFnZT86IG51bWJlciB9IHtcblxuICAgIGlmICghSWRDYXJkVXRpbHMudGVzdChpZENhcmRObykuc3RhdHVzKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgY29uc3QgcmVzOiB7IGdlbmRlcj86IHN0cmluZywgYmlydGhkYXk/OiBzdHJpbmcsIGFnZT86IG51bWJlciB9ID0ge307XG5cbiAgICBjb25zdCBpZHhTZXhTdGFydCA9IGlkQ2FyZE5vLmxlbmd0aCA9PT0gMTUgPyAxNCA6IDE2O1xuXG4gICAgY29uc3QgYmlydGhZZWFyU3BhbiA9IGlkQ2FyZE5vLmxlbmd0aCA9PT0gMTUgPyAyIDogNDtcblxuICAgIGNvbnN0IGlkeFNleCA9IDEgLSBpZENhcmROby5zdWJzdHIoaWR4U2V4U3RhcnQsIDEpICUgMjtcblxuICAgIHJlcy5nZW5kZXIgPSAoaWR4U2V4ID09PSAxID8gJ+WlsycgOiAn55S3Jyk7XG5cbiAgICBjb25zdCB5ZWFyID0gKGJpcnRoWWVhclNwYW4gPT09IDIgPyAnMTknIDogJycpICsgaWRDYXJkTm8uc3Vic3RyKDYsIGJpcnRoWWVhclNwYW4pO1xuICAgIGNvbnN0IG1vbnRoID0gaWRDYXJkTm8uc3Vic3RyKDYgKyBiaXJ0aFllYXJTcGFuLCAyKTtcbiAgICBjb25zdCBkYXkgPSBpZENhcmROby5zdWJzdHIoOCArIGJpcnRoWWVhclNwYW4sIDIpO1xuICAgIHJlcy5iaXJ0aGRheSA9IHllYXIgKyAnLScgKyBtb250aCArICctJyArIGRheTtcblxuICAgIGNvbnN0IGQgPSBEYXRlVXRpbHMuZ2V0RGF0ZSgpO1xuICAgIGNvbnN0IG1vbnRoRmxvb3IgPSAoKGQuZ2V0TW9udGgoKSArIDEpIDwgcGFyc2VJbnQobW9udGgsIDEwKSB8fCAoZC5nZXRNb250aCgpICsgMSkgPT09IHBhcnNlSW50KG1vbnRoLCAxMCkgJiYgZC5nZXREYXRlKCkgPCBwYXJzZUludChkYXksIDEwKSkgPyAxIDogMDtcbiAgICByZXMuYWdlID0gZC5nZXRGdWxsWWVhcigpIC0gcGFyc2VJbnQoeWVhciwgMTApIC0gbW9udGhGbG9vcjtcblxuICAgIHJldHVybiByZXM7XG4gIH07XG5cbn1cbiJdfQ==