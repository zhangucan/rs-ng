/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChartType } from '@er/types';
import { ColorUtils } from '../color';
import { CommonsUtils } from '../comm';
import { DataItemUtils } from '../data-item';
export class ChartUtils {
    /**
     * @param {?} rawData
     * @param {?} chartOptions
     * @param {?=} dimensionsIndex
     * @return {?}
     */
    static buildChartData(rawData, chartOptions, dimensionsIndex = 0) {
        /** @type {?} */
        const type = chartOptions.type;
        /** @type {?} */
        let data = rawData;
        /** @type {?} */
        const dimension = chartOptions.dimension || {};
        if (dimension.dataSrcPath) {
            data = CommonsUtils.get(rawData, dimension.dataSrcPath);
        }
        /** @type {?} */
        const dataItemProps = dimension.dataItemProps || chartOptions.dataItemProps;
        /** @type {?} */
        const label = dimension.title || '';
        switch (type || ChartType.BAR) {
            case ChartType.BAR:
                data = ChartUtils.buildBarChart(data, dataItemProps, label, dimensionsIndex);
                break;
            case ChartType.LINE:
                data = ChartUtils.buildLineChart(data, dataItemProps, label, dimensionsIndex);
                break;
            case ChartType.PIE:
                data = ChartUtils.buildPieChart(data, dataItemProps, label, dimensionsIndex);
                break;
            case ChartType.AREA:
                data = ChartUtils.buildAreaChart(data, dataItemProps, label, dimensionsIndex);
                break;
            case ChartType.RADAR:
                data = ChartUtils.buildRadarChart(data, dataItemProps, label, dimensionsIndex);
                break;
            case ChartType.DOUGHNUT:
                data = ChartUtils.buildPieChart(data, dataItemProps, label, dimensionsIndex);
                break;
        }
        return data;
    }
    /**
     * @param {?} dataItems
     * @param {?} config
     * @param {?=} label
     * @param {?=} colorIndex
     * @return {?}
     */
    static buildBarChart(dataItems, config, label = '', colorIndex = 0) {
        /** @type {?} */
        const _data = DataItemUtils.transItems(dataItems, config);
        /** @type {?} */
        const labels = [];
        /** @type {?} */
        const datasets = [];
        /** @type {?} */
        const data = [];
        /** @type {?} */
        const backgroundColor = [];
        /** @type {?} */
        const hoverBackgroundColor = [];
        /** @type {?} */
        const items = _data;
        items.forEach(item => {
            if (item['group']) {
                datasets.push({
                    label: items[''].label,
                    data: items[''].items,
                    backgroundColor: ColorUtils.getColor(items[''].label)
                });
                labels.push('');
            }
            else {
                /** @type {?} */
                const lb = item['key_as_string'] || item['label'];
                labels.push(lb);
                data.push(item['value']);
                backgroundColor.push(ColorUtils.getColor(lb, colorIndex));
                hoverBackgroundColor.push(ColorUtils.getColor(lb, colorIndex + 10));
            }
        });
        datasets.push({
            label: label,
            backgroundColor,
            hoverBackgroundColor,
            data
        });
        return {
            labels,
            datasets
        };
    }
    /**
     * @param {?} dataItems
     * @param {?} config
     * @param {?=} label
     * @param {?=} colorIndex
     * @return {?}
     */
    static buildPieChart(dataItems, config, label = '', colorIndex = 0) {
        /** @type {?} */
        const _data = DataItemUtils.transItems(dataItems, config);
        /** @type {?} */
        const labels = [];
        /** @type {?} */
        const datasets = [];
        /** @type {?} */
        const data = [];
        /** @type {?} */
        const backgroundColor = [];
        /** @type {?} */
        const hoverBackgroundColor = [];
        /** @type {?} */
        const items = _data;
        items.forEach(item => {
            if (item['group']) {
                datasets.push({
                    label: items[''].label,
                    data: items[''].items,
                    backgroundColor: ColorUtils.getColor(items[''].label)
                });
                labels.push('');
            }
            else {
                /** @type {?} */
                const lb = item['key_as_string'] || item['label'];
                labels.push(lb);
                data.push(item['value']);
                backgroundColor.push(ColorUtils.getColor(lb, colorIndex));
                hoverBackgroundColor.push(ColorUtils.getColor(lb, colorIndex + 10));
            }
        });
        datasets.push({
            label: label || '',
            backgroundColor,
            hoverBackgroundColor,
            data
        });
        return {
            labels,
            datasets
        };
    }
    /**
     * @param {?} dataItems
     * @param {?} config
     * @param {?=} label
     * @param {?=} colorIndex
     * @return {?}
     */
    static buildAreaChart(dataItems, config, label = '', colorIndex = 0) {
        /** @type {?} */
        const _data = DataItemUtils.transItems(dataItems, config);
        /** @type {?} */
        const labels = [];
        /** @type {?} */
        const datasets = [];
        /** @type {?} */
        const backgroundColor = [];
        /** @type {?} */
        const data = [];
        /** @type {?} */
        const items = _data;
        items.forEach(item => {
            if (item['group']) {
                datasets.push({
                    label: items[''].label,
                    data: items[''].items,
                    backgroundColor: ColorUtils.getColor(items[''].label)
                });
                labels.push('');
            }
            else {
                /** @type {?} */
                const lb = item['key_as_string'] || item['label'];
                labels.push(lb);
                data.push(item['value']);
                backgroundColor.push(ColorUtils.getColor(lb, colorIndex));
            }
        });
        datasets.push({
            label: label || '',
            data,
            backgroundColor
        });
        return {
            labels,
            datasets
        };
    }
    /**
     * @param {?} dataItems
     * @param {?} config
     * @param {?=} label
     * @param {?=} colorIndex
     * @return {?}
     */
    static buildLineChart(dataItems, config, label = '', colorIndex = 0) {
        /** @type {?} */
        const _data = DataItemUtils.transItems(dataItems, config);
        /** @type {?} */
        const labels = [];
        /** @type {?} */
        const datasets = [];
        /** @type {?} */
        const data = [];
        /** @type {?} */
        const items = _data;
        items.forEach(item => {
            if (item['group']) {
                datasets.push({
                    label: items[''].label,
                    data: items[''].items,
                    backgroundColor: ColorUtils.getColor(items[''].label)
                });
                labels.push('');
            }
            else {
                /** @type {?} */
                const lb = item['key_as_string'] || item['label'];
                labels.push(lb);
                data.push(item['value']);
            }
        });
        datasets.push({
            label: label || '',
            data,
            fill: false,
            borderColor: ColorUtils.getColor(colorIndex)
        });
        return {
            labels,
            datasets
        };
    }
    /**
     * @param {?} dataItems
     * @param {?} config
     * @param {?=} label
     * @param {?=} colorIndex
     * @return {?}
     */
    static buildRadarChart(dataItems, config, label = '', colorIndex = 0) {
        /** @type {?} */
        const _data = DataItemUtils.transItems(dataItems, config);
        /** @type {?} */
        const labels = [];
        /** @type {?} */
        const datasets = [];
        /** @type {?} */
        const backgroundColor = [];
        /** @type {?} */
        const borderColor = [];
        /** @type {?} */
        const pointBackgroundColor = [];
        /** @type {?} */
        const pointHoverBorderColor = [];
        /** @type {?} */
        const data = [];
        /** @type {?} */
        const items = _data;
        items.forEach(item => {
            if (item['group']) {
                datasets.push({
                    label: items[''].label,
                    data: items[''].items,
                    backgroundColor: ColorUtils.getColor(items[''].label)
                });
                labels.push('');
            }
            else {
                /** @type {?} */
                const lb = item['key_as_string'] || item['label'];
                labels.push(lb);
                data.push(item['value']);
                backgroundColor.push(ColorUtils.getColor(lb, colorIndex));
                borderColor.push(ColorUtils.getColor(lb, colorIndex + 5));
                pointBackgroundColor.push(ColorUtils.getColor(lb, colorIndex + 5));
                pointHoverBorderColor.push(ColorUtils.getColor(lb, colorIndex + 5));
            }
        });
        datasets.push({
            label: label || '',
            data,
            backgroundColor,
            borderColor,
            pointBackgroundColor,
            pointHoverBorderColor,
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff'
        });
        return {
            labels,
            datasets
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdXRpbHMvIiwic291cmNlcyI6WyJsaWIvY2hhcnQvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBaUIsU0FBUyxFQUFnQixNQUFNLFdBQVcsQ0FBQztBQUNuRSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDckMsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLGNBQWMsQ0FBQztBQUUzQyxNQUFNLE9BQU8sVUFBVTs7Ozs7OztJQUVyQixNQUFNLENBQUMsY0FBYyxDQUFDLE9BQVksRUFBRSxZQUFpRixFQUFFLGtCQUEwQixDQUFDOztjQUMxSSxJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUk7O1lBQzFCLElBQUksR0FBRyxPQUFPOztjQUNaLFNBQVMsR0FBRyxZQUFZLENBQUMsU0FBUyxJQUFJLEVBQUU7UUFDOUMsSUFBSSxTQUFTLENBQUMsV0FBVyxFQUFFO1lBQ3pCLElBQUksR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDekQ7O2NBQ0ssYUFBYSxHQUFHLFNBQVMsQ0FBQyxhQUFhLElBQUksWUFBWSxDQUFDLGFBQWE7O2NBQ3JFLEtBQUssR0FBRyxTQUFTLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbkMsUUFBUSxJQUFJLElBQUksU0FBUyxDQUFDLEdBQUcsRUFBRTtZQUM3QixLQUFLLFNBQVMsQ0FBQyxHQUFHO2dCQUNoQixJQUFJLEdBQUcsVUFBVSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsYUFBYSxFQUFFLEtBQUssRUFBRSxlQUFlLENBQUMsQ0FBQztnQkFDN0UsTUFBTTtZQUNSLEtBQUssU0FBUyxDQUFDLElBQUk7Z0JBQ2pCLElBQUksR0FBRyxVQUFVLENBQUMsY0FBYyxDQUFDLElBQUksRUFB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QUFNOztzQkFDQyxFQUFFLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUM7Z0JBQ2pELE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBQ2hCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQ3pCLGVBQWUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQztnQkFDMUQsV0FBVyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDMUQsb0JBQW9CLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLFVBQVUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNuRSxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsVUFBVSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDckU7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILFFBQVEsQ0FBQyxJQUFJLENBQUM7WUFDWixLQUFLLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEIsSUFBSTtZQUNKLGVBQWU7WUFDZixXQUFXO1lBQ1gsb0JBQW9CO1lBQ3BCLHFCQUFxQjtZQUNyQixnQkFBZ0IsRUFBRSxNQUFNO1lBQ3hCLHlCQUF5QixFQUFFLE1BQU07U0FDbEMsQ0FBQyxDQUFDO1FBQ0gsT0FBTztZQUNMLE1BQU07WUFDTixRQUFRO1NBQ1QsQ0FBQztJQUNKLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q2hhcnREaW1lbnNpb24sIENoYXJ0VHlwZSwgRGF0YUl0ZW1Qcm9wc30gZnJvbSAnQGVyL3R5cGVzJztcbmltcG9ydCB7Q29sb3JVdGlsc30gZnJvbSAnLi4vY29sb3InO1xuaW1wb3J0IHtDb21tb25zVXRpbHN9IGZyb20gJy4uL2NvbW0nO1xuaW1wb3J0IHtEYXRhSXRlbVV0aWxzfSBmcm9tICcuLi9kYXRhLWl0ZW0nO1xuXG5leHBvcnQgY2xhc3MgQ2hhcnRVdGlscyB7XG5cbiAgc3RhdGljIGJ1aWxkQ2hhcnREYXRhKHJhd0RhdGE6IGFueSwgY2hhcnRPcHRpb25zOiB7IHR5cGU6IENoYXJ0VHlwZSwgZGltZW5zaW9uPzogQ2hhcnREaW1lbnNpb24sIGRhdGFJdGVtUHJvcHM/OiB7fSB9LCBkaW1lbnNpb25zSW5kZXg6IG51bWJlciA9IDApIHtcbiAgICBjb25zdCB0eXBlID0gY2hhcnRPcHRpb25zLnR5cGU7XG4gICAgbGV0IGRhdGEgPSByYXdEYXRhO1xuICAgIGNvbnN0IGRpbWVuc2lvbiA9IGNoYXJ0T3B0aW9ucy5kaW1lbnNpb24gfHwge307XG4gICAgaWYgKGRpbWVuc2lvbi5kYXRhU3JjUGF0aCkge1xuICAgICAgZGF0YSA9IENvbW1vbnNVdGlscy5nZXQocmF3RGF0YSwgZGltZW5zaW9uLmRhdGFTcmNQYXRoKTtcbiAgICB9XG4gICAgY29uc3QgZGF0YUl0ZW1Qcm9wcyA9IGRpbWVuc2lvbi5kYXRhSXRlbVByb3BzIHx8IGNoYXJ0T3B0aW9ucy5kYXRhSXRlbVByb3BzO1xuICAgIGNvbnN0IGxhYmVsID0gZGltZW5zaW9uLnRpdGxlIHx8ICcnO1xuICAgIHN3aXRjaCAodHlwZSB8fCBDaGFydFR5cGUuQkFSKSB7XG4gICAgICBjYXNlIENoYXJ0VHlwZS5CQVI6XG4gICAgICAgIGRhdGEgPSBDaGFydFV0aWxzLmJ1aWxkQmFyQ2hhcnQoZGF0YSwgZGF0YUl0ZW1Qcm9wcywgbGFiZWwsIGRpbWVuc2lvbnNJbmRleCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBDaGFydFR5cGUuTElORTpcbiAgICAgICAgZGF0YSA9IENoYXJ0VXRpbHMuYnVpbGRMaW5lQ2hhcnQoZGF0YSwgZGF0YUl0ZW1Qcm9wcywgbGFiZWwsIGRpbWVuc2lvbnNJbmRleCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBDaGFydFR5cGUuUElFOlxuICAgICAgICBkYXRhID0gQ2hhcnRVdGlscy5idWlsZFBpZUNoYXJ0KGRhdGEsIGRhdGFJdGVtUHJvcHMsIGxhYmVsLCBkaW1lbnNpb25zSW5kZXgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQ2hhcnRUeXBlLkFSRUE6XG4gICAgICAgIGRhdGEgPSBDaGFydFV0aWxzLmJ1aWxkQXJlYUNoYXJ0KGRhdGEsIGRhdGFJdGVtUHJvcHMsIGxhYmVsLCBkaW1lbnNpb25zSW5kZXgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgQ2hhcnRUeXBlLlJBREFSOlxuICAgICAgICBkYXRhID0gQ2hhcnRVdGlscy5idWlsZFJhZGFyQ2hhcnQoZGF0YSwgZGF0YUl0ZW1Qcm9wcywgbGFiZWwsIGRpbWVuc2lvbnNJbmRleCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBDaGFydFR5cGUuRE9VR0hOVVQ6XG4gICAgICAgIGRhdGEgPSBDaGFydFV0aWxzLmJ1aWxkUGllQ2hhcnQoZGF0YSwgZGF0YUl0ZW1Qcm9wcywgbGFiZWwsIGRpbWVuc2lvbnNJbmRleCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIHN0YXRpYyBidWlsZEJhckNoYXJ0KGRhdGFJdGVtczoge31bXSwgY29uZmlnOiBEYXRhSXRlbVByb3BzLCBsYWJlbCA9ICcnLCBjb2xvckluZGV4ID0gMCkge1xuICAgIGNvbnN0IF9kYXRhID0gRGF0YUl0ZW1VdGlscy50cmFuc0l0ZW1zKGRhdGFJdGVtcywgY29uZmlnKTtcbiAgICBjb25zdCBsYWJlbHMgPSBbXTtcbiAgICBjb25zdCBkYXRhc2V0cyA9IFtdO1xuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBjb25zdCBiYWNrZ3JvdW5kQ29sb3IgPSBbXTtcbiAgICBjb25zdCBob3ZlckJhY2tncm91bmRDb2xvciA9IFtdO1xuICAgIGNvbnN0IGl0ZW1zID0gX2RhdGE7XG4gICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGlmIChpdGVtWydncm91cCddKSB7XG4gICAgICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiBpdGVtc1snJ10ubGFiZWwsXG4gICAgICAgICAgZGF0YTogaXRlbXNbJyddLml0ZW1zLFxuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogQ29sb3JVdGlscy5nZXRDb2xvcihpdGVtc1snJ10ubGFiZWwpXG4gICAgICAgIH0pO1xuICAgICAgICBsYWJlbHMucHVzaCgnJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBsYiA9IGl0ZW1bJ2tleV9hc19zdHJpbmcnXSB8fCBpdGVtWydsYWJlbCddO1xuICAgICAgICBsYWJlbHMucHVzaChsYik7XG4gICAgICAgIGRhdGEucHVzaChpdGVtWyd2YWx1ZSddKTtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yLnB1c2goQ29sb3JVdGlscy5nZXRDb2xvcihsYiwgY29sb3JJbmRleCkpO1xuICAgICAgICBob3ZlckJhY2tncm91bmRDb2xvci5wdXNoKENvbG9yVXRpbHMuZ2V0Q29sb3IobGIsIGNvbG9ySW5kZXggKyAxMCkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgYmFja2dyb3VuZENvbG9yLFxuICAgICAgaG92ZXJCYWNrZ3JvdW5kQ29sb3IsXG4gICAgICBkYXRhXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxhYmVscyxcbiAgICAgIGRhdGFzZXRzXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBidWlsZFBpZUNoYXJ0KGRhdGFJdGVtczoge31bXSwgY29uZmlnOiBEYXRhSXRlbVByb3BzLCBsYWJlbCA9ICcnLCBjb2xvckluZGV4ID0gMCkge1xuICAgIGNvbnN0IF9kYXRhID0gRGF0YUl0ZW1VdGlscy50cmFuc0l0ZW1zKGRhdGFJdGVtcywgY29uZmlnKTtcbiAgICBjb25zdCBsYWJlbHMgPSBbXTtcbiAgICBjb25zdCBkYXRhc2V0cyA9IFtdO1xuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBjb25zdCBiYWNrZ3JvdW5kQ29sb3IgPSBbXTtcbiAgICBjb25zdCBob3ZlckJhY2tncm91bmRDb2xvciA9IFtdO1xuICAgIGNvbnN0IGl0ZW1zID0gX2RhdGE7XG4gICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGlmIChpdGVtWydncm91cCddKSB7XG4gICAgICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiBpdGVtc1snJ10ubGFiZWwsXG4gICAgICAgICAgZGF0YTogaXRlbXNbJyddLml0ZW1zLFxuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogQ29sb3JVdGlscy5nZXRDb2xvcihpdGVtc1snJ10ubGFiZWwpXG4gICAgICAgIH0pO1xuICAgICAgICBsYWJlbHMucHVzaCgnJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBsYiA9IGl0ZW1bJ2tleV9hc19zdHJpbmcnXSB8fCBpdGVtWydsYWJlbCddO1xuICAgICAgICBsYWJlbHMucHVzaChsYik7XG4gICAgICAgIGRhdGEucHVzaChpdGVtWyd2YWx1ZSddKTtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yLnB1c2goQ29sb3JVdGlscy5nZXRDb2xvcihsYiwgY29sb3JJbmRleCkpO1xuICAgICAgICBob3ZlckJhY2tncm91bmRDb2xvci5wdXNoKENvbG9yVXRpbHMuZ2V0Q29sb3IobGIsIGNvbG9ySW5kZXggKyAxMCkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgbGFiZWw6IGxhYmVsIHx8ICcnLFxuICAgICAgYmFja2dyb3VuZENvbG9yLFxuICAgICAgaG92ZXJCYWNrZ3JvdW5kQ29sb3IsXG4gICAgICBkYXRhXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxhYmVscyxcbiAgICAgIGRhdGFzZXRzXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBidWlsZEFyZWFDaGFydChkYXRhSXRlbXM6IHt9W10sIGNvbmZpZzogRGF0YUl0ZW1Qcm9wcywgbGFiZWwgPSAnJywgY29sb3JJbmRleCA9IDApIHtcbiAgICBjb25zdCBfZGF0YSA9IERhdGFJdGVtVXRpbHMudHJhbnNJdGVtcyhkYXRhSXRlbXMsIGNvbmZpZyk7XG4gICAgY29uc3QgbGFiZWxzID0gW107XG4gICAgY29uc3QgZGF0YXNldHMgPSBbXTtcbiAgICBjb25zdCBiYWNrZ3JvdW5kQ29sb3IgPSBbXTtcbiAgICBjb25zdCBkYXRhID0gW107XG4gICAgY29uc3QgaXRlbXMgPSBfZGF0YTtcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaWYgKGl0ZW1bJ2dyb3VwJ10pIHtcbiAgICAgICAgZGF0YXNldHMucHVzaCh7XG4gICAgICAgICAgbGFiZWw6IGl0ZW1zWycnXS5sYWJlbCxcbiAgICAgICAgICBkYXRhOiBpdGVtc1snJ10uaXRlbXMsXG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBDb2xvclV0aWxzLmdldENvbG9yKGl0ZW1zWycnXS5sYWJlbClcbiAgICAgICAgfSk7XG4gICAgICAgIGxhYmVscy5wdXNoKCcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGxiID0gaXRlbVsna2V5X2FzX3N0cmluZyddIHx8IGl0ZW1bJ2xhYmVsJ107XG4gICAgICAgIGxhYmVscy5wdXNoKGxiKTtcbiAgICAgICAgZGF0YS5wdXNoKGl0ZW1bJ3ZhbHVlJ10pO1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3IucHVzaChDb2xvclV0aWxzLmdldENvbG9yKGxiLCBjb2xvckluZGV4KSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgZGF0YXNldHMucHVzaCh7XG4gICAgICBsYWJlbDogbGFiZWwgfHwgJycsXG4gICAgICBkYXRhLFxuICAgICAgYmFja2dyb3VuZENvbG9yXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxhYmVscyxcbiAgICAgIGRhdGFzZXRzXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBidWlsZExpbmVDaGFydChkYXRhSXRlbXM6IHt9W10sIGNvbmZpZzogRGF0YUl0ZW1Qcm9wcywgbGFiZWwgPSAnJywgY29sb3JJbmRleCA9IDApIHtcbiAgICBjb25zdCBfZGF0YSA9IERhdGFJdGVtVXRpbHMudHJhbnNJdGVtcyhkYXRhSXRlbXMsIGNvbmZpZyk7XG4gICAgY29uc3QgbGFiZWxzID0gW107XG4gICAgY29uc3QgZGF0YXNldHMgPSBbXTtcbiAgICBjb25zdCBkYXRhID0gW107XG4gICAgY29uc3QgaXRlbXMgPSBfZGF0YTtcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaWYgKGl0ZW1bJ2dyb3VwJ10pIHtcbiAgICAgICAgZGF0YXNldHMucHVzaCh7XG4gICAgICAgICAgbGFiZWw6IGl0ZW1zWycnXS5sYWJlbCxcbiAgICAgICAgICBkYXRhOiBpdGVtc1snJ10uaXRlbXMsXG4gICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBDb2xvclV0aWxzLmdldENvbG9yKGl0ZW1zWycnXS5sYWJlbClcbiAgICAgICAgfSk7XG4gICAgICAgIGxhYmVscy5wdXNoKCcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGxiID0gaXRlbVsna2V5X2FzX3N0cmluZyddIHx8IGl0ZW1bJ2xhYmVsJ107XG4gICAgICAgIGxhYmVscy5wdXNoKGxiKTtcbiAgICAgICAgZGF0YS5wdXNoKGl0ZW1bJ3ZhbHVlJ10pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgbGFiZWw6IGxhYmVsIHx8ICcnLFxuICAgICAgZGF0YSxcbiAgICAgIGZpbGw6IGZhbHNlLFxuICAgICAgYm9yZGVyQ29sb3I6IENvbG9yVXRpbHMuZ2V0Q29sb3IoY29sb3JJbmRleClcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgbGFiZWxzLFxuICAgICAgZGF0YXNldHNcbiAgICB9O1xuICB9XG5cbiAgc3RhdGljIGJ1aWxkUmFkYXJDaGFydChkYXRhSXRlbXM6IHt9W10sIGNvbmZpZzogRGF0YUl0ZW1Qcm9wcywgbGFiZWwgPSAnJywgY29sb3JJbmRleCA9IDApIHtcbiAgICBjb25zdCBfZGF0YSA9IERhdGFJdGVtVXRpbHMudHJhbnNJdGVtcyhkYXRhSXRlbXMsIGNvbmZpZyk7XG4gICAgY29uc3QgbGFiZWxzID0gW107XG4gICAgY29uc3QgZGF0YXNldHMgPSBbXTtcbiAgICBjb25zdCBiYWNrZ3JvdW5kQ29sb3IgPSBbXTtcbiAgICBjb25zdCBib3JkZXJDb2xvciA9IFtdO1xuICAgIGNvbnN0IHBvaW50QmFja2dyb3VuZENvbG9yID0gW107XG4gICAgY29uc3QgcG9pbnRIb3ZlckJvcmRlckNvbG9yID0gW107XG4gICAgY29uc3QgZGF0YSA9IFtdO1xuICAgIGNvbnN0IGl0ZW1zID0gX2RhdGE7XG4gICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGlmIChpdGVtWydncm91cCddKSB7XG4gICAgICAgIGRhdGFzZXRzLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiBpdGVtc1snJ10ubGFiZWwsXG4gICAgICAgICAgZGF0YTogaXRlbXNbJyddLml0ZW1zLFxuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogQ29sb3JVdGlscy5nZXRDb2xvcihpdGVtc1snJ10ubGFiZWwpXG4gICAgICAgIH0pO1xuICAgICAgICBsYWJlbHMucHVzaCgnJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBsYiA9IGl0ZW1bJ2tleV9hc19zdHJpbmcnXSB8fCBpdGVtWydsYWJlbCddO1xuICAgICAgICBsYWJlbHMucHVzaChsYik7XG4gICAgICAgIGRhdGEucHVzaChpdGVtWyd2YWx1ZSddKTtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yLnB1c2goQ29sb3JVdGlscy5nZXRDb2xvcihsYiwgY29sb3JJbmRleCkpO1xuICAgICAgICBib3JkZXJDb2xvci5wdXNoKENvbG9yVXRpbHMuZ2V0Q29sb3IobGIsIGNvbG9ySW5kZXggKyA1KSk7XG4gICAgICAgIHBvaW50QmFja2dyb3VuZENvbG9yLnB1c2goQ29sb3JVdGlscy5nZXRDb2xvcihsYiwgY29sb3JJbmRleCArIDUpKTtcbiAgICAgICAgcG9pbnRIb3ZlckJvcmRlckNvbG9yLnB1c2goQ29sb3JVdGlscy5nZXRDb2xvcihsYiwgY29sb3JJbmRleCArIDUpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBkYXRhc2V0cy5wdXNoKHtcbiAgICAgIGxhYmVsOiBsYWJlbCB8fCAnJyxcbiAgICAgIGRhdGEsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3IsXG4gICAgICBib3JkZXJDb2xvcixcbiAgICAgIHBvaW50QmFja2dyb3VuZENvbG9yLFxuICAgICAgcG9pbnRIb3ZlckJvcmRlckNvbG9yLFxuICAgICAgcG9pbnRCb3JkZXJDb2xvcjogJyNmZmYnLFxuICAgICAgcG9pbnRIb3ZlckJhY2tncm91bmRDb2xvcjogJyNmZmYnXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxhYmVscyxcbiAgICAgIGRhdGFzZXRzXG4gICAgfTtcbiAgfVxufVxuIl19