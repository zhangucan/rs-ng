!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("moment"),require("@angular/forms"),require("pinyinlite/index_full"),require("rxjs"),require("lodash"),require("rxjs/operators"),require("@er/types"),require("elastic-builder")):"function"==typeof define&&define.amd?define("@er/utils",["exports","moment","@angular/forms","pinyinlite/index_full","rxjs","lodash","rxjs/operators","@er/types","elastic-builder"],t):t((e.er=e.er||{},e.er.utils={}),e.momentNs,e.ng.forms,e.pinyinlite,e.rxjs,e._,e.rxjs.operators,e.types,e.esb)}(this,function(e,t,i,r,a,u,o,l,f){"use strict";r=r&&r.hasOwnProperty("default")?r["default"]:r;var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function g(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function n(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)a.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e}var c=function(){function o(){}return o.getSeq=function(){return++o.seq},o.getModuleId=function(){return++o.moduleId},o.get=function(e,t){var r=o.getTypeCache(e);return r?r.get(t):null},o.put=function(e,t,r){var n=o.getTypeCache(e);n||(n=new Map,o.cache.set(e,n)),n.set(t,r)},o.getTypeCache=function(e){return o.cache.get(e)},o.cache=new Map,o.seq=0,o.moduleId=0,o}(),p=function(){function a(){}return a.lodash=function(){return u},a.getSeq=function(){return c.getSeq()},a.getRandomNumber=function(e,t){return void 0===e&&(e=10),Math.floor(Math.random()*(e+1)+(t||0))},a.getObjWhenStr=function(e,t){var r;return"string"==typeof e?((r={})[t]=e,r):e},a.getVarType=function(e){var t=l.VarType.UNKNOWN;if(null===e?t=l.VarType.NULL:e===undefined?t=l.VarType.UNDEFINED:!0!==e&&!1!==e||(t=l.VarType.BOOLEAN),t!==l.VarType.UNKNOWN)return t;var r=typeof e;return"string"===r?t=l.VarType.STRING:"number"===r?t=l.VarType.NUMBER:"function"===r&&(t=l.VarType.FUNCTION),e.constructor===[].constructor?t=l.VarType.ARRAY:e.constructor==={}.constructor&&(t=l.VarType.JSON),t},a.isNullOrUndefined=function(e){return e===undefined||null===e},a.isString=function(e){return a.getVarType(e)===l.VarType.STRING},a.isBoolean=function(e){return a.getVarType(e)===l.VarType.BOOLEAN},a.isEmptyString=function(e){return!e||a.isString(e)&&0===e.trim().length},a.isArray=function(e){return a.getVarType(e)===l.VarType.ARRAY},a.isNumber=function(e){return a.getVarType(e)===l.VarType.NUMBER},a.isJson=function(e){return a.getVarType(e)===l.VarType.JSON},a.isFunction=function(e){return a.getVarType(e)===l.VarType.FUNCTION},a.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},a.isInteger=function(e){return!a.isNullOrUndefined(e)&&/^\d+$/.test(e)},a.isEqual=function(e,t){return u.isEqual(e,t)},a.copy=function(e){return u.cloneDeep(e)},a.merge=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return u.merge.apply(null,s([e],t))},a.pickBy=function(e,t){return u.pickBy(e,t)},a.pick=function(e,t){return u.pick(e,t)},a.defaults=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return u.defaultsDeep.apply(undefined,s([e],t))},a.equals=function(e,t){return u.isEqual(e,t)},a.set=function(e,t,r){return u.set(e,t,r)},a.get=function(e,t,r){return u.get(e,t,r)},a.extend=function(e,t){return u.extend(e,t)},a.compact=function(e){return u.compact(e)},a.omit=function(e,t){return u.omit(e,t)},a.omitBy=function(e,t){return u.omitBy(e,t)},a.unset=function(e,t){return u.unset(e,t)},a.find=function(e,t){return u.find(e,t)},a.findIndex=function(e,t){return u.findIndex(e,t)},a.remove=function(e,t){return u.remove(e,t)},a.forOwn=function(e,t){return u.forOwn(e,t)},a.map=function(e,t){return u.map(e,t)},a.unique=function(e,t){return u.uniqBy(e,t)},a.orderBy=function(e,t,r){return u.orderBy(e,t,r)},a.union=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.union(e)},a.flatten=function(e){return u.flatten(e)},a.flattenDeep=function(e){return u.flattenDeep(e)},a.format=function(e,t){return e},a.jsonConcat=function(e,t){for(var r in t)e[r]=t[r];return e},a.escape=function(e,t){var r=t;e[r];return function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}(e,["symbol"==typeof r?r:r+""])},a.filter=function(e,t){return u.filter(e,t)},a.where=function(t,r){return Object.keys(r).every(function(e){return t&&t[e]===r[e]})?t:null},a.capitalize=function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e},a.templateStr=function(e,t){return u.template(e)(t)},a.isTemplateStr=function(e){return/.*\${.*}.*/.test(e)||/.*<%=(.*)%>.*/.test(e)},a.getArray=function(e,t){var r,n=[];if(e){if(a.isArray(e))return e;if(a.isJson(e)){for(var o in e)if(o){var i=e[o];t&&(i=d(((r={})[t]=o,r),i)),n.push(i)}}else n.push(e)}return n},a.removeKeys=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=e;0<t.length;){n=a.set(n,t,undefined),a.unset(n,t),t.pop();var o=a.get(n,t);if(!a.isEmpty(o))break}return n},a.extract=function(e,t,r){var n;if(e&&t!==r){if(r>=e.length)for(n=r-e.length;1+n--;)e.push(undefined);e.splice(r,0,e.splice(t,1)[0])}},a.addItem=function(e,t,r){var n=t;return a.isArray(t)||(n=[t]),r?[].concat(e.slice(0,r),n,e.slice(r)):[].concat(e,n)},a.removeByIndex=function(e,t){return[].concat(e.slice(0,t),e.slice(t+1))},a.replace=function(e,t,r){return[].concat(e.slice(0,t),r,e.slice(t+1))},a.move=function(e,t,r){var n=e[t],o=t<r,i=e.slice(0,o?t:r),a=e.slice(o?t+1:r,o?r+1:t),u=e.slice(o?r+1:t+1);return o?[].concat(i,a,n,u):[].concat(i,n,a,u)},a.restoreFn=function(e){return"string"==typeof e&&0===e.toLocaleLowerCase().trim().indexOf("function")?new Function("return "+e.replace(/_this/g,"this").replace(/__assign/g,"Object.assign"))():e},a.exclude=function(n,o,i){return Object.keys(n).reduce(function(e,t){var r;return n[t][o]===i?e:d({},e,((r={})[t]=n[t],r))},{})},a.replaceObj=function(e,t,r,n){var o,i,a=u.find(e,((o={})[t]=r,o));return s(e.slice(0,a),[d({},e[a],(i={},i[t]=n,i))],e.slice(a+1))},a.concat=function(e,t,n){return d({},e,t.reduce(function(e,t){var r;return d({},e,((r={})[t[n]]=t,r))},{}))},a.restoreJsonFn=function(e){var t;return t="string"==typeof e?e:a.stringify(e),JSON.parse(t,function(e,t){return a.restoreFn(t)})},a.stringify=function(e){return JSON.stringify(e,function r(e,t){return"function"==typeof t?t.toString():t})},a.hash=function(e){for(var t=0,r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return t},a.adaptObject=function(e,t){return a.isArray(e)?a.adaptArray(e,t):a.adaptJson(e,t)},a.adaptJson=function(n,o){var i={};return Object.keys(o).forEach(function(e){var t=a.get(n,e);if(t)if(a.isArray(t)){var r=null;r=a.isString(o[e])?o[e]:o[e].key,a.set(i,r,a.adaptArray(t,o[e].options||o))}else a.isJson(t)?a.set(i,o[e],a.adaptJson(t,o[e].options||{})):a.isString(o[e])?a.set(i,o[e],t):a.isFunction(o[e])&&a.set(i,o[e],o[e].apply(undefined,n,o))}),i},a.adaptArray=function(e,t){var r=[];return e.forEach(function(e){r.push(a.adaptObject(e,t))}),r},a.getAge=function(e){var t=new Date,r=new Date(e),n=t.getFullYear()-r.getFullYear(),o=t.getMonth()-r.getMonth();return(o<0||0===o&&t.getDate()<r.getDate())&&n--,n},a.toDate=function(e){if(e instanceof Date)return e;if(a.isString(e)){var t=Date.parse(e);return isNaN(t)?null:new Date(t)}return null},a.isBefore=function(e,t){void 0===t&&(t=new Date);var r=a.toDate(t),n=a.toDate(e);return!!(n&&r&&n<r)},a.isAfter=function(e,t){void 0===t&&(t=new Date);var r=a.toDate(t),n=a.toDate(e);return!!(n&&r&&r<n)},a.toString=function(e){switch(a.getVarType(e)){case l.VarType.NULL:case l.VarType.UNDEFINED:return"";case l.VarType.ARRAY:var t=[];return e.forEach(function(e){return t.push(a.toString(e))}),"["+t.join(",")+"]";case l.VarType.JSON:return a.stringify(e);default:return e.toString()}},a.isEmpty=function(e){switch(a.getVarType(e)){case l.VarType.NULL:case l.VarType.UNDEFINED:return!0;case l.VarType.STRING:case l.VarType.ARRAY:return 0===e.length;case l.VarType.JSON:return 0===Object.keys(e).length;default:return 0===e.toString().length}},a.convertToBoolean=function(e,t){var r=d({},e);return t&&0<t.length&&t.forEach(function(e){r.hasOwnProperty(e)&&""===r[e]&&(r[e]=!0)}),r},a.flatPath=function(e){return a.isArray(e)?e.join("-").replace(".","-"):e.replace(".","-")},a.join=function(e,t){var r=t||",";if(!e)return"";if(!a.isArray(e))return e;switch(e.length){case 0:return"";case 1:return e[0];default:return e.join(r)}},a.deepFind=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=function(r){if(r instanceof Array)r.forEach(function(e){return n(e)});else{for(var e in r)r[e]instanceof Array&&n(r[e]);t.some(function(e){var t=a.where(r,e);return null!==t&&o.push(r),null!==t})}},o=[];return n(e),o},a.sleep=function(e){for(var t=(new Date).getTime(),r=0;r<1e7&&!((new Date).getTime()-t>e);r++);},a.getArrayValue=function(e){return e?a.isArray(e)?e:a.isString(e)?e.split(","):[e]:e},a.getText=function(e){return a.isArray(e)?e.map(function(e){return a.getText(e)}).join(","):a.isJson(e)?JSON.stringify(e):a.isBoolean(e)?e?"是":"否":e},a.getValue=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=e&&(e.method||e);return a.isFunction(n)?n.apply(undefined,t):a.isString(e)&&e.startsWith("@")?a.get(t&&t[0],e.substr(1)):e},a.defineHiddenProp=function(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0}),e[t]=r},a.splitBySize=function(e,t){for(var r=[],n=t;n<=e.length;)r.push(e.substr(0,n)),n+=t;return r},a.resolveUrl=function(e,r){return void 0===r&&(r={}),Object.keys(r).reduce(function(e,t){return e.replace(":"+t,r[t])},e)},a}(),h=function(){function c(){}return c.escapeRegexp=function(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},c.getRegexps=function(e){var t,r;if(!e)return[];var n=[],o=[];p.isString(e)&&o.push(e);try{for(var i=g(o),a=i.next();!a.done;a=i.next()){var u=a.value;u&&(0<u.indexOf(",")?n.concat(c.getRegexps(u.split(","))):n.push(c.getRegexp(u)))}}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}return n},c.test=function(t,e){var r;return(r="string"==typeof e?new RegExp(e):e)instanceof RegExp?r.test(t):r&&Array.isArray(r)?r.every(function(e){return c.test(t,e)}):r&&Array.isArray(r.and)?r.and.every(function(e){return c.test(t,e)}):r&&Array.isArray(r.or)?r.or.some(function(e){return c.test(t,e)}):!(!r||!r.not)&&!c.test(t,r.not)},c.exec=function(r,e){var n=this;return"string"==typeof e&&(e=new RegExp(e)),e instanceof RegExp?e.exec(r):e&&Array.isArray(e)?e.reduce(function(e,t){return e||n.exec(r,t)},null):null},c.getRegexp=function(e){return e?p.isString(e)?"letter"===e?l.RegPatterns.letter:"digit"===e?l.RegPatterns.digit:"character"===e?l.RegPatterns.character:"integer"===e?l.RegPatterns.integer:"numeric"===e?l.RegPatterns.numeric:new RegExp(e):e:null},c}(),v=require("bowser"),m=function(){function n(){}return n.isMobile=function(){return[l.Devices.DEVICES.ANDROID,l.Devices.DEVICES.IPHONE,l.Devices.DEVICES.I_POD,l.Devices.DEVICES.BLACKBERRY,l.Devices.DEVICES.FIREFOX_OS,l.Devices.DEVICES.WINDOWS_PHONE,l.Devices.DEVICES.VITA].some(function(e){return n.device_info.device===e})},n.isTablet=function(){return[l.Devices.DEVICES.I_PAD,l.Devices.DEVICES.FIREFOX_OS].some(function(e){return n.device_info.device===e})},n.isDesktop=function(){return[l.Devices.DEVICES.PS4,l.Devices.DEVICES.CHROME_BOOK,l.Devices.DEVICES.UNKNOWN].some(function(e){return n.device_info.device===e})},n.getDeviceInfo=function(){if(n.device_info)return n.device_info;window&&window.navigator&&(n.ua=window.navigator.userAgent),n.userAgent=n.ua;var e=[{"const":"OS",prop:"os"},{"const":"BROWSERS",prop:"browser"},{"const":"DEVICES",prop:"device"},{"const":"OS_VERSIONS",prop:"os_version"}];if(e.forEach(function(r){n[r.prop]=Object.keys(l.Devices[r["const"]]).reduce(function(e,t){return e[l.Devices[r["const"]][t]]=h.test(n.ua,l.Devices[r["const"]+"_RE"][t]),e},{})}),e.forEach(function(r){n[r.prop]=Object.keys(l.Devices[r["const"]]).map(function(e){return l.Devices[r["const"]][e]}).reduce(function(e,t){return e===l.Devices[r["const"]].UNKNOWN&&n[r.prop][t]?t:e},l.Devices[r["const"]].UNKNOWN)}),n.browser_version="0",n.browser!==l.Devices.BROWSERS.UNKNOWN){var t=l.Devices.BROWSER_VERSIONS_RE[n.browser],r=h.exec(n.ua,t);r&&(n.browser_version=r[1])}return n.device_info={userAgent:n.userAgent,os:n.os,browser:n.browser,device:n.device,os_version:n.os_version,browser_version:n.browser_version}},n.checkBrowser=function(){return n.isBrowserVersionValid()?{version:!0,features:n.isBrowserFeaturesValid()}:{version:!1}},n.isBrowserVersionValid=function(){return v.getParser(window.navigator.userAgent).satisfies({windows:{"internet explorer":">10"},macos:{safari:">10.1"},chrome:">20.1.1432",firefox:">31",opera:">22"})},n.isBrowserFeaturesValid=function(){var e=!0;for(var t in Modernizr)if(Modernizr.hasOwnProperty(t)&&"boolean"==typeof Modernizr[t]&&!1===Modernizr[t]){e=!1;break}return e},n.ua="",n.userAgent="",n.os="",n.browser="",n.device="",n.os_version="",n.browser_version="",n.device_info=undefined,n}(),y=-1,A=function(){function o(){}return o.getColorsCount=function(){return-1===y&&(y=Object.keys(l.UI_COLORS).length),y},o.getColor=function(e,t){var r;void 0===t&&(t=0),e||(e=p.getRandomNumber(o.getColorsCount())),r=p.isString(e)?(e.charCodeAt(0)+e.charCodeAt(e.length-1)+e.length+t)%o.getColorsCount():e;var n="pink";return Object.keys(l.UI_COLORS).some(function(e,t){return t===r&&(n=l.UI_COLORS[e],!0)}),n},o}(),b=function(){function o(){}return o.transItems=function(e,r){if(!r)return e;var t=[],n={};return e.map(function(e){t.push(o.transItem(e,r))}),r.groupKey&&(t.map(function(e){var t=o.getItemLabel(e,r.groupKey||"group");n[t]||(n[t]=[]),n[t].push(e)}),t=[],Object.keys(n).forEach(function(e){t.push({label:e,items:n[e]})})),t},o.transItem=function(e,t){var r;return(r={})[o.ITEM_LABEL_KEY]=o.getItemLabel(e,t.labelKey||o.ITEM_LABEL_KEY),r[o.ITEM_VALUE_KEY]=o.getItemValue(e,t.valueKey),r[o.ITEM_DATA_KEY]=e,r},o.getItemValue=function(r,t){if(p.isString(r))return r;if(p.isArray(r))return r.map(function(e){return o.getItemValue(e,t)});if("function"==typeof t)return t(r);if(p.isArray(t)){var n={};return t.forEach(function(e){var t=p.get(r,e);t&&(n[e]=t)}),n}return t?p.get(r,t):r},o.getItemLabel=function(r,e){if(p.isFunction(e))return e(r);if(r){if(p.isArray(e)){var n=[];return e.forEach(function(e){var t=o.getLabel(r,e);t&&n.push(t)}),n}return o.getLabel(r,e)}},o.getLabel=function(e,t){var r=p.get(e,t);return r||(e[o.ITEM_DATA_KEY]?p.get(e[o.ITEM_DATA_KEY],t):e[Object.keys(e)[0]])},o.ITEM_LABEL_KEY="label",o.ITEM_VALUE_KEY="value",o.ITEM_GROUP_KEY="group",o.ITEM_GROUP_ITEMS_KEY="items",o.ITEM_DATA_KEY="data",o}(),E=function(){function s(){}return s.buildChartData=function(e,t,r){void 0===r&&(r=0);var n=t.type,o=e,i=t.dimension||{};i.dataSrcPath&&(o=p.get(e,i.dataSrcPath));var a=i.dataItemProps||t.dataItemProps,u=i.title||"";switch(n||l.ChartType.BAR){case l.ChartType.BAR:o=s.buildBarChart(o,a,u,r);break;case l.ChartType.LINE:o=s.buildLineChart(o,a,u,r);break;case l.ChartType.PIE:o=s.buildPieChart(o,a,u,r);break;case l.ChartType.AREA:o=s.buildAreaChart(o,a,u,r);break;case l.ChartType.RADAR:o=s.buildRadarChart(o,a,u,r);break;case l.ChartType.DOUGHNUT:o=s.buildPieChart(o,a,u,r)}return o},s.buildBarChart=function(e,t,r,n){void 0===r&&(r=""),void 0===n&&(n=0);var o=b.transItems(e,t),i=[],a=[],u=[],s=[],c=[],l=o;return l.forEach(function(e){if(e.group)a.push({label:l[""].label,data:l[""].items,backgroundColor:A.getColor(l[""].label)}),i.push("");else{var t=e.key_as_string||e.label;i.push(t),u.push(e.value),s.push(A.getColor(t,n)),c.push(A.getColor(t,n+10))}}),a.push({label:r,backgroundColor:s,hoverBackgroundColor:c,data:u}),{labels:i,datasets:a}},s.buildPieChart=function(e,t,r,n){void 0===r&&(r=""),void 0===n&&(n=0);var o=b.transItems(e,t),i=[],a=[],u=[],s=[],c=[],l=o;return l.forEach(function(e){if(e.group)a.push({label:l[""].label,data:l[""].items,backgroundColor:A.getColor(l[""].label)}),i.push("");else{var t=e.key_as_string||e.label;i.push(t),u.push(e.value),s.push(A.getColor(t,n)),c.push(A.getColor(t,n+10))}}),a.push({label:r||"",backgroundColor:s,hoverBackgroundColor:c,data:u}),{labels:i,datasets:a}},s.buildAreaChart=function(e,t,r,n){void 0===r&&(r=""),void 0===n&&(n=0);var o=b.transItems(e,t),i=[],a=[],u=[],s=[],c=o;return c.forEach(function(e){if(e.group)a.push({label:c[""].label,data:c[""].items,backgroundColor:A.getColor(c[""].label)}),i.push("");else{var t=e.key_as_string||e.label;i.push(t),s.push(e.value),u.push(A.getColor(t,n))}}),a.push({label:r||"",data:s,backgroundColor:u}),{labels:i,datasets:a}},s.buildLineChart=function(e,t,r,n){void 0===r&&(r=""),void 0===n&&(n=0);var o=b.transItems(e,t),i=[],a=[],u=[],s=o;return s.forEach(function(e){if(e.group)a.push({label:s[""].label,data:s[""].items,backgroundColor:A.getColor(s[""].label)}),i.push("");else{var t=e.key_as_string||e.label;i.push(t),u.push(e.value)}}),a.push({label:r||"",data:u,fill:!1,borderColor:A.getColor(n)}),{labels:i,datasets:a}},s.buildRadarChart=function(e,t,r,n){void 0===r&&(r=""),void 0===n&&(n=0);var o=b.transItems(e,t),i=[],a=[],u=[],s=[],c=[],l=[],f=[],d=o;return d.forEach(function(e){if(e.group)a.push({label:d[""].label,data:d[""].items,backgroundColor:A.getColor(d[""].label)}),i.push("");else{var t=e.key_as_string||e.label;i.push(t),f.push(e.value),u.push(A.getColor(t,n)),s.push(A.getColor(t,n+5)),c.push(A.getColor(t,n+5)),l.push(A.getColor(t,n+5))}}),a.push({label:r||"",data:f,backgroundColor:u,borderColor:s,pointBackgroundColor:c,pointHoverBorderColor:l,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff"}),{labels:i,datasets:a}},s}(),w=function(){function e(){}return e.prototype.copyText=function(e){this.createTextareaAndSelect(e);var t=document.execCommand("copy");return this.removeFake(),t},e.prototype.createTextareaAndSelect=function(e){this.textarea=document.createElement("textarea"),this.textarea.style.fontSize="12pt",this.textarea.style.setProperty("display","none");var t=window.pageYOffset||document.documentElement.scrollTop;this.textarea.style.top=t+"px",this.textarea.setAttribute("readonly",""),this.textarea.value=e,document.body.appendChild(this.textarea),this.textarea.select(),this.textarea.setSelectionRange(0,this.textarea.value.length)},e.prototype.removeFake=function(){this.textarea&&(document.body.removeChild(this.textarea),this.textarea=null)},e}(),S=function(){function e(){}return e.getMediaDevices=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices||console.error("Can't enumerate devices, method not supported."),a.from(navigator.mediaDevices.enumerateDevices()).pipe(o.map(function(e){var t,r,n=[];try{for(var o=g(e),i=o.next();!i.done;i=o.next()){var a=i.value;console.log(a);var u={};for(var s in a)s&&(u[s]=a[s]);u.deviceId||(u.deviceId=u.id),u.label||(u.label="device (no-permission)"),n.push(u)}}catch(c){t={error:c}}finally{try{i&&!i.done&&(r=o["return"])&&r.call(o)}finally{if(t)throw t.error}}return n}))},e.getVideoDevices=function(){return e.getMediaDevices().pipe(o.map(function(e){return e.filter(function(e){return"videoinput"===e.kind})}))},e.getAudioDevices=function(){return e.getMediaDevices().pipe(o.map(function(e){return e.filter(function(e){return"audioinput"===e.kind})}))},e.playBeepSound=function(){new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=").play()},e.getMediaStream=function(e,t){navigator.mediaDevices||a.throwError("Can't get user media, this is not supported.");var r=t===undefined?{facingMode:{exact:"environment"}}:{deviceId:{exact:t}};return e.video=r,a.from(navigator.mediaDevices.getUserMedia(e)).pipe(o.map(function(e){return e}),o.catchError(function(e){return a.throwError(e)}))},e.stopMedia=function(e){e&&e.getTracks&&e.getTracks().forEach(function(e){return e.stop()})},e.takeImage=function(e,t){var r={};e.videoWidth&&(r.width=e.videoWidth,r.height=e.videoHeight),t.width=r.width,t.height=r.height,t.getContext("2d").drawImage(e,0,0);var n="image/jpeg",o=t.toDataURL(n);return a.of({dataUrl:o,mimeType:n})},e}(),D=new a.BehaviorSubject({}),C=function(){function o(){}return o.getStore=function(){return D},o.create=function(e,t,r){var n=o.getStoreItem(e,!0);return n.state.next(t),r&&(n.preserved=r),n.state},o.get=function(e,t){var r=o.getStoreItem(e,t);return r?r.state:undefined},o.observe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.get(e,!0)},o.toggle=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=o.get(e);return r.next(!r.value),r},o.inc=function(e){var t=o.get(e,!0),r=0;return t.value&&(r=t.value+1),t.next(r),t},o.dec=function(e){var t=o.get(e,!0),r=0;return t.value&&(r=t.value-1),t.next(r),t},o.add=function(e,t){var r=o.get(e,!0),n=0;return r.value&&(n=r.value+t),r.next(n),r},o.set=function(e,t){var r=o.get(e,!0);return r.value?(r.next(t),r):o.create(e,t)},o["delete"]=function(e,t){var r=o.get(e);r.value&&r.next(p.unset(r.value,t))},o.update=function(e,t){var r=o.get(e,!0);return r.value?(r.next(p.merge({},r.value,t)),r):o.create(e,t)},o.getValue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=o.get(e);return r?d({},r.value):undefined},o.deleteState=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=o.get(e);p.unset(D.value,p.flatPath(e)),r&&(r.next(undefined),r.complete()),D.next(D.value)},o.getStoreItem=function(e,t){var r=p.flatPath(e),n=p.get(D.value,r);if(!n&&t){n={state:new a.BehaviorSubject(undefined),createdAt:(new Date).getMilliseconds()};var o=p.set(D.value,r,n);D.next(o)}return n},o}(),O=t,T=function(){function f(){}return f.getMoment=function(e){return O.isMoment(e)?e:f.toDate(e)?O(e):null},f.isDate=function(e){return!!f.toDate(e)},f.toDate=function(e){if(p.isString(e)){var t=Date.parse(e);if(!isNaN(t))return new Date(t)}else if(e&&"function"==typeof e.getMonth)return e;return undefined},f.getFormattedDate=function(e,t){return void 0===t&&(t="YYYY-MM-DD"),f.getFormattedDateTime(t,e)},f.getFormattedTime=function(e,t){return void 0===t&&(t="HH:mm:ss"),f.getFormattedDateTime(t,e)},f.getFormattedDateTime=function(e,t){void 0===e&&(e="YYYY-MM-DD HH:mm:ss"),t=t?f.toDate(t):f.getDate();var r=f.getMoment(t);return r?r.format(e):""},f.getDate=function(){var e=C.getValue(l.StateNames.serverTime);return e?e.date:new Date},f.getStamp=function(){return f.getDate().getTime()},f.getDateByNow=function(e,t){if(!e)return{seconds:0,message:""};if(!f.isDate(e))try{e=new Date(e)}catch(l){e=null}if(!e)return{seconds:0,message:""};var r=t;r||(r=new Date),f.isDate(r)||(r=new Date(r));var n=Math.round(Math.abs((r.getTime()-e.getTime())/1e3)),o=Math.round(Math.abs(n/60)),i=Math.round(Math.abs(o/60)),a=Math.round(Math.abs(i/24)),u=Math.round(Math.abs(a/30.416)),s=Math.round(Math.abs(a/365)),c="";return c=n<=10?e<r?"刚刚":"马上":n<=30?"30秒":n<=90?"1分钟":o<=45?o+"分钟":o<=90?"1小时":i<=22?i+"小时":i<=36?"1天":a<=25?a+"天":a<=45?"1个月":a<=345?u+"月":a<=545?"1年":s+"年",10<n&&(c+=e<r?"前":"后"),{seconds:n,message:c}},f.getUpdateSeconds=function(e){return e<60?2:e<3600?30:e<86400?300:3600},f.getYear=function(e){return(e||f.getDate()).getFullYear()},f.getMonth=function(e){return(e||f.getDate()).getMonth()+1},f.getDay=function(e){return(e||f.getDate()).getDate()},f.getYesterday=function(){return f.getDay(new Date(f.getDate().getTime()-864e5))},f.getTomorrow=function(){return f.getDay(new Date(f.getDate().getTime()+864e5))},f.getLastMonth=function(){var e=f.getMonth()-1;return e<1?12:e},f.getNextMonth=function(){var e=f.getMonth()+1;return 12<e?1:e},f}(),x=function(){function e(){}return e.getEntityData=function(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var o={};return e&&0<e.length?e.forEach(function(e){o[t.fields[e].label||e]=r[e]}):Object.keys(r).filter(function(e){return-1===["_index","_type","id"].indexOf(e)}).forEach(function(e){o[t.fields[e]&&t.fields[e].label||e]=r[e]}),o},e.getDataEntityDefaultFieldName=function(e){if(e.defaultField)return e.fields[e.defaultField]&&e.fields[e.defaultField].key},e}(),I=function(){function e(){}return e.patch=function(e,t){var r=!1;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&t[n]!==e[n]){r=!0;break}return r?Object.assign({},e,t):e},e}();function N(){return Object.create(null)}function k(e){return Object.assign(N(),e)}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t.toString())}var U=function(){function e(){}return e.readFile=function(e,t){var r=new FileReader,n=a.fromEvent(r,"load").pipe(o.map(function(e){return e.target.result}),o.first());switch(t||l.ReadAs.BINARY){case l.ReadAs.ARRAY:r.readAsArrayBuffer(e);break;case l.ReadAs.BINARY:r.readAsBinaryString(e);break;case l.ReadAs.URL:r.readAsDataURL(e);break;case l.ReadAs.TEXT:r.readAsText(e)}return n},e}(),M=function(){function l(){}return l.test=function(e){if(!/^(([1][1-5])|([2][1-3])|([3][1-7])|([4][1-6])|([5][0-4])|([6][1-5])|([7][1])|([8][1-2]))\d{4}(([1][9]\d{2})|([2]\d{3}))(([0][1-9])|([1][0-2]))(([0][1-9])|([1-2][0-9])|([3][0-1]))\d{3}[0-9xX]$/.test(e))return{status:!1,msg:"身份证号码不合规"};var t=e.substr(6,4),r=e.substr(10,2),n=e.substr(12,2),o=Date.parse(r+"-"+n+"-"+t),i=Date.parse(T.getDate()),a=new Date(t,r,0).getDate();if(i<o||a<n)return{status:!1,msg:"出生日期不合规"};for(var u=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),s=new Array("1","0","X","9","8","7","6","5","4","3","2"),c=e.split(""),l=0,f=0;f<17;f++)l+=parseInt(c[f])*u[f];return c[17].toUpperCase()!==s[l%11].toUpperCase()?{status:!1,msg:"身份证校验码不合规"}:{status:!0}},l.parse=function(e){if(!l.test(e).status)return{};var t={},r=15===e.length?14:16,n=15===e.length?2:4,o=1-e.substr(r,1)%2;t.gender=1===o?"女":"男";var i=(2===n?"19":"")+e.substr(6,n),a=e.substr(6+n,2),u=e.substr(8+n,2);t.birthday=i+"-"+a+"-"+u;var s=T.getDate(),c=s.getMonth()+1<parseInt(a,10)||s.getMonth()+1===parseInt(a,10)&&s.getDate()<parseInt(u,10)?1:0;return t.age=s.getFullYear()-parseInt(i,10)-c,t},l}(),V=function(){function e(){}return e.getFormControl=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=e,o=null;return 0<t.length&&t.forEach(function(e){(o=n.controls[e])instanceof i.FormGroup&&(n=o)}),o},e.setValue=function(e,t){e.setValue(t,{emitEvent:!1,emitModelToViewChange:!1,emitViewToModelChange:!1})},e}(),B=function(){function n(){}return n.context=function(e){return d({now:T.getFormattedDateTime(),today:T.getFormattedDate(),year:T.getYear(e),lastYear:T.getYear(e)-1,month:T.getMonth(e),lastMonth:T.getLastMonth(),day:T.getDay(e),yesterday:T.getYesterday()},C.getValue(l.StateNames.user)||{})},n.get=function(e){return n.context()[e]||""},n.resolveVariables=function(e){return p.isJson(e)?n.resolveJson(e):p.isArray(e)?n.resolveArray(e):p.isString(e)?n.resolveValue(e):e},n.resolveValue=function(e){var t=e;return p.isTemplateStr(e)&&(t=p.templateStr(e,n.context())),t},n.resolveJson=function(e){var t={};for(var r in e)e[r]!==undefined&&(p.isJson(e[r])?t[r]=n.resolveJson(e[r]):p.isArray(e[r])?t[r]=n.resolveArray(e[r]):p.isString(e[r])?t[r]=n.resolveValue(e[r]):t[r]=e[r]);return t},n.resolveArray=function(e){var t=[];return e.forEach(function(e){return t.push(n.resolveVariables(e))}),t},n}(),F={version:"0.0.1",stomp:{enabled:!1,destination:"/message/push",headers:{},heartbeat_in:0,heartbeat_out:2e4,reconnect_delay:5e3,debug:!1},auth:{storageKey:"erCurrentUser",headerName:"Authorization",authScheme:"Bearer ",userTokenKey:"userName",passwordKey:"password",rememberMeKey:"rememberMe",requiredUserProps:"org",loginRouter:"user/login",loginApiOptions:{serverType:l.ApiServerType.App},loginSuccessRouter:"/",logoutSuccessRouter:"user/login"},alert:{},announce:{},notify:l.NotifyType.ALERT,onLoading:"fa fa-cog fa-spin fa-3x indigo",enableLogger:!0,dataFieldProps:{dataCode:{apiEntry:"data_code",codeKey:"code",nameKey:"name",parentKey:"parent",catKey:"codeCat"}},wechat:{self_redirect:!0,scope:"snsapi_login",state:"",style:"black",href:""},log:{enableApp:!0,enableRoute:!1,level:l.LogLevel.DEBUG,httpPost:!1,blackLList:["PropsBindDirective"]}},L=function(){function n(){}return n.getConfig=function(){return n.moduleConfig||n.appConfig},n.configApp=function(e){return n.appConfig=p.merge({},F,e)},n.configModule=function(e,t){var r=e;return t&&t===n.lastUrl?r=p.merge(n.lastConfig,e):(n.lastUrl=t,n.lastConfig=e),n.moduleConfig=p.merge({},n.appConfig,r)},n.get=function(e,t){return p.get(n.getConfig(),e,t)},n.lastUrl=undefined,n.lastConfig={},n.appConfig=d({},F),n.moduleConfig=undefined,n}(),P=function(){function n(){}return n.confirm=function(e,t,r){return C.create(l.StateNames.confirm,d({header:e,content:t},r,{open:!0})).pipe(o.filter(function(e){return e&&!e.open}),o.map(function(e){return!0===e.accept}))},n.error=function(e,t,r){return n.popup(e,'\n                 <div class="d-flex align-items-center">\n                  <i class="fa fa-exclamation-circle fa-2x text-danger mr-2"></i>\n                  <span style="font-size: 1.2em">'+t+"</span>\n                </div>                 \n    ",d({},r||{},{maximizable:!1}))},n.info=function(e,t,r){return n.popup(e,'\n                 <div class="d-flex align-items-center">\n                  <i class="fa fa-info-circle fa-2x text-primary mr-2"></i>\n                  <span style="font-size: 1.2em">'+t+"</span>\n                </div>                 \n    ",d({},r||{},{maximizable:!1,minWidth:200,closeLabel:"确定"}))},n.popup=function(e,t,r){return C.create(l.StateNames.popup,d({header:e,content:t},r,{maximizable:!1,visible:!0}))},n}(),K=function(){function a(){}return a.getUserMenuItems=function(e,n,o){var i=[];return o=p.getArrayValue(o),n&&0!==n.length||(n=[]),o&&0!==o.length||(o=[]),0===n.length&&0===o.length?e:e&&0<e.length?(e.forEach(function(e){var t=e;if(t.roles||t.permissions){if(t.roles&&0<n.length)0<p.getArrayValue(t.roles).filter(function(e){return 0<=n.indexOf(e)}).length&&i.push(t);if(-1===i.indexOf(t)&&t.permissions&&0<o.length)0<p.getArrayValue(t.permissions).filter(function(e){return 0<=o.indexOf(e)}).length&&i.push(t)}else i.push(t);if(t.items){var r=a.getUserMenuItems(t.items,o,n);0<r.length&&(t.items=r)}}),i):void 0},a.transMenuItems=function(e){var r;return(r=p.orderBy(e,["parent","code"],["asc"])).forEach(function(t){var e=r.filter(function(e){return e.parent&&e.parent===t.code});0<e.length&&(t.items=e),t.icon&&t.icon.startsWith("fa-")&&(t.icon="fa "+t.icon)}),r=r.filter(function(e){return!e.parent})},a}(),_=function(){function o(){this.calculatedScrollbarWidth=null}return o.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},o.addClasses=function(e,t){for(var r=t.split(" "),n=0;n<r.length;n++)o.addClass(e,r[n])},o.removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},o.hasClass=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},o.siblings=function(t){return t.parentNode.children.filter(function(e){return e!==t})},o.find=function(e,t){return e.querySelectorAll(t)},o.findSingle=function(e,t){return e.querySelector(t)},o.index=function(e){for(var t=e.parentNode.childNodes,r=0,n=0;n<t.length;n++){if(t[n]==e)return r;1==t[n].nodeType&&r++}return-1},o.relativePosition=function(e,t){var r,n,o=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),i=t.offsetHeight,a=t.offsetWidth,u=t.getBoundingClientRect(),s=(this.getWindowScrollTop(),this.getViewport());u.top+i+o.height>s.height?(r=-1*o.height,u.top+r<0&&(r=0)):r=i,n=u.left+o.width>s.width?a-o.width:0,e.style.top=r+"px",e.style.left=n+"px"},o.absolutePosition=function(e,t){var r,n,o=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),i=o.height,a=o.width,u=t.offsetHeight,s=t.offsetWidth,c=t.getBoundingClientRect(),l=this.getWindowScrollTop(),f=this.getWindowScrollLeft(),d=this.getViewport();c.top+u+i>d.height?(r=c.top+l-i)<0&&(r=0+l):r=u+c.top+l,n=c.left+s+a>d.width?c.left+f+s-a:c.left+f,e.style.top=r+"px",e.style.left=n+"px"},o.getHiddenElementOuterHeight=function(e){e.style.visibility="hidden",e.style.display="block";var t=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",t},o.getHiddenElementOuterWidth=function(e){e.style.visibility="hidden",e.style.display="block";var t=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",t},o.getHiddenElementDimensions=function(e){var t={};return e.style.visibility="hidden",e.style.display="block",t.width=e.offsetWidth,t.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",t},o.scrollInView=function(e,t){var r=getComputedStyle(e).getPropertyValue("borderTopWidth"),n=r?parseFloat(r):0,o=getComputedStyle(e).getPropertyValue("paddingTop"),i=o?parseFloat(o):0,a=e.getBoundingClientRect(),u=t.getBoundingClientRect().top+document.body.scrollTop-(a.top+document.body.scrollTop)-n-i,s=e.scrollTop,c=e.clientHeight,l=this.getOuterHeight(t);u<0?e.scrollTop=s+u:c<u+l&&(e.scrollTop=s+u-c+l)},o.fadeIn=function(e,t){e.style.opacity=0;var r=+new Date,n=0,o=function(){n=+e.style.opacity.replace(",",".")+((new Date).getTime()-r)/t,e.style.opacity=n,r=+new Date,+n<1&&(window.requestAnimationFrame&&requestAnimationFrame(o)||setTimeout(o,16))};o()},o.fadeOut=function(e,t){var r=1,n=50/t;var o=setInterval(function i(){(r-=n)<=0&&(r=0,clearInterval(o)),e.style.opacity=r},50)},o.getWindowScrollTop=function(){var e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)},o.getWindowScrollLeft=function(){var e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)},o.matches=function(e,t){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||function(e){return-1!==[].indexOf.call(document.querySelectorAll(e),this)}).call(e,t)},o.getOuterWidth=function(e,t){var r=e.offsetWidth;if(t){var n=getComputedStyle(e);r+=parseFloat(n.marginLeft)+parseFloat(n.marginRight)}return r},o.getHorizontalPadding=function(e){var t=getComputedStyle(e);return parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)},o.getHorizontalMargin=function(e){var t=getComputedStyle(e);return parseFloat(t.marginLeft)+parseFloat(t.marginRight)},o.innerWidth=function(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)},o.width=function(e){var t=e.offsetWidth,r=getComputedStyle(e);return t-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)},o.getInnerHeight=function(e){var t=e.offsetHeight,r=getComputedStyle(e);return t+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)},o.getOuterHeight=function(e,t){var r=e.offsetHeight;if(t){var n=getComputedStyle(e);r+=parseFloat(n.marginTop)+parseFloat(n.marginBottom)}return r},o.getHeight=function(e){var t=e.offsetHeight,r=getComputedStyle(e);return t-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth)},o.getWidth=function(e){var t=e.offsetWidth,r=getComputedStyle(e);return t-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth)},o.getViewport=function(){var e=window,t=document,r=t.documentElement,n=t.getElementsByTagName("body")[0];return{width:e.innerWidth||r.clientWidth||n.clientWidth,height:e.innerHeight||r.clientHeight||n.clientHeight}},o.getOffset=function(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},o.getUserAgent=function(){return navigator.userAgent},o.resolveUserAgent=function(){var e=navigator.userAgent.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},o.createElement=function(e,t){var r=document.createElement(e);return t&&o.addClasses(r,t),r},o.remove=function(e){e.parentElement.removeChild(e)},o.removeHost=function(e){for(var t=e,r=t.parentElement;t.firstChild;)r.insertBefore(t.firstChild,t);r.removeChild(t)},o.prototype.isIE=function(){var e=window.navigator.userAgent;if(0<e.indexOf("MSIE "))return!0;if(0<e.indexOf("Trident/")){e.indexOf("rv:");return!0}return 0<e.indexOf("Edge/")},o.prototype.appendChild=function(e,t){if(this.isElement(t))t.appendChild(e);else{if(!t.el||!t.el.nativeElement)throw new Error("Cannot append "+t+" to "+e);t.el.nativeElement.appendChild(e)}},o.prototype.removeChild=function(e,t){if(this.isElement(t))t.removeChild(e);else{if(!t.el||!t.el.nativeElement)throw new Error("Cannot remove "+e+" from "+t);t.el.nativeElement.removeChild(e)}},o.prototype.invokeElementMethod=function(e,t,r){e[t].apply(e,r)},o.prototype.clearSelection=function(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&0<window.getSelection().rangeCount&&0<window.getSelection().getRangeAt(0).getClientRects().length&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}},o.prototype.isElement=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},o.prototype.getBrowser=function(){if(!this.browser){var e=o.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser},o.prototype.calculateScrollbarWidth=function(){if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;var e=document.createElement("div");e.className="ui-scrollbar-measure",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),this.calculatedScrollbarWidth=t},o.zindex=1e3,o}(),W=function(){function t(){}return t.base64decode=function(e){var t="";if((e=String(e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r=0,n=void 0,o=void 0,i=0;o=e.charAt(i++);~o&&(n=r%4?64*n+o:o,r++%4)?t+=String.fromCharCode(255&n>>(-2*r&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return t},t.base64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(t.base64decode(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},t}(),j=function(){function n(){}return n.urlBase64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Illegal base64url string!")}return W.base64decode(t)},n.decodeToken=function(e){if(null===e)return null;var t=e.split(".");if(3!==t.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");var r=n.urlBase64Decode(t[1]);if(!r)throw new Error("Cannot decode the token.");return JSON.parse(r)},n.getTokenExpirationDate=function(e){var t;if(!(t=this.decodeToken(e)).hasOwnProperty("exp"))return null;var r=new Date(0);return r.setUTCSeconds(t.exp),r},n.isValid=function(e,t){if(null===e||""===e)return!1;var r=n.getTokenExpirationDate(e);return t=t||0,null!==r&&r.valueOf()>(new Date).valueOf()+1e3*t},n}(),Q=function(){function t(){}return t.getRandom=function(){return Math.floor(1e10*Math.random())+""},t.getUUID=function(){if("undefined"==typeof window||"undefined"==typeof window.crypto||"undefined"==typeof window.crypto.getRandomValues)return t._random4()+t._random4()+"-"+t._random4()+"-"+t._random4()+"-"+t._random4()+"-"+t._random4()+t._random4()+t._random4();var e=new Uint16Array(8);return window.crypto.getRandomValues(e),t._pad4(e[0])+t._pad4(e[1])+"-"+t._pad4(e[2])+"-"+t._pad4(e[3])+"-"+t._pad4(e[4])+"-"+t._pad4(e[5])+t._pad4(e[6])+t._pad4(e[7])},t._pad4=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t},t._random4=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},t}(),q=function(){function e(){}return e.getFirstLetter=function(e){return r(e).map(function(e){return e[0]&&e[0].substr(0,1)}).join("").toLowerCase()},e.getPinYin=function(e){return r(e).map(function(e){return e[0]?e[0]:""}).join("").toLowerCase()},e}(),Y=function(){function e(){}return e.getBase64=function(e){if("string"==typeof e&&e.startsWith("data:"))return a.of(e);var t=new FileReader,r=a.fromEvent(t,"load").pipe(o.map(function(e){return console.log(e.target.result),e.target.result}));return t.readAsDataURL(e),r},e.upload=function(e){},e}(),J=function(){function e(){}return e.getPagerModel=function(e,t,r){void 0===t&&(t=1),void 0===r&&(r=10);var n,o,i=Math.ceil(e/r);o=i<=10?(n=1,i):t<=6?(n=1,10):i<=t+4?(n=i-9,i):(n=t-5,t+4);var a=(t-1)*r;return{totalItems:e,currentPage:t,pageSize:r,totalPages:i,startPage:n,endPage:o,startIndex:a,endIndex:Math.min(a+r-1,e-1),pages:u.range(n,o+1)}},e}(),H=function(){function a(){}return a.transNodes=function(e,r,n,o){var i,a,u=Object.keys(r.node).map(function(e){return r.node[e]});return r.src.levelIdLength?i=(i=p.orderBy(e,[r.src.orderKey||r.src.idKey],["asc"])).map(function(e){if(e[r.src.idKey]){var t=e[r.src.idKey].substr(0,e[r.src.idKey].length-r.src.levelIdLength);return t&&t!==e[r.src.idKey]&&(e[r.src.parentKey]=t),e[r.node.dataKey]||(e[r.node.dataKey]=d({},e)),e[r.node.idKey]=e[r.src.idKey],e=p.pick(e,u)}}):r.src.parentKey&&(i=(i=p.orderBy(e,[r.src.parentKey,r.src.idKey],["asc"])).map(function(e){return e[r.node.dataKey]||(e[r.node.dataKey]=d({},e)),e[r.node.idKey]=e[r.src.idKey],e=p.pick(e,u)})),i.forEach(function(t){t[r.node.dataKey]=t[r.node.dataKey]||d({},t);var e=i.filter(function(e){return e&&e[r.src.parentKey]&&e[r.src.parentKey]===t.data[r.src.idKey]});0<e.length&&(t[r.node.childrenKey]=e),t[r.node.labelKey]=b.getItemLabel(t,r.src.labelKey),t[r.src.parentKey]&&(t[r.node.parentKey]=t[r.src.parentKey]),o&&(t[r.node.leafKey]=!1),n&&p.isString(n)&&n===t[r.src.idKey]&&(a=[t])}),n&&p.isJson(n)?(n.children=i,[n]):i=a||i.filter(function(e){return!e[r.node.parentKey]})},a.findNode=function(e,t,r){var n;if(e)for(var o=0;o<e.length;o++){if(t[r.dataItemProps.idKey]===e[o][l.DEFAULT_TREE_NODE_KEYS.dataKey][r.dataItemProps.idKey]){n=e[o];break}if(e[o].hasOwnProperty(l.DEFAULT_TREE_NODE_KEYS.childrenKey)){var i=e[o][l.DEFAULT_TREE_NODE_KEYS.childrenKey];if(n=a.findNode(i,t,r))break}}return n},a.filter=function(e,o){return e?e.reduce(function(e,t){var r=null;if(o(t))r=p.copy(d({},t,{matched:!0}));else if(null!=t.children){var n=a.filter(t.children,o);0<n.length&&(r=Object.assign({},t,{children:n}))}return r&&e.push(r),e},[]):null},a.expandNode=function(e,t,r,n,o,i){void 0===r&&(r={}),void 0===n&&(n=100),void 0===o&&(o=1),e&&o<=n&&(i&&o===n?e.expanded=e.id===i:(!i||i&&o<n)&&(e.expanded=t),a.initNode(e,r),o++,e.children&&e.children.forEach(function(e){a.initNode(e,r),o<=n&&a.expandNode(e,t,r,n,o,i)}))},a.initNode=function(t,r){void 0===r&&(r={}),t._inited||(["expandedIcon","collapsedIcon"].forEach(function(e){return a.initIcon(t,e,r)}),r.selectable&&(t.selectable=p.getValue(r.selectable,t)),t=d({},t,{_inited:!0}))},a.initIcon=function(e,t,r){r?r[t]&&r[t].method?e[t]=r[t].method(e):e[t]=r[t]||a.DEFAULT_NODE_PROPS[t]:e[t]=a.DEFAULT_NODE_PROPS[t]},a.getSelectedTreeState=function(e){if(!e)return null;var t=e&&C.getValue(e);if(t&&t.component){var r=p.get(t.component,"$props.$ext.$container.tree.$id");return C.getValue(r)}},a.getSelectedNode=function(e){var t=a.getSelectedTreeState(e);return t&&t.selectedNode},a.getSelectedNodeValue=function(e){var t=a.getSelectedTreeState(e);return t&&t.selectedNodeValue},a.DEFAULT_NODE_PROPS={lazy:!1,autoExpandLevel:0,expandedIcon:"fa fa-folder-open",collapsedIcon:"fa fa-folder",icon:"fa fa-leaf"},a}(),z=function(){function e(){}return e.info=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{type:l.NotifyType.ANNOUNCE}))},e.error=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{level:l.NotifyLevel.ERROR,type:l.NotifyType.ANNOUNCE}))},e.success=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{level:l.NotifyLevel.SUCCESS,type:l.NotifyType.ANNOUNCE}))},e.warn=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{level:l.NotifyLevel.WARN,type:l.NotifyType.ANNOUNCE}))},e}(),G=function(){function e(){}return e.info=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,t)},e.error=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{level:l.NotifyLevel.ERROR}))},e.success=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{level:l.NotifyLevel.SUCCESS}))},e.warn=function(e){var t=p.getObjWhenStr(e,"message");C.create(l.StateNames.notify,d({},t,{level:l.NotifyLevel.WARN}))},e}(),Z=function(){function e(){}return e.retry=function(e,t){return o.retryWhen(function(e){return e.pipe(o.scan(function(e,t){throw t},0),o.delay(t))})},e}(),X=function(){function t(){}return t.getQueryParameters=function(){return t.getQueryParametersUsingParameters(document.location.search)},t.getQueryParametersUsingParameters=function(e){return e.replace(/(^\?)/,"").split("&").map(function(e){return this[(e=e.split("="))[0]]=e[1],this}.bind({}))[0]},t.getInitialUrlParameters=function(){var e=t.initialUrl.indexOf("?");return 0<=e?t.initialUrl.substr(e,t.initialUrl.length-e):""},t.getReturnUrl=function(){var e=t.getQueryParametersUsingParameters(t.getInitialUrlParameters());return e.returnUrl?decodeURIComponent(e.returnUrl):null},t.getSingleSignIn=function(){var e=t.getQueryParametersUsingParameters(t.getInitialUrlParameters());return!!e.ss&&e.ss},t.initialUrl=location.href,t}(),$=function(){function i(){}return i.extract=function(e,t){if(e===t)return new ee(!0);var r=(new ne).Tokenize(t);if(!r)return new ee(""===e);for(var n=new ee(!0),o=0;o<r.length;o++){var i=r[o],a=0<o?r[o-1]:null;if(i.Type===te.ConstantText)if(0===o){if(0!==e.indexOf(i.Text))return n.isMatch=!1,n;e=e.substr(i.Text.length,e.length-i.Text.length)}else{var u=e.indexOf(i.Text);if(u<0)return n.isMatch=!1,n;n.matches.push({name:a.Text,value:e.substr(0,u)}),e=e.substring(0,u+i.Text.length)}}var s=r[r.length-1];return s.Type===te.DynamicValue&&n.matches.push({name:s.Text,value:e}),n},i.matches=function(e,t){var r=i.extract(e,t);if(!r.isMatch)return[];for(var n=[],o=0;o<r.matches.length;o++)n.push(r.matches[o].value);return n},i}(),ee=function ie(e){this.isMatch=e,this.matches=[]},te={ConstantText:0,DynamicValue:1};te[te.ConstantText]="ConstantText",te[te.DynamicValue]="DynamicValue";var re=function ae(e,t){this.Text=e,this.Type=t},ne=function(){function e(){}return e.prototype.Tokenize=function(e,t){void 0===t&&(t=!1);for(var r=[],n="",o=!1,i=0;i<e.length;i++){var a=e[i];switch(a){case"{":if(o)throw new Error("Incorrect syntax at char "+i+"! format string can not contain agg dynamic value expression!");o=!0,0<n.length&&(r.push(new re(n,te.ConstantText)),n="");break;case"}":if(!o)throw new Error("Incorrect syntax at char "+i+"! These is no opening brackets for the closing bracket }.");if(o=!1,n.length<=0)throw new Error("Incorrect syntax at char "+i+"! Brackets does not containt any chars.");var u=n;t&&(u="{"+u+"}"),r.push(new re(u,te.DynamicValue)),n="";break;default:n+=a}}if(o)throw new Error("There is no closing } char for an opened { char.");return 0<n.length&&r.push(new re(n,te.ConstantText)),r},e}();var oe=function(){function c(){}return c.parseEsbObject=function(e){return e?p.isArray(e)?e.forEach(function(e){return c.parseEsbObject(e)}):p.isFunction(e.toJSON)?e.toJSON():e:e},c.getFieldAggs=function(t,e){if(e){var r={};return e.forEach(function(e){switch(e){case l.AggMethodsProps.avg.key:r=p.merge(r,f.avgAggregation(t+"-"+e,t).toJSON());break;case l.AggMethodsProps.distinct.key:r=p.merge(r,f.cardinalityAggregation(t+"-"+e,t).toJSON());break;case l.AggMethodsProps.max.key:r=p.merge(r,f.maxAggregation(t+"-"+e,t).toJSON());break;case l.AggMethodsProps.min.key:r=p.merge(r,f.minAggregation(t+"-"+e,t).toJSON());break;case l.AggMethodsProps.sum.key:r=p.merge(r,f.sumAggregation(t+"-"+e,t).toJSON());break;case l.AggMethodsProps.count.key:r=p.merge(r,f.valueCountAggregation(t+"-"+e,t).toJSON());break;default:r=p.merge(r,f.valueCountAggregation(t+"-"+e,t).toJSON())}}),r}return undefined},c.resolveQuery=function(e){var t=[],r=[],n=[];if(e)if(p.isArray(e))t=t.concat(e);else if(p.isJson(e)){if(e.hasOwnProperty("$and")){var o=e.$and;p.isArray(o)?t=t.concat(o):t.push(o)}if(e.hasOwnProperty("$or")){var i=e.$or;p.isArray(i)?r=r.concat(i):r.push(i)}if(e.hasOwnProperty("$not")){var a=e.$not;p.isArray(a)?n=n.concat(a):n.push(a)}}else t.push(e);return{must:p.compact(t),should:p.compact(r),not:p.compact(n)}},c.resolveSearchFields=function(t){var e=p.getArrayValue(t.searchFields);if(p.isEmpty(e))throw P.error("数据错误","没有定义查询字段"),new Error("not found search fields");var r=[];return e.filter(function(e){return!!e}).forEach(function(e){t.withPy&&(t.withWildcard?r.push(f.wildcardQuery(e+".py","*"+t.queryValue+"*")):r.push(f.prefixQuery(e+".py",t.queryValue))),t.withZh&&r.push(f.wildcardQuery(e+".zh","*"+t.queryValue+"*")),t.withTerm&&r.push(f.termQuery(e,t.queryValue)),t.withPrefix&&r.push(f.prefixQuery(e,t.queryValue)),t.withWildcard&&r.push(f.wildcardQuery(e,"*"+t.queryValue+"*")),0===r.length&&r.push(f.matchQuery(e,t.queryValue))}),r},c.buildQueryBody=function(e){var t=f.requestBodySearch(),r=f.boolQuery(),n=c.resolveQuery(e.query);if(e.queryValue){var o=c.resolveSearchFields(e);1===o.length?n.must.push(o[0]):n.should=n.should.concat(o)}if(0<n.must.length&&r.must(n.must),0<n.should.length&&r.should(n.should).minimumShouldMatch(1),0<n.not.length&&r.mustNot(n.not),t.query(r),p.isEmpty(e.filter)||r.filter(e.filter),!e.returnFields||0!==e.returnFields.length){var i=e.returnFields||e.searchFields;t.source(i)}if(e.sort){var a=c.resolveSort(e.sort),u=[];Object.keys(a).forEach(function(e){u.push(f.sort(e,a[e]||l.Order.ASC).unmappedType("string"))}),t.sorts(u)}if(e.aggProps){var s=c.parseAggProps(e.aggProps);0<s.length&&(t.aggs(s),t.size(e.size||0))}return e.from&&t.from(e.from),e.size&&t.size(e.size),t},c.parseAggProps=function(e){var a,t=p.getArrayValue(e),u=[];return t.forEach(function(e){var t=e;p.isString(t)&&(t={field:e});var r=t.name||t.field+"-"+(t.method||"terms");switch(t.aggs&&(t.method=l.AggMethods.CUSTOMER),t.method){case l.AggMethods.AVG:a=f.avgAggregation(r,t.field).missing("0");break;case l.AggMethods.MIN:a=f.minAggregation(r,t.field);break;case l.AggMethods.MAX:a=f.maxAggregation(r,t.field);break;case l.AggMethods.SUM:a=f.sumAggregation(r,t.field).missing("0");break;case l.AggMethods.DISTINCT:a=f.cardinalityAggregation(r,t.field);break;case l.AggMethods.HISTOGRAM:a=f.histogramAggregation(r,t.field),t.format&&a.interval(t.interval),a.minDocCount(t.minCount||1),t.format&&a.format(t.format),t.missing&&a.missing(t.missing);break;case l.AggMethods.DATE_HISTOGRAM:a=f.dateHistogramAggregation(r,t.field),t.interval&&a.interval(t.interval);var n=t.interval||l.AggInterval.DAY,o=l.AggIntervalProps[n];a.interval(n),a.minDocCount(t.minCount||1);var i=t.format||o&&o.format;i&&a.format(i),t.missing&&a.missing(t.missing);break;case l.AggMethods.CUSTOMER:a=p.getValue(t.aggs,t);break;case l.AggMethods.COUNT:a=f.valueCountAggregation(r,t.field);break;default:a=f.termsAggregation(r,t.field).size(t.size||10)}u.push(a)}),u},c.resolveRequestBody=function(e,t){if(!e||"string"==typeof e)return e||{};if(e instanceof f.RequestBodySearch)return p.merge({},e.toJSON()||{},t.payload||{},t.body||t.params||{});var r=d({},e);if(!p.isEmpty(r.sort)){var n=c.resolveSort(r.sort),o=[];Object.keys(n).forEach(function(e){var t;o.push(((t={})[e]={order:n[e]||l.Order.ASC,unmapped_type:"string"},t))}),r.sort=o}if(r.size&&r.page&&(r.from=r.page*r.size),r.from&&r.to&&(r.size=r.to-r.from),delete r.to,delete r.page,!p.isEmpty(r.query)||!p.isEmpty(r.filter)){var a={};if(!p.isEmpty(r.query)){p.isArray(r.query)?r.query.$and=r.query:r.query=c.parseEsbObject(r.query);var u=r.query;0<Object.keys(u).length&&(Object.keys(u).forEach(function(e){var t,r;if("$and"===e){var n=c.queryResolver(u,"$and");n&&(a.must=n)}else if("$or"===e){var o=c.queryResolver(u,"$or");o&&(a.should=o)}else if("$not"===e){var i=c.queryResolver(u,"$not");i&&(a.must_not=i)}else u[e]&&(a.must?a.must.push(((t={})[e]=u[e],t)):a.must=[(r={},r[e]=u[e],r)])}),a=d({},a)),a.should&&!a.minimum_should_match&&(a.minimum_should_match=1)}if(!p.isEmpty(r.filter)){var i=d({},r.filter);a.filter=[],0<Object.keys(i).length&&Object.keys(i).forEach(function(e){var t;i[e]&&a.filter.push(((t={})[e]=i[e],t))}),0===a.filter.length&&delete a.filter}0<Object.keys(a).length&&(r.query={bool:a})}if(!p.isEmpty(r.aggs)){var s=c.parseAggProps(r.aggs);0<s.length&&(r.aggs=f.requestBodySearch().aggs(s).toJSON().aggs)}return Object.keys(r).forEach(function(e){p.isEmpty(r[e])&&delete r[e]}),r},c.resolveSort=function(e){var t={};return p.isString(e)?t[e]=l.Order.ASC:p.isArray(e)?e.forEach(function(e){p.isString(e)?t[e]||(t[e]=l.Order.ASC):t=d({},t,e)}):t=e,t},c.getMsearchBody=function(e){return e.map(function(e){return JSON.stringify(e)}).join("\n")+"\n"},c.buildQueryRuleSet=function(e){return function o(a){if(a.condition||(a.condition=l.DEFAULT_ES_QUERY_CONDITION||l.DEFAULT_QUERY_CONDITION),-1===["AND","OR"].indexOf(a.condition.toUpperCase()))throw new Error('不识别的ElasticSearch bool query 关系(AND,OR) "{0}"'.replace("{0}",a.condition));if(!a.rules)return{};var n={add:function(e,t){this.hasOwnProperty(e)?this[e].push(t):this[e]=[t]}};return a.rules.forEach(function(e){var t,r=this,i=function(e){return e.data&&e.data.transform?e.data.transform.call(r,e.value):e.value};"AND"===a.condition&&(t="must"),"NOT"===a.condition&&(t="must_not"),"OR"===a.condition&&(t="should"),e.rules&&0<e.rules.length?n.add(t,o(e)):n.add(t,function(e){var t=l.ES_QUERY_OPERATORS[e.operator];if(t===undefined)throw new Error('不识别的查询操作符 "{0}"'.replace("{0}",e.operator));var r={};if(0!==t.inputs){var n={},o=t.getValue;n[e.field]=o?o(i(e)):i(e),r[t.operator]=n}return"is_null"===e.operator&&(r={exists:{field:e.field}}),"NOT"===a.condition?{bool:{must_not:[r]}}:r}(e))}),delete n.add,{bool:n}}(e=e||{})},c.resolveAggs=function(e){var n={};return Object.keys(e).forEach(function(t){var r=e[t];n[t]={},Object.keys(r).forEach(function(e){"buckets"===e?n[t]=c.resolveBuckets(r[e]):"value"===e&&(n[t]=r[e])})}),n},c.resolveBuckets=function(e){return e.map(function(e){return c.resolveBucket(e)})},c.resolveBucket=function(r){var n={};return Object.keys(r).forEach(function(e){var t;"key"===e?n.label=r.key:"doc_count"===e?n.value=r.doc_count:p.isJson(r[e])?n=d({},n,c.resolveAggs(((t={})[e]=r[e],t))):n[e]=r[e]}),n},c.queryResolver=function(e,t){if(e[t]){var r=e[t].filter(function(e){return!p.isEmpty(e)});return 0<r.length&&(r=r.map(function(e){return c.parseEsbObject(e)})),0<r.length?r:undefined}},c}();e.Utils={},e.BrowserOsUtils=m,e.ChartUtils=E,e.ColorUtils=A,e.CopierUtils=w,e.DevicesUtils=S,e.DateUtils=T,e.DataEntityUtils=x,e.ObjectUtils=I,e.createDict=N,e.copyDict=k,e.hasKey=R,e.mapValues=function ue(e,t){var r,n,o=N(),i=!1;try{for(var a=g(Object.keys(e)),u=a.next();!u.done;u=a.next()){var s=u.value;o[s]=t(e[s]),o[s]!==e[s]&&(i=!0)}}catch(c){r={error:c}}finally{try{u&&!u.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}return i?o:e},e.union=function se(e,t){return I.patch(e,t)},e.setKey=function ce(e,t,r){if(e[t]===r)return e;var n=k(e);return n[t]=r,n},e.removeKey=function le(e){for(var t,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=k(e),a=!1;try{for(var u=g(n),s=u.next();!s.done;s=u.next()){var c=s.value;R(i,c.toString())&&(a=!0,delete i[c])}}catch(l){t={error:l}}finally{try{s&&!s.done&&(r=u["return"])&&r.call(u)}finally{if(t)throw t.error}}return a?i:e},e.fromKeys=function fe(e,t){var r,n,o=N(),i="function"==typeof t;try{for(var a=g(e),u=a.next();!u.done;u=a.next()){var s=u.value;o[s]=i?t(s):t}}catch(c){r={error:c}}finally{try{u&&!u.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}return o},e.FileUtils=U,e.IdCardUtils=M,e.FormUtils=V,e.ContextUtils=B,e.DataItemUtils=b,e.CacheUtils=c,e.ConfigUtils=L,e.DialogUtils=P,e.CommonsUtils=p,e.StatesUtils=C,e.MenuUtils=K,e.DomUtils=_,e.EncodeUtils=W,e.JwtUtils=j,e.IdUtils=Q,e.PinyinUtil=q,e.RegUtils=h,e.ImageUtil=Y,e.PagerUtil=J,e.TreeUtils=H,e.AnnounceUtils=z,e.NotifyUtils=G,e.RxUtils=Z,e.UrlUtils=X,e.TokenizerUtils=$,e.ExtractionResult=ee,e.FormatStringTokenType=te,e.FormatStringToken=re,e.FormatStringTokenizer=ne,e.numToText=function de(e){var t=["","万","亿"],r=["千","百","十",""],n=["零","一","二","三","四","五","六","七","八","九"],o=e.toString().split("").reverse().join(""),i=t.length,a=o.length;if(4*i<a)return"请不要传入过大的数字";for(var u="",s=0;s<a/4;s++){var c=o.slice(4*s,4*s+4).split("").reverse().join("");if("0000"!==c){for(var l="",f=0;f<c.length;f++){var d=n[parseInt(c[f],10)],g=r[f+4-c.length];"零"===d&&""===g||(l+=d+g)}u=l+t[s]+u}}return u.replace(/零[\D]/g,"@").replace(/[@]+/g,"@").replace(/@$/,"").replace(/@([万亿]+)/,"$1").replace(/@/g,"零")},e.EsUtils=oe,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=er-utils.umd.min.js.map