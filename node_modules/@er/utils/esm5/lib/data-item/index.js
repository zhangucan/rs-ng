/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { CommonsUtils } from '../comm';
var DataItemUtils = /** @class */ (function () {
    function DataItemUtils() {
    }
    /**
     * @param {?} items
     * @param {?} config
     * @return {?}
     */
    DataItemUtils.transItems = /**
     * @param {?} items
     * @param {?} config
     * @return {?}
     */
    function (items, config) {
        if (!config) {
            return items;
        }
        /** @type {?} */
        var _data = [];
        /** @type {?} */
        var groups = {};
        items.map(function (item) {
            _data.push(DataItemUtils.transItem(item, config));
        });
        if (config.groupKey) {
            _data.map(function (item) {
                /** @type {?} */
                var group = DataItemUtils.getItemLabel(item, config.groupKey || 'group');
                if (!groups[group]) {
                    groups[group] = [];
                }
                groups[group].push(item);
            });
            _data = [];
            Object.keys(groups).forEach(function (group) {
                _data.push({
                    label: group,
                    items: groups[group]
                });
            });
        }
        return _data;
    };
    /**
     * @param {?} item
     * @param {?} config
     * @return {?}
     */
    DataItemUtils.transItem = /**
     * @param {?} item
     * @param {?} config
     * @return {?}
     */
    function (item, config) {
        var _a;
        /** @type {?} */
        var _item = (_a = {},
            _a[DataItemUtils.ITEM_LABEL_KEY] = DataItemUtils.getItemLabel(item, config.labelKey || DataItemUtils.ITEM_LABEL_KEY),
            _a[DataItemUtils.ITEM_VALUE_KEY] = DataItemUtils.getItemValue(item, config.valueKey),
            _a[DataItemUtils.ITEM_DATA_KEY] = item,
            _a);
        return _item;
    };
    /**
     * @param {?} item
     * @param {?} valueKey
     * @return {?}
     */
    DataItemUtils.getItemValue = /**
     * @param {?} item
     * @param {?} valueKey
     * @return {?}
     */
    function (item, valueKey) {
        if (CommonsUtils.isString(item)) {
            return item;
        }
        if (CommonsUtils.isArray(item)) {
            return item.map(function (data) { return DataItemUtils.getItemValue(data, valueKey); });
        }
        else {
            if (typeof valueKey === 'function') {
                return valueKey(item);
            }
            else if (CommonsUtils.isArray(valueKey)) {
                /** @type {?} */
                var value_1 = {};
                valueKey.forEach(function (p) {
                    /** @type {?} */
                    var val = CommonsUtils.get(item, p);
                    if (val) {
                        value_1[p] = val;
                    }
                });
                return value_1;
            }
            return valueKey ? CommonsUtils.get(item, valueKey) : item;
        }
    };
    /**
     * @param {?} item
     * @param {?} label
     * @return {?}
     */
    DataItemUtils.getItemLabel = /**
     * @param {?} item
     * @param {?} label
     * @return {?}
     */
    function (item, label) {
        if (CommonsUtils.isFunction(label)) {
            return label(item);
        }
        else if (item) {
            if (CommonsUtils.isArray(label)) {
                /** @type {?} */
                var s_1 = [];
                ((/** @type {?} */ (label))).forEach(function (key) {
                    /** @type {?} */
                    var lb = DataItemUtils.getLabel(item, key);
                    if (lb) {
                        s_1.push(lb);
                    }
                });
                return s_1;
            }
            else {
                return DataItemUtils.getLabel(item, label);
            }
        }
    };
    /**
     * @param {?} item
     * @param {?} labelKey
     * @return {?}
     */
    DataItemUtils.getLabel = /**
     * @param {?} item
     * @param {?} labelKey
     * @return {?}
     */
    function (item, labelKey) {
        /** @type {?} */
        var aLabel = CommonsUtils.get(item, labelKey);
        if (aLabel) {
            return aLabel;
        }
        else if (item[DataItemUtils.ITEM_DATA_KEY]) {
            return CommonsUtils.get(item[DataItemUtils.ITEM_DATA_KEY], labelKey);
        }
        else {
            return item[Object.keys(item)[0]];
        }
    };
    DataItemUtils.ITEM_LABEL_KEY = 'label';
    DataItemUtils.ITEM_VALUE_KEY = 'value';
    DataItemUtils.ITEM_GROUP_KEY = 'group';
    DataItemUtils.ITEM_GROUP_ITEMS_KEY = 'items';
    DataItemUtils.ITEM_DATA_KEY = 'data';
    return DataItemUtils;
}());
export { DataItemUtils };
if (false) {
    /** @type {?} */
    DataItemUtils.ITEM_LABEL_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_VALUE_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_GROUP_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_GROUP_ITEMS_KEY;
    /** @type {?} */
    DataItemUtils.ITEM_DATA_KEY;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdXRpbHMvIiwic291cmNlcyI6WyJsaWIvZGF0YS1pdGVtL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRXJDO0lBQUE7SUFxR0EsQ0FBQzs7Ozs7O0lBekZRLHdCQUFVOzs7OztJQUFqQixVQUFrQixLQUFLLEVBQUUsTUFBcUI7UUFDNUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNYLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7O1lBQ0csS0FBSyxHQUFVLEVBQUU7O1lBQ2YsTUFBTSxHQUE0QixFQUFFO1FBQzFDLEtBQUssQ0FBQyxHQUFHLENBQUMsVUFBQyxJQUFTO1lBQ2xCLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNwRCxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksTUFBTSxDQUFDLFFBQVEsRUFBRTtZQUNuQixLQUFLLENBQUMsR0FBRyxDQUFDLFVBQUEsSUFBSTs7b0JBQ04sS0FBSyxHQUFHLGFBQWEsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxRQUFRLElBQUksT0FBTyxDQUFDO2dCQUMxRSxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFO29CQUNsQixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO2lCQUNwQjtnQkFDRCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzNCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsS0FBSyxHQUFHLEVBQUUsQ0FBQztZQUNYLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUEsS0FBSztnQkFDL0IsS0FBSyxDQUFDLElBQUksQ0FBQztvQkFDVCxLQUFLLEVB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RyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUM7UUFDL0MsSUFBSSxNQUFNLEVBQUU7WUFDVixPQUFPLE1BQU0sQ0FBQztTQUNmO2FBQU0sSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQzVDLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1NBQ3RFO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbkM7SUFDSCxDQUFDO0lBbEdNLDRCQUFjLEdBQUcsT0FBTyxDQUFDO0lBRXpCLDRCQUFjLEdBQUcsT0FBTyxDQUFDO0lBRXpCLDRCQUFjLEdBQUcsT0FBTyxDQUFDO0lBRXpCLGtDQUFvQixHQUFHLE9BQU8sQ0FBQztJQUUvQiwyQkFBYSxHQUFHLE1BQU0sQ0FBQztJQTJGaEMsb0JBQUM7Q0FBQSxBQXJHRCxJQXFHQztTQXJHWSxhQUFhOzs7SUFFeEIsNkJBQWdDOztJQUVoQyw2QkFBZ0M7O0lBRWhDLDZCQUFnQzs7SUFFaEMsbUNBQXNDOztJQUV0Qyw0QkFBOEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0RhdGFJdGVtUHJvcHN9IGZyb20gJ0Blci90eXBlcyc7XG5pbXBvcnQge0NvbW1vbnNVdGlsc30gZnJvbSAnLi4vY29tbSc7XG5cbmV4cG9ydCBjbGFzcyBEYXRhSXRlbVV0aWxzIHtcblxuICBzdGF0aWMgSVRFTV9MQUJFTF9LRVkgPSAnbGFiZWwnO1xuXG4gIHN0YXRpYyBJVEVNX1ZBTFVFX0tFWSA9ICd2YWx1ZSc7XG5cbiAgc3RhdGljIElURU1fR1JPVVBfS0VZID0gJ2dyb3VwJztcblxuICBzdGF0aWMgSVRFTV9HUk9VUF9JVEVNU19LRVkgPSAnaXRlbXMnO1xuXG4gIHN0YXRpYyBJVEVNX0RBVEFfS0VZID0gJ2RhdGEnO1xuXG4gIHN0YXRpYyB0cmFuc0l0ZW1zKGl0ZW1zLCBjb25maWc6IERhdGFJdGVtUHJvcHMpIHtcbiAgICBpZiAoIWNvbmZpZykge1xuICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH1cbiAgICBsZXQgX2RhdGE6IGFueVtdID0gW107XG4gICAgY29uc3QgZ3JvdXBzOiB7IFtrZXk6IHN0cmluZ106IHt9W10gfSA9IHt9O1xuICAgIGl0ZW1zLm1hcCgoaXRlbTogYW55KSA9PiB7XG4gICAgICBfZGF0YS5wdXNoKERhdGFJdGVtVXRpbHMudHJhbnNJdGVtKGl0ZW0sIGNvbmZpZykpO1xuICAgIH0pO1xuICAgIGlmIChjb25maWcuZ3JvdXBLZXkpIHtcbiAgICAgIF9kYXRhLm1hcChpdGVtID0+IHtcbiAgICAgICAgY29uc3QgZ3JvdXAgPSBEYXRhSXRlbVV0aWxzLmdldEl0ZW1MYWJlbChpdGVtLCBjb25maWcuZ3JvdXBLZXkgfHwgJ2dyb3VwJyk7XG4gICAgICAgIGlmICghZ3JvdXBzW2dyb3VwXSkge1xuICAgICAgICAgIGdyb3Vwc1tncm91cF0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBncm91cHNbZ3JvdXBdLnB1c2goaXRlbSk7XG4gICAgICB9KTtcbiAgICAgIF9kYXRhID0gW107XG4gICAgICBPYmplY3Qua2V5cyhncm91cHMpLmZvckVhY2goZ3JvdXAgPT4ge1xuICAgICAgICBfZGF0YS5wdXNoKHtcbiAgICAgICAgICBsYWJlbDogZ3JvdXAsXG4gICAgICAgICAgaXRlbXM6IGdyb3Vwc1tncm91cF1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIF9kYXRhO1xuICB9XG5cbiAgc3RhdGljIHRyYW5zSXRlbShpdGVtLCBjb25maWc6IERhdGFJdGVtUHJvcHMpIHtcbiAgICBjb25zdCBfaXRlbSA9IHtcbiAgICAgIFtEYXRhSXRlbVV0aWxzLklURU1fTEFCRUxfS0VZXTogRGF0YUl0ZW1VdGlscy5nZXRJdGVtTGFiZWwoaXRlbSwgY29uZmlnLmxhYmVsS2V5IHx8IERhdGFJdGVtVXRpbHMuSVRFTV9MQUJFTF9LRVkpLFxuICAgICAgW0RhdGFJdGVtVXRpbHMuSVRFTV9WQUxVRV9LRVldOiBEYXRhSXRlbVV0aWxzLmdldEl0ZW1WYWx1ZShpdGVtLCBjb25maWcudmFsdWVLZXkpLFxuICAgICAgW0RhdGFJdGVtVXRpbHMuSVRFTV9EQVRBX0tFWV06IGl0ZW1cbiAgICB9O1xuICAgIHJldHVybiBfaXRlbTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRJdGVtVmFsdWUoaXRlbSwgdmFsdWVLZXkpIHtcbiAgICBpZiAoQ29tbW9uc1V0aWxzLmlzU3RyaW5nKGl0ZW0pKSB7XG4gICAgICByZXR1cm4gaXRlbTtcbiAgICB9XG4gICAgaWYgKENvbW1vbnNVdGlscy5pc0FycmF5KGl0ZW0pKSB7XG4gICAgICByZXR1cm4gaXRlbS5tYXAoZGF0YSA9PiBEYXRhSXRlbVV0aWxzLmdldEl0ZW1WYWx1ZShkYXRhLCB2YWx1ZUtleSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlS2V5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZUtleShpdGVtKTtcbiAgICAgIH0gZWxzZSBpZiAoQ29tbW9uc1V0aWxzLmlzQXJyYXkodmFsdWVLZXkpKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0ge307XG4gICAgICAgIHZhbHVlS2V5LmZvckVhY2gocCA9PiB7XG4gICAgICAgICAgY29uc3QgdmFsID0gQ29tbW9uc1V0aWxzLmdldChpdGVtLCBwKTtcbiAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICB2YWx1ZVtwXSA9IHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWVLZXkgPyBDb21tb25zVXRpbHMuZ2V0KGl0ZW0sIHZhbHVlS2V5KSA6IGl0ZW07XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGdldEl0ZW1MYWJlbChpdGVtLCBsYWJlbCkge1xuICAgIGlmIChDb21tb25zVXRpbHMuaXNGdW5jdGlvbihsYWJlbCkpIHtcbiAgICAgIHJldHVybiBsYWJlbChpdGVtKTtcbiAgICB9IGVsc2UgaWYgKGl0ZW0pIHtcbiAgICAgIGlmIChDb21tb25zVXRpbHMuaXNBcnJheShsYWJlbCkpIHtcbiAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICAoPHN0cmluZ1tdPmxhYmVsKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgY29uc3QgbGIgPSBEYXRhSXRlbVV0aWxzLmdldExhYmVsKGl0ZW0sIGtleSk7XG4gICAgICAgICAgaWYgKGxiKSB7XG4gICAgICAgICAgICBzLnB1c2gobGIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIERhdGFJdGVtVXRpbHMuZ2V0TGFiZWwoaXRlbSwgbGFiZWwpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBnZXRMYWJlbChpdGVtLCBsYWJlbEtleSkge1xuICAgIGNvbnN0IGFMYWJlbCA9IENvbW1vbnNVdGlscy5nZXQoaXRlbSwgbGFiZWxLZXkpO1xuICAgIGlmIChhTGFiZWwpIHtcbiAgICAgIHJldHVybiBhTGFiZWw7XG4gICAgfSBlbHNlIGlmIChpdGVtW0RhdGFJdGVtVXRpbHMuSVRFTV9EQVRBX0tFWV0pIHtcbiAgICAgIHJldHVybiBDb21tb25zVXRpbHMuZ2V0KGl0ZW1bRGF0YUl0ZW1VdGlscy5JVEVNX0RBVEFfS0VZXSwgbGFiZWxLZXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaXRlbVtPYmplY3Qua2V5cyhpdGVtKVswXV07XG4gICAgfVxuICB9XG59XG4iXX0=