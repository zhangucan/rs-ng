/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { RegPatterns } from '@er/types';
import { CommonsUtils } from '../comm';
var RegUtils = /** @class */ (function () {
    function RegUtils() {
    }
    /**
     * @param {?} regexStr
     * @return {?}
     */
    RegUtils.escapeRegexp = /**
     * @param {?} regexStr
     * @return {?}
     */
    function (regexStr) {
        /** @type {?} */
        var result = regexStr.replace(/([.?*+^$[\]\\(){}|-])/g, '\\$1');
        return result;
    };
    /**
     * @param {?} pattern
     * @return {?}
     */
    RegUtils.getRegexps = /**
     * @param {?} pattern
     * @return {?}
     */
    function (pattern) {
        var e_1, _a;
        if (!pattern) {
            return [];
        }
        /** @type {?} */
        var exps = [];
        /** @type {?} */
        var patterns = [];
        if (CommonsUtils.isString(pattern)) {
            patterns.push(pattern);
        }
        else {
            patterns.concat(pattern);
        }
        try {
            for (var patterns_1 = tslib_1.__values(patterns), patterns_1_1 = patterns_1.next(); !patterns_1_1.done; patterns_1_1 = patterns_1.next()) {
                var p = patterns_1_1.value;
                if (p) {
                    if (p.indexOf(',') > 0) {
                        exps.concat(RegUtils.getRegexps(p.split(',')));
                    }
                    else {
                        exps.push(RegUtils.getRegexp(p));
                    }
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (patterns_1_1 && !patterns_1_1.done && (_a = patterns_1.return)) _a.call(patterns_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return exps;
    };
    /**
     * @param {?} src
     * @param {?} pattern
     * @return {?}
     */
    RegUtils.test = /**
     * @param {?} src
     * @param {?} pattern
     * @return {?}
     */
    function (src, pattern) {
        /** @type {?} */
        var regex;
        if (typeof pattern === 'string') {
            regex = new RegExp(pattern);
        }
        else {
            regex = pattern;
        }
        if (regex instanceof RegExp) {
            return regex.test(src);
        }
        else if (regex && Array.isArray(regex)) {
            return regex.every(function (item) {
                return RegUtils.test(src, item);
            });
        }
        else if (regex && Array.isArray(regex.and)) {
            return regex.and.every(function (item) {
                return RegUtils.test(src, item);
            });
        }
        else if (regex && Array.isArray(regex.or)) {
            return regex.or.some(function (item) {
                return RegUtils.test(src, item);
            });
        }
        else if (regex && regex.not) {
            return !RegUtils.test(src, regex.not);
        }
        else {
            return false;
        }
    };
    /**
     * @param {?} string
     * @param {?} regex
     * @return {?}
     */
    RegUtils.exec = /**
     * @param {?} string
     * @param {?} regex
     * @return {?}
     */
    function (string, regex) {
        /** @type {?} */
        var self = this;
        if (typeof regex === 'string') {
            regex = new RegExp(regex);
        }
        if (regex instanceof RegExp) {
            return regex.exec(string);
        }
        else if (regex && Array.isArray(regex)) {
            return regex.reduce(function (res, item) {
                return (!!res) ? res : self.exec(string, item);
            }, null);
        }
        else {
            return null;
        }
    };
    /**
     * @private
     * @param {?} pattern
     * @return {?}
     */
    RegUtils.getRegexp = /**
     * @private
     * @param {?} pattern
     * @return {?}
     */
    function (pattern) {
        /** @type {?} */
        var exp = null;
        if (!pattern) {
            return null;
        }
        if (CommonsUtils.isString(pattern)) {
            if (pattern === 'letter') {
                exp = RegPatterns.letter;
            }
            else if (pattern === 'digit') {
                exp = RegPatterns.digit;
            }
            else if (pattern === 'character') {
                exp = RegPatterns.character;
            }
            else if (pattern === 'integer') {
                exp = RegPatterns.integer;
            }
            else if (pattern === 'numeric') {
                exp = RegPatterns.numeric;
            }
            else {
                exp = new RegExp((/** @type {?} */ (pattern)));
            }
        }
        else {
            exp = (/** @type {?} */ (pattern));
        }
        return exp;
    };
    return RegUtils;
}());
export { RegUtils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdXRpbHMvIiwic291cmNlcyI6WyJsaWIvcmVnZXgvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ3RDLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFFckM7SUFBQTtJQW1HQSxDQUFDOzs7OztJQWpHUSxxQkFBWTs7OztJQUFuQixVQUFvQixRQUFnQjs7WUFDNUIsTUFBTSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLEVBQUUsTUFBTSxDQUFDO1FBQ2pFLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Ozs7O0lBRU0sbUJBQVU7Ozs7SUFBakIsVUFBa0IsT0FBOEM7O1FBQzlELElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDWixPQUFPLEVBQUUsQ0FBQztTQUNYOztZQUNLLElBQUksR0FBRyxFQUFFOztZQUNULFFBQVEsR0FBRyxFQUFFO1FBQ25CLElBQUksWUFBWSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNsQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3hCO2FBQU07WUFDTCxRQUFRLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzFCOztZQUNELEtBQWdCLElBQUEsYUFBQSxpQkFBQSxRQUFRLENBQUEsa0NBQUEsd0RBQUU7Z0JBQXJCLElBQU0sQ0FBQyxxQkFBQTtnQkFDVixJQUFJLENBQUMsRUFBRTtvQkFDTCxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFO3dCQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7cUJBQ2hEO3lCQUFNO3dCQUNMLElBQUksQ0FBQyxJ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QUksT0FBTyxLQUFLLFFBQVEsRUFBRTtnQkFDeEIsR0FBRyxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQUM7YUFDMUI7aUJBQU0sSUFBSSxPQUFPLEtBQUssT0FBTyxFQUFFO2dCQUM5QixHQUFHLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQzthQUN6QjtpQkFBTSxJQUFJLE9BQU8sS0FBSyxXQUFXLEVBQUU7Z0JBQ2xDLEdBQUcsR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDO2FBQzdCO2lCQUFNLElBQUksT0FBTyxLQUFLLFNBQVMsRUFBRTtnQkFDaEMsR0FBRyxHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUM7YUFDM0I7aUJBQU0sSUFBSSxPQUFPLEtBQUssU0FBUyxFQUFFO2dCQUNoQyxHQUFHLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQzthQUMzQjtpQkFBTTtnQkFDTCxHQUFHLEdBQUcsSUFBSSxNQUFNLENBQUMsbUJBQUEsT0FBTyxFQUFVLENBQUMsQ0FBQzthQUNyQztTQUNGO2FBQU07WUFDTCxHQUFHLEdBQUcsbUJBQUEsT0FBTyxFQUFVLENBQUM7U0FDekI7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7SUFDSCxlQUFDO0FBQUQsQ0FBQyxBQW5HRCxJQW1HQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7UmVnUGF0dGVybnN9IGZyb20gJ0Blci90eXBlcyc7XG5pbXBvcnQge0NvbW1vbnNVdGlsc30gZnJvbSAnLi4vY29tbSc7XG5cbmV4cG9ydCBjbGFzcyBSZWdVdGlscyB7XG5cbiAgc3RhdGljIGVzY2FwZVJlZ2V4cChyZWdleFN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCByZXN1bHQgPSByZWdleFN0ci5yZXBsYWNlKC8oWy4/KiteJFtcXF1cXFxcKCl7fXwtXSkvZywgJ1xcXFwkMScpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBzdGF0aWMgZ2V0UmVnZXhwcyhwYXR0ZXJuOiBzdHJpbmcgfCBzdHJpbmdbXSB8IFJlZ0V4cCB8IFJlZ0V4cFtdKTogUmVnRXhwW10ge1xuICAgIGlmICghcGF0dGVybikge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBleHBzID0gW107XG4gICAgY29uc3QgcGF0dGVybnMgPSBbXTtcbiAgICBpZiAoQ29tbW9uc1V0aWxzLmlzU3RyaW5nKHBhdHRlcm4pKSB7XG4gICAgICBwYXR0ZXJucy5wdXNoKHBhdHRlcm4pO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYXR0ZXJucy5jb25jYXQocGF0dGVybik7XG4gICAgfVxuICAgIGZvciAoY29uc3QgcCBvZiBwYXR0ZXJucykge1xuICAgICAgaWYgKHApIHtcbiAgICAgICAgaWYgKHAuaW5kZXhPZignLCcpID4gMCkge1xuICAgICAgICAgIGV4cHMuY29uY2F0KFJlZ1V0aWxzLmdldFJlZ2V4cHMocC5zcGxpdCgnLCcpKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXhwcy5wdXNoKFJlZ1V0aWxzLmdldFJlZ2V4cChwKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGV4cHM7XG4gIH1cblxuICBzdGF0aWMgdGVzdChzcmM6IHN0cmluZywgcGF0dGVybjogc3RyaW5nIHwgUmVnRXhwIHwgc3RyaW5nW10gfCBSZWdFeHBbXSB8IHsgYWRuPzogYW55W10sIG9yPzogYW55W10sIG5vdD86IGFueVtdIH0pOiBhbnkge1xuICAgIGxldCByZWdleDtcbiAgICBpZiAodHlwZW9mIHBhdHRlcm4gPT09ICdzdHJpbmcnKSB7XG4gICAgICByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlZ2V4ID0gcGF0dGVybjtcbiAgICB9XG4gICAgaWYgKHJlZ2V4IGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICByZXR1cm4gcmVnZXgudGVzdChzcmMpO1xuICAgIH0gZWxzZSBpZiAocmVnZXggJiYgQXJyYXkuaXNBcnJheShyZWdleCkpIHtcbiAgICAgIHJldHVybiByZWdleC5ldmVyeSgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgIHJldHVybiBSZWdVdGlscy50ZXN0KHNyYywgaXRlbSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHJlZ2V4ICYmIEFycmF5LmlzQXJyYXkocmVnZXguYW5kKSkge1xuICAgICAgcmV0dXJuIHJlZ2V4LmFuZC5ldmVyeSgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgIHJldHVybiBSZWdVdGlscy50ZXN0KHNyYywgaXRlbSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHJlZ2V4ICYmIEFycmF5LmlzQXJyYXkocmVnZXgub3IpKSB7XG4gICAgICByZXR1cm4gcmVnZXgub3Iuc29tZSgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgIHJldHVybiBSZWdVdGlscy50ZXN0KHNyYywgaXRlbSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHJlZ2V4ICYmIHJlZ2V4Lm5vdCkge1xuICAgICAgcmV0dXJuICFSZWdVdGlscy50ZXN0KHNyYywgcmVnZXgubm90KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBleGVjKHN0cmluZzogc3RyaW5nLCByZWdleDogYW55KTogYW55IHtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICBpZiAodHlwZW9mIHJlZ2V4ID09PSAnc3RyaW5nJykge1xuICAgICAgcmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4KTtcbiAgICB9XG5cbiAgICBpZiAocmVnZXggaW5zdGFuY2VvZiBSZWdFeHApIHtcbiAgICAgIHJldHVybiByZWdleC5leGVjKHN0cmluZyk7XG4gICAgfSBlbHNlIGlmIChyZWdleCAmJiBBcnJheS5pc0FycmF5KHJlZ2V4KSkge1xuICAgICAgcmV0dXJuIHJlZ2V4LnJlZHVjZShmdW5jdGlvbiAocmVzOiBhbnksIGl0ZW06IGFueSkge1xuICAgICAgICByZXR1cm4gKCEhcmVzKSA/IHJlcyA6IHNlbGYuZXhlYyhzdHJpbmcsIGl0ZW0pO1xuICAgICAgfSwgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldFJlZ2V4cChwYXR0ZXJuOiBzdHJpbmcgfCBSZWdFeHApOiBSZWdFeHAge1xuICAgIGxldCBleHA6IFJlZ0V4cCA9IG51bGw7XG4gICAgaWYgKCFwYXR0ZXJuKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKENvbW1vbnNVdGlscy5pc1N0cmluZyhwYXR0ZXJuKSkge1xuICAgICAgaWYgKHBhdHRlcm4gPT09ICdsZXR0ZXInKSB7XG4gICAgICAgIGV4cCA9IFJlZ1BhdHRlcm5zLmxldHRlcjtcbiAgICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PT0gJ2RpZ2l0Jykge1xuICAgICAgICBleHAgPSBSZWdQYXR0ZXJucy5kaWdpdDtcbiAgICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PT0gJ2NoYXJhY3RlcicpIHtcbiAgICAgICAgZXhwID0gUmVnUGF0dGVybnMuY2hhcmFjdGVyO1xuICAgICAgfSBlbHNlIGlmIChwYXR0ZXJuID09PSAnaW50ZWdlcicpIHtcbiAgICAgICAgZXhwID0gUmVnUGF0dGVybnMuaW50ZWdlcjtcbiAgICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PT0gJ251bWVyaWMnKSB7XG4gICAgICAgIGV4cCA9IFJlZ1BhdHRlcm5zLm51bWVyaWM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleHAgPSBuZXcgUmVnRXhwKHBhdHRlcm4gYXMgc3RyaW5nKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZXhwID0gcGF0dGVybiBhcyBSZWdFeHA7XG4gICAgfVxuICAgIHJldHVybiBleHA7XG4gIH1cbn1cbiJdfQ==