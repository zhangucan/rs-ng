/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { DateUtils } from '../date';
var IdCardUtils = /** @class */ (function () {
    function IdCardUtils() {
    }
    /**
     * @param {?} idCardNo
     * @return {?}
     */
    IdCardUtils.test = /**
     * @param {?} idCardNo
     * @return {?}
     */
    function (idCardNo) {
        /** @type {?} */
        var format = /^(([1][1-5])|([2][1-3])|([3][1-7])|([4][1-6])|([5][0-4])|([6][1-5])|([7][1])|([8][1-2]))\d{4}(([1][9]\d{2})|([2]\d{3}))(([0][1-9])|([1][0-2]))(([0][1-9])|([1-2][0-9])|([3][0-1]))\d{3}[0-9xX]$/;
        if (!format.test(idCardNo)) {
            return { status: false, 'msg': '身份证号码不合规' };
        }
        /** @type {?} */
        var year = idCardNo.substr(6, 4);
        /** @type {?} */
        var month = idCardNo.substr(10, 2);
        /** @type {?} */
        var date = idCardNo.substr(12, 2);
        /** @type {?} */
        var time = Date.parse(month + '-' + date + '-' + year);
        /** @type {?} */
        var now_time = Date.parse(DateUtils.getDate());
        /** @type {?} */
        var dates = (new Date(year, month, 0)).getDate();
        if (time > now_time || date > dates) {
            return { status: false, msg: '出生日期不合规' };
        }
        /** @type {?} */
        var c = new Array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2);
        /** @type {?} */
        var b = new Array('1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2');
        /** @type {?} */
        var id_array = idCardNo.split('');
        /** @type {?} */
        var sum = 0;
        for (var k = 0; k < 17; k++) {
            sum += parseInt(id_array[k]) * c[k];
        }
        if (id_array[17].toUpperCase() !== b[sum % 11].toUpperCase()) {
            return { status: false, msg: '身份证校验码不合规' };
        }
        return { status: true };
    };
    /**
     * @param {?} idCardNo
     * @return {?}
     */
    IdCardUtils.parse = /**
     * @param {?} idCardNo
     * @return {?}
     */
    function (idCardNo) {
        if (!IdCardUtils.test(idCardNo).status) {
            return {};
        }
        /** @type {?} */
        var res = {};
        /** @type {?} */
        var idxSexStart = idCardNo.length === 15 ? 14 : 16;
        /** @type {?} */
        var birthYearSpan = idCardNo.length === 15 ? 2 : 4;
        /** @type {?} */
        var idxSex = 1 - idCardNo.substr(idxSexStart, 1) % 2;
        res.gender = (idxSex === 1 ? '女' : '男');
        /** @type {?} */
        var year = (birthYearSpan === 2 ? '19' : '') + idCardNo.substr(6, birthYearSpan);
        /** @type {?} */
        var month = idCardNo.substr(6 + birthYearSpan, 2);
        /** @type {?} */
        var day = idCardNo.substr(8 + birthYearSpan, 2);
        res.birthday = year + '-' + month + '-' + day;
        /** @type {?} */
        var d = DateUtils.getDate();
        /** @type {?} */
        var monthFloor = ((d.getMonth() + 1) < parseInt(month, 10) || (d.getMonth() + 1) === parseInt(month, 10) && d.getDate() < parseInt(day, 10)) ? 1 : 0;
        res.age = d.getFullYear() - parseInt(year, 10) - monthFloor;
        return res;
    };
    ;
    return IdCardUtils;
}());
export { IdCardUtils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdXRpbHMvIiwic291cmNlcyI6WyJsaWIvaWQtY2FyZC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUVsQztJQUFBO0lBNkRBLENBQUM7Ozs7O0lBM0RRLGdCQUFJOzs7O0lBQVgsVUFBWSxRQUFROztZQUVaLE1BQU0sR0FBRyxpTUFBaU07UUFFaE4sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDMUIsT0FBTyxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBQyxDQUFDO1NBQzNDOztZQUVLLElBQUksR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7O1lBQ2hDLEtBQUssR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7O1lBQzlCLElBQUksR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7O1lBQzdCLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUM7O1lBQ2xELFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsQ0FBQzs7WUFDMUMsS0FBSyxHQUFHLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRTtRQUM5QyxJQUFJLElBQUksR0FBRyxRQUFRLElBQUksSUFBSSxHQUFHLEtBQUssRUFBRTtZQUNuQyxPQUFPLEVBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFDLENBQUM7U0FDeEM7O1lBRUssQ0FBQyxHQUFHLElBQUksS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7O1lBQ2xFLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDOztZQUNwRSxRQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7O1lBQy9CLEdBQUcsR0FBRyxDQUFDO1FBQ1gsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUMzQixHQUFHLElBQUksUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNyQztRQUNELElBQUksUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDNUQsT0FBTyxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBQyxDQUFDO1NBQzFDO1FBQ0QsT0FBTyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUMsQ0FBQztJQUN4QixDQUFDOzs7OztJQUVNLGlCQUFLOzs7O0lBQVosVUFBYSxRQUFRO1FBRW5CLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sRUFBRTtZQUN0QyxPQUFPLEVBQUUsQ0FBQztTQUNYOztZQUVLLEdBQUcsR0FBeUQsRUFBRTs7WUFFOUQsV0FBVyxHQUFHLFFBQVEsQ0FBQyxNQUFNLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUU7O1lBRTlDLGFBQWEsR0FBRyxRQUFRLENBQUMsTUFBTSxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDOztZQUU5QyxNQUFNLEdBQUcsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUM7UUFFdEQsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7O1lBRWxDLElBQUksR0FBRyxDQUFDLGFBQWEsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsYUFBYSxDQUFDOztZQUM1RSxLQUFLLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsYUFBYSxFQUFFLENBQUMsQ0FBQzs7WUFDN0MsR0FBRyxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLGFBQWEsRUFBRSxDQUFDLENBQUM7UUFDakQsR0FBRyxDQUFDLFFBQVEsR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDOztZQUV4QyxDQUFDLEdBQUcsU0FBUyxDQUFDLE9BQU8sRUFBRTs7WUFDdkIsVUFBVSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUMsS0FBSyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUUsR0FBRyxRQUFRLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0SixHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUUsR0FBRyxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQztRQUU1RCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUM7SUFBQSxDQUFDO0lBRUosa0JBQUM7QUFBRCxDQUFDLEFBN0RELElBNkRDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEYXRlVXRpbHN9IGZyb20gJy4uL2RhdGUnO1xuXG5leHBvcnQgY2xhc3MgSWRDYXJkVXRpbHMge1xuXG4gIHN0YXRpYyB0ZXN0KGlkQ2FyZE5vKSB7XG5cbiAgICBjb25zdCBmb3JtYXQgPSAvXigoWzFdWzEtNV0pfChbMl1bMS0zXSl8KFszXVsxLTddKXwoWzRdWzEtNl0pfChbNV1bMC00XSl8KFs2XVsxLTVdKXwoWzddWzFdKXwoWzhdWzEtMl0pKVxcZHs0fSgoWzFdWzldXFxkezJ9KXwoWzJdXFxkezN9KSkoKFswXVsxLTldKXwoWzFdWzAtMl0pKSgoWzBdWzEtOV0pfChbMS0yXVswLTldKXwoWzNdWzAtMV0pKVxcZHszfVswLTl4WF0kLztcblxuICAgIGlmICghZm9ybWF0LnRlc3QoaWRDYXJkTm8pKSB7XG4gICAgICByZXR1cm4ge3N0YXR1czogZmFsc2UsICdtc2cnOiAn6Lqr5Lu96K+B5Y+356CB5LiN5ZCI6KeEJ307XG4gICAgfVxuXG4gICAgY29uc3QgeWVhciA9IGlkQ2FyZE5vLnN1YnN0cig2LCA0KSxcbiAgICAgIG1vbnRoID0gaWRDYXJkTm8uc3Vic3RyKDEwLCAyKSxcbiAgICAgIGRhdGUgPSBpZENhcmROby5zdWJzdHIoMTIsIDIpLFxuICAgICAgdGltZSA9IERhdGUucGFyc2UobW9udGggKyAnLScgKyBkYXRlICsgJy0nICsgeWVhciksXG4gICAgICBub3dfdGltZSA9IERhdGUucGFyc2UoRGF0ZVV0aWxzLmdldERhdGUoKSksXG4gICAgICBkYXRlcyA9IChuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkpLmdldERhdGUoKTtcbiAgICBpZiAodGltZSA+IG5vd190aW1lIHx8IGRhdGUgPiBkYXRlcykge1xuICAgICAgcmV0dXJuIHtzdGF0dXM6IGZhbHNlLCBtc2c6ICflh7rnlJ/ml6XmnJ/kuI3lkIjop4QnfTtcbiAgICB9XG5cbiAgICBjb25zdCBjID0gbmV3IEFycmF5KDcsIDksIDEwLCA1LCA4LCA0LCAyLCAxLCA2LCAzLCA3LCA5LCAxMCwgNSwgOCwgNCwgMik7XG4gICAgY29uc3QgYiA9IG5ldyBBcnJheSgnMScsICcwJywgJ1gnLCAnOScsICc4JywgJzcnLCAnNicsICc1JywgJzQnLCAnMycsICcyJyk7XG4gICAgY29uc3QgaWRfYXJyYXkgPSBpZENhcmROby5zcGxpdCgnJyk7XG4gICAgbGV0IHN1bSA9IDA7XG4gICAgZm9yIChsZXQgayA9IDA7IGsgPCAxNzsgaysrKSB7XG4gICAgICBzdW0gKz0gcGFyc2VJbnQoaWRfYXJyYXlba10pICogY1trXTtcbiAgICB9XG4gICAgaWYgKGlkX2FycmF5WzE3XS50b1VwcGVyQ2FzZSgpICE9PSBiW3N1bSAlIDExXS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICByZXR1cm4ge3N0YXR1czogZmFsc2UsIG1zZzogJ+i6q+S7veivgeagoemqjOeggeS4jeWQiOinhCd9O1xuICAgIH1cbiAgICByZXR1cm4ge3N0YXR1czogdHJ1ZX07XG4gIH1cblxuICBzdGF0aWMgcGFyc2UoaWRDYXJkTm8pOiB7IGdlbmRlcj86IHN0cmluZywgYmlydGhkYXk/OiBzdHJpbmcsIGFnZT86IG51bWJlciB9IHtcblxuICAgIGlmICghSWRDYXJkVXRpbHMudGVzdChpZENhcmRObykuc3RhdHVzKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgY29uc3QgcmVzOiB7IGdlbmRlcj86IHN0cmluZywgYmlydGhkYXk/OiBzdHJpbmcsIGFnZT86IG51bWJlciB9ID0ge307XG5cbiAgICBjb25zdCBpZHhTZXhTdGFydCA9IGlkQ2FyZE5vLmxlbmd0aCA9PT0gMTUgPyAxNCA6IDE2O1xuXG4gICAgY29uc3QgYmlydGhZZWFyU3BhbiA9IGlkQ2FyZE5vLmxlbmd0aCA9PT0gMTUgPyAyIDogNDtcblxuICAgIGNvbnN0IGlkeFNleCA9IDEgLSBpZENhcmROby5zdWJzdHIoaWR4U2V4U3RhcnQsIDEpICUgMjtcblxuICAgIHJlcy5nZW5kZXIgPSAoaWR4U2V4ID09PSAxID8gJ+WlsycgOiAn55S3Jyk7XG5cbiAgICBjb25zdCB5ZWFyID0gKGJpcnRoWWVhclNwYW4gPT09IDIgPyAnMTknIDogJycpICsgaWRDYXJkTm8uc3Vic3RyKDYsIGJpcnRoWWVhclNwYW4pO1xuICAgIGNvbnN0IG1vbnRoID0gaWRDYXJkTm8uc3Vic3RyKDYgKyBiaXJ0aFllYXJTcGFuLCAyKTtcbiAgICBjb25zdCBkYXkgPSBpZENhcmROby5zdWJzdHIoOCArIGJpcnRoWWVhclNwYW4sIDIpO1xuICAgIHJlcy5iaXJ0aGRheSA9IHllYXIgKyAnLScgKyBtb250aCArICctJyArIGRheTtcblxuICAgIGNvbnN0IGQgPSBEYXRlVXRpbHMuZ2V0RGF0ZSgpO1xuICAgIGNvbnN0IG1vbnRoRmxvb3IgPSAoKGQuZ2V0TW9udGgoKSArIDEpIDwgcGFyc2VJbnQobW9udGgsIDEwKSB8fCAoZC5nZXRNb250aCgpICsgMSkgPT09IHBhcnNlSW50KG1vbnRoLCAxMCkgJiYgZC5nZXREYXRlKCkgPCBwYXJzZUludChkYXksIDEwKSkgPyAxIDogMDtcbiAgICByZXMuYWdlID0gZC5nZXRGdWxsWWVhcigpIC0gcGFyc2VJbnQoeWVhciwgMTApIC0gbW9udGhGbG9vcjtcblxuICAgIHJldHVybiByZXM7XG4gIH07XG5cbn1cbiJdfQ==