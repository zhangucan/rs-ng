/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { forwardRef, Inject, Injectable } from '@angular/core';
import { Ng2ImgMaxService } from 'ng2-img-max';
import { Subject } from 'rxjs';
import { ImgCropService } from './img-crop.service';
import { ImgResizeExactService } from './img-resize-exact.service';
import * as i0 from "@angular/core";
import * as i1 from "./img-resize-exact.service";
import * as i2 from "ng2-img-max/dist/src/ng2-img-max.service";
import * as i3 from "./img-crop.service";
export class ImageToolsService {
    /**
     * @param {?} imgResizeExactService
     * @param {?} ng2ImgMaxService
     * @param {?} imgCropService
     */
    constructor(imgResizeExactService, ng2ImgMaxService, imgCropService) {
        this.imgResizeExactService = imgResizeExactService;
        this.ng2ImgMaxService = ng2ImgMaxService;
        this.imgCropService = imgCropService;
    }
    /**
     * @param {?} files
     * @param {?} maxSizeInMB
     * @param {?=} ignoreAlpha
     * @param {?=} logExecutionTime
     * @return {?}
     */
    compress(files, maxSizeInMB, ignoreAlpha = false, logExecutionTime = false) {
        return this.ng2ImgMaxService.compress(files, maxSizeInMB, ignoreAlpha, logExecutionTime);
    }
    /**
     * @param {?} files
     * @param {?} maxWidth
     * @param {?} maxHeight
     * @param {?=} logExecutionTime
     * @return {?}
     */
    resize(files, maxWidth, maxHeight, logExecutionTime = false) {
        return this.ng2ImgMaxService.resize(files, maxWidth, maxHeight, logExecutionTime);
    }
    /**
     * @param {?} files
     * @param {?} toWidth
     * @param {?} toHeight
     * @param {?=} startX
     * @param {?=} startY
     * @return {?}
     */
    crop(files, toWidth, toHeight, startX = 0, startY = 0) {
        /** @type {?} */
        const croppedFileSubject = new Subject();
        files.forEach((file) => {
            this.cropImage(file, toWidth, toHeight, startX, startY).subscribe((value) => {
                croppedFileSubject.next(value);
            }, error => {
                croppedFileSubject.error(error);
            });
        });
        return croppedFileSubject.asObservable();
    }
    /**
     * @param {?} files
     * @param {?} toWidth
     * @param {?} toHeight
     * @return {?}
     */
    resizeExactCrop(files, toWidth, toHeight) {
        /** @type {?} */
        const resizedFileSubject = new Subject();
        files.forEach((file) => {
            this.resizeExactCropImage(file, toWidth, toHeight).subscribe((value) => {
                resizedFileSubject.next(value);
            }, error => {
                resizedFileSubject.error(error);
            });
        });
        return resizedFileSubject.asObservable();
    }
    /**
     * @param {?} files
     * @param {?} toWidth
     * @param {?} toHeight
     * @param {?=} fillColor
     * @return {?}
     */
    resizeExactFill(files, toWidth, toHeight, fillColor) {
        /** @type {?} */
        const resizedFileSubject = new Subject();
        files.forEach((file) => {
            this.resizeExactFillImage(file, toWidth, toHeight, fillColor).subscribe((value) => {
                resizedFileSubject.next(value);
            }, error => {
                resizedFileSubject.error(error);
            });
        });
        return resizedFileSubject.asObservable();
    }
    /**
     * @param {?} file
     * @param {?} toWidth
     * @param {?} toHeight
     * @param {?=} fillColor
     * @return {?}
     */
    resizeExactFillImage(file, toWidth, toHeight, fillColor) {
        return this.imgResizeExactService.resizeExactFill(file, toWidth, toHeight, fillColor);
    }
    /**
     * @param {?} file
     * @param {?} toWidth
     * @param {?} toHeight
     * @return {?}
     */
    resizeExactCropImage(file, toWidth, toHeight) {
        return this.imgResizeExactService.resizeExactCrop(file, toWidth, toHeight);
    }
    /**
     * @param {?} file
     * @param {?} toWidth
     * @param {?} toHeight
     * @param {?=} startX
     * @param {?=} startY
     * @return {?}
     */
    cropImage(file, toWidth, toHeight, startX = 0, startY = 0) {
        return this.imgCropService.cropImage(file, toWidth, toHeight, startX, startY);
    }
    /**
     * @param {?} file
     * @param {?} maxSizeInMB
     * @param {?=} ignoreAlpha
     * @param {?=} logExecutionTime
     * @return {?}
     */
    compressImage(file, maxSizeInMB, ignoreAlpha = false, logExecutionTime = false) {
        return this.ng2ImgMaxService.compressImage(file, maxSizeInMB, ignoreAlpha, logExecutionTime);
    }
    /**
     * @param {?} file
     * @param {?} maxWidth
     * @param {?} maxHeight
     * @param {?=} logExecutionTime
     * @return {?}
     */
    resizeImage(file, maxWidth, maxHeight, logExecutionTime = false) {
        return this.ng2ImgMaxService.resizeImage(file, maxWidth, maxHeight, logExecutionTime);
    }
    /**
     * @param {?} image
     * @return {?}
     */
    getEXIFOrientedImage(image) {
        return this.ng2ImgMaxService.getEXIFOrientedImage(image);
    }
}
ImageToolsService.decorators = [
    { type: Injectable, args: [{ providedIn: 'root' },] }
];
/** @nocollapse */
ImageToolsService.ctorParameters = () => [
    { type: ImgResizeExactService, decorators: [{ type: Inject, args: [forwardRef(() => ImgResizeExactService),] }] },
    { type: Ng2ImgMaxService, decorators: [{ type: Inject, args: [forwardRef(() => Ng2ImgMaxService),] }] },
    { type: ImgCropService, decorators: [{ type: Inject, args: [forwardRef(() => ImgCropService),] }] }
];
/** @nocollapse */ ImageToolsService.ngInjectableDef = i0.defineInjectable({ factory: function ImageToolsService_Factory() { return new ImageToolsService(i0.inject(i1.ImgResizeExactService), i0.inject(i2.Ng2ImgMaxService), i0.inject(i3.ImgCropService)); }, token: ImageToolsService, providedIn: "root" });
if (false) {
    /**
     * @type {?}
     * @private
     */
    ImageToolsService.prototype.imgResizeExactService;
    /**
     * @type {?}
     * @private
     */
    ImageToolsService.prototype.ng2ImgMaxService;
    /**
     * @type {?}
     * @private
     */
    ImageToolsService.prototype.imgCropService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2UtdG9vbHMuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Blci9zaGFyZS8iLCJzb3VyY2VzIjpbImxpYi9pbWFnZS1lZGl0b3Ivc2VydmljZXMvaW1hZ2UtdG9vbHMuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFVBQVUsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzdELE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUM3QyxPQUFPLEVBQWEsT0FBTyxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBQ3pDLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUNsRCxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSw0QkFBNEIsQ0FBQzs7Ozs7QUFLakUsTUFBTSxPQUFPLGlCQUFpQjs7Ozs7O0lBQzVCLFlBQXFFLHFCQUE0QyxFQUNqRCxnQkFBa0MsRUFDcEMsY0FBOEI7UUFGdkIsMEJBQXFCLEdBQXJCLHFCQUFxQixDQUF1QjtRQUNqRCxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQ3BDLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtJQUM1RixDQUFDOzs7Ozs7OztJQUVNLFFBQVEsQ0FBQyxLQUFhLEVBQUUsV0FBbUIsRUFBRSxjQUF1QixLQUFLLEVBQUUsbUJBQTRCLEtBQUs7UUFDakgsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDM0YsQ0FBQzs7Ozs7Ozs7SUFFTSxNQUFNLENBQUMsS0FBYSxFQUFFLFFBQWdCLEVBQUUsU0FBaUIsRUFBRSxtQkFBNEIsS0FBSztRQUNqRyxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLENBQUMs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QUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ2hGLENBQUM7Ozs7Ozs7O0lBRU0sYUFBYSxDQUFDLElBQVUsRUFBRSxXQUFtQixFQUFFLGNBQXVCLEtBQUssRUFBRSxtQkFBNEIsS0FBSztRQUNuSCxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztJQUMvRixDQUFDOzs7Ozs7OztJQUVNLFdBQVcsQ0FBQyxJQUFVLEVBQUUsUUFBZ0IsRUFBRSxTQUFpQixFQUFFLG1CQUE0QixLQUFLO1FBQ25HLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ3hGLENBQUM7Ozs7O0lBRU0sb0JBQW9CLENBQUMsS0FBdUI7UUFDakQsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDM0QsQ0FBQzs7O1lBM0VGLFVBQVUsU0FDVCxFQUFDLFVBQVUsRUFBRSxNQUFNLEVBQUM7Ozs7WUFIZCxxQkFBcUIsdUJBTWQsTUFBTSxTQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxxQkFBcUIsQ0FBQztZQVRyRCxnQkFBZ0IsdUJBVVQsTUFBTSxTQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQztZQVJoRCxjQUFjLHVCQVNQLE1BQU0sU0FBQyxVQUFVLENBQUMsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDOzs7Ozs7OztJQUZ4QyxrREFBcUc7Ozs7O0lBQ3JHLDZDQUFzRjs7Ozs7SUFDdEYsMkNBQWdGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtmb3J3YXJkUmVmLCBJbmplY3QsIEluamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtOZzJJbWdNYXhTZXJ2aWNlfSBmcm9tICduZzItaW1nLW1heCc7XG5pbXBvcnQge09ic2VydmFibGUsIFN1YmplY3R9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtJbWdDcm9wU2VydmljZX0gZnJvbSAnLi9pbWctY3JvcC5zZXJ2aWNlJztcbmltcG9ydCB7SW1nUmVzaXplRXhhY3RTZXJ2aWNlfSBmcm9tICcuL2ltZy1yZXNpemUtZXhhY3Quc2VydmljZSc7XG5cbkBJbmplY3RhYmxlKFxuICB7cHJvdmlkZWRJbjogJ3Jvb3QnfVxuKVxuZXhwb3J0IGNsYXNzIEltYWdlVG9vbHNTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoQEluamVjdChmb3J3YXJkUmVmKCgpID0+IEltZ1Jlc2l6ZUV4YWN0U2VydmljZSkpIHByaXZhdGUgaW1nUmVzaXplRXhhY3RTZXJ2aWNlOiBJbWdSZXNpemVFeGFjdFNlcnZpY2UsXG4gICAgICAgICAgICAgIEBJbmplY3QoZm9yd2FyZFJlZigoKSA9PiBOZzJJbWdNYXhTZXJ2aWNlKSkgcHJpdmF0ZSBuZzJJbWdNYXhTZXJ2aWNlOiBOZzJJbWdNYXhTZXJ2aWNlLFxuICAgICAgICAgICAgICBASW5qZWN0KGZvcndhcmRSZWYoKCkgPT4gSW1nQ3JvcFNlcnZpY2UpKSBwcml2YXRlIGltZ0Nyb3BTZXJ2aWNlOiBJbWdDcm9wU2VydmljZSkge1xuICB9XG5cbiAgcHVibGljIGNvbXByZXNzKGZpbGVzOiBGaWxlW10sIG1heFNpemVJbk1COiBudW1iZXIsIGlnbm9yZUFscGhhOiBib29sZWFuID0gZmFsc2UsIGxvZ0V4ZWN1dGlvblRpbWU6IGJvb2xlYW4gPSBmYWxzZSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMubmcySW1nTWF4U2VydmljZS5jb21wcmVzcyhmaWxlcywgbWF4U2l6ZUluTUIsIGlnbm9yZUFscGhhLCBsb2dFeGVjdXRpb25UaW1lKTtcbiAgfVxuXG4gIHB1YmxpYyByZXNpemUoZmlsZXM6IEZpbGVbXSwgbWF4V2lkdGg6IG51bWJlciwgbWF4SGVpZ2h0OiBudW1iZXIsIGxvZ0V4ZWN1dGlvblRpbWU6IGJvb2xlYW4gPSBmYWxzZSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMubmcySW1nTWF4U2VydmljZS5yZXNpemUoZmlsZXMsIG1heFdpZHRoLCBtYXhIZWlnaHQsIGxvZ0V4ZWN1dGlvblRpbWUpO1xuICB9XG5cbiAgcHVibGljIGNyb3AoZmlsZXM6IEZpbGVbXSwgdG9XaWR0aDogbnVtYmVyLCB0b0hlaWdodDogbnVtYmVyLCBzdGFydFg6IG51bWJlciA9IDAsIHN0YXJ0WTogbnVtYmVyID0gMCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3QgY3JvcHBlZEZpbGVTdWJqZWN0OiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgZmlsZXMuZm9yRWFjaCgoZmlsZSkgPT4ge1xuICAgICAgdGhpcy5jcm9wSW1hZ2UoZmlsZSwgdG9XaWR0aCwgdG9IZWlnaHQsIHN0YXJ0WCwgc3RhcnRZKS5zdWJzY3JpYmUoKHZhbHVlKSA9PiB7XG4gICAgICAgIGNyb3BwZWRGaWxlU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgY3JvcHBlZEZpbGVTdWJqZWN0LmVycm9yKGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjcm9wcGVkRmlsZVN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBwdWJsaWMgcmVzaXplRXhhY3RDcm9wKGZpbGVzOiBGaWxlW10sIHRvV2lkdGg6IG51bWJlciwgdG9IZWlnaHQ6IG51bWJlcik6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3QgcmVzaXplZEZpbGVTdWJqZWN0OiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgZmlsZXMuZm9yRWFjaCgoZmlsZSkgPT4ge1xuICAgICAgdGhpcy5yZXNpemVFeGFjdENyb3BJbWFnZShmaWxlLCB0b1dpZHRoLCB0b0hlaWdodCkuc3Vic2NyaWJlKCh2YWx1ZSkgPT4ge1xuICAgICAgICByZXNpemVkRmlsZVN1YmplY3QubmV4dCh2YWx1ZSk7XG4gICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgIHJlc2l6ZWRGaWxlU3ViamVjdC5lcnJvcihlcnJvcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzaXplZEZpbGVTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xuICB9XG5cbiAgcHVibGljIHJlc2l6ZUV4YWN0RmlsbChmaWxlczogRmlsZVtdLCB0b1dpZHRoOiBudW1iZXIsIHRvSGVpZ2h0OiBudW1iZXIsIGZpbGxDb2xvcj86IHN0cmluZyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgY29uc3QgcmVzaXplZEZpbGVTdWJqZWN0OiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gICAgZmlsZXMuZm9yRWFjaCgoZmlsZSkgPT4ge1xuICAgICAgdGhpcy5yZXNpemVFeGFjdEZpbGxJbWFnZShmaWxlLCB0b1dpZHRoLCB0b0hlaWdodCwgZmlsbENvbG9yKS5zdWJzY3JpYmUoKHZhbHVlKSA9PiB7XG4gICAgICAgIHJlc2l6ZWRGaWxlU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgcmVzaXplZEZpbGVTdWJqZWN0LmVycm9yKGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiByZXNpemVkRmlsZVN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG4gIH1cblxuICBwdWJsaWMgcmVzaXplRXhhY3RGaWxsSW1hZ2UoZmlsZTogRmlsZSwgdG9XaWR0aDogbnVtYmVyLCB0b0hlaWdodDogbnVtYmVyLCBmaWxsQ29sb3I/OiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmltZ1Jlc2l6ZUV4YWN0U2VydmljZS5yZXNpemVFeGFjdEZpbGwoZmlsZSwgdG9XaWR0aCwgdG9IZWlnaHQsIGZpbGxDb2xvcik7XG4gIH1cblxuICBwdWJsaWMgcmVzaXplRXhhY3RDcm9wSW1hZ2UoZmlsZTogRmlsZSwgdG9XaWR0aDogbnVtYmVyLCB0b0hlaWdodDogbnVtYmVyKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5pbWdSZXNpemVFeGFjdFNlcnZpY2UucmVzaXplRXhhY3RDcm9wKGZpbGUsIHRvV2lkdGgsIHRvSGVpZ2h0KTtcbiAgfVxuXG4gIHB1YmxpYyBjcm9wSW1hZ2UoZmlsZTogRmlsZSwgdG9XaWR0aDogbnVtYmVyLCB0b0hlaWdodDogbnVtYmVyLCBzdGFydFg6IG51bWJlciA9IDAsIHN0YXJ0WTogbnVtYmVyID0gMCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuaW1nQ3JvcFNlcnZpY2UuY3JvcEltYWdlKGZpbGUsIHRvV2lkdGgsIHRvSGVpZ2h0LCBzdGFydFgsIHN0YXJ0WSk7XG4gIH1cblxuICBwdWJsaWMgY29tcHJlc3NJbWFnZShmaWxlOiBGaWxlLCBtYXhTaXplSW5NQjogbnVtYmVyLCBpZ25vcmVBbHBoYTogYm9vbGVhbiA9IGZhbHNlLCBsb2dFeGVjdXRpb25UaW1lOiBib29sZWFuID0gZmFsc2UpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLm5nMkltZ01heFNlcnZpY2UuY29tcHJlc3NJbWFnZShmaWxlLCBtYXhTaXplSW5NQiwgaWdub3JlQWxwaGEsIGxvZ0V4ZWN1dGlvblRpbWUpO1xuICB9XG5cbiAgcHVibGljIHJlc2l6ZUltYWdlKGZpbGU6IEZpbGUsIG1heFdpZHRoOiBudW1iZXIsIG1heEhlaWdodDogbnVtYmVyLCBsb2dFeGVjdXRpb25UaW1lOiBib29sZWFuID0gZmFsc2UpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLm5nMkltZ01heFNlcnZpY2UucmVzaXplSW1hZ2UoZmlsZSwgbWF4V2lkdGgsIG1heEhlaWdodCwgbG9nRXhlY3V0aW9uVGltZSk7XG4gIH1cblxuICBwdWJsaWMgZ2V0RVhJRk9yaWVudGVkSW1hZ2UoaW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQpOiBQcm9taXNlPEhUTUxJbWFnZUVsZW1lbnQ+IHtcbiAgICByZXR1cm4gdGhpcy5uZzJJbWdNYXhTZXJ2aWNlLmdldEVYSUZPcmllbnRlZEltYWdlKGltYWdlKTtcbiAgfVxufVxuIl19