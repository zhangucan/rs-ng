/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { FormArray, FormControl, FormGroup } from '@angular/forms';
import { CommonsUtils } from '@er/utils';
import { NgValidateMessages } from '../validators/all';
export class ValidateUtils {
    /**
     * @param {?} form
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    static getFormErrors(form, messages, formlyfield) {
        /** @type {?} */
        const errors = {};
        if (form instanceof FormControl) {
            return (ValidateUtils.getControlErrors((/** @type {?} */ (form)), messages, formlyfield));
        }
        else if (form instanceof FormGroup) {
            Object.keys(form.controls).map(name => errors[name] = (ValidateUtils.getFormErrors((/** @type {?} */ (form.controls[name])), messages, formlyfield)));
        }
        else if (form instanceof FormArray) {
            /** @type {?} */
            const err = [];
            ((/** @type {?} */ (form.controls[name]))).controls.forEach(control => err.push((ValidateUtils.getFormErrors(control, messages, formlyfield))));
            return err;
        }
        return errors;
    }
    /**
     * @param {?} control
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    static getControlErrors(control, messages, formlyfield) {
        return ValidateUtils.getErrorMessage(control.errors, messages, formlyfield);
    }
    /**
     * @param {?} errors
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    static getErrorMessage(errors, messages, formlyfield) {
        if (!errors) {
            return {};
        }
        /** @type {?} */
        const errorMessages = {};
        Object.keys(errors).forEach(key => {
            /** @type {?} */
            let message;
            if (formlyfield) {
                if (formlyfield.validators && formlyfield.validators[key] && formlyfield.validators[key].message) {
                    message = formlyfield.validators[key].message;
                }
                else if (formlyfield.asyncValidators && formlyfield.asyncValidators[key] && formlyfield.asyncValidators[key].message) {
                    message = formlyfield.asyncValidators[key].message;
                }
            }
            if (!message) {
                if (messages && messages.hasOwnProperty(key)) {
                    message = messages[key];
                }
                else if (NgValidateMessages.hasOwnProperty(key)) {
                    message = NgValidateMessages[key];
                }
                else {
                    message = key;
                }
            }
            if (typeof message === 'string') {
                errorMessages[key] = message;
            }
            else if (typeof message === 'function') {
                errorMessages[key] = message.apply(this, [errors[key], formlyfield]);
            }
        });
        return errorMessages;
    }
    /**
     * @param {?} error
     * @param {?=} context
     * @return {?}
     */
    static dynaValidationMessageFn(error, context) {
        /** @type {?} */
        let values = [];
        if (CommonsUtils.isJson(error) && context.errorProps) {
            if (Array.isArray(context.errorProps)) {
                context.errorProps.forEach(key => values.push(error[key]));
            }
            else {
                values.push(error[context.errorProps]);
            }
        }
        else {
            /** @type {?} */
            const dyna = CommonsUtils.get(context, 'validation.dyna', []);
            /** @type {?} */
            const info = CommonsUtils.find(dyna, { key: context.errorKey });
            if (info) {
                values = info['args'] || [];
            }
        }
        return CommonsUtils.templateStr(context.format, values);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdmFsaWRhdGUvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBa0IsU0FBUyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQW1CLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEcsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUN2QyxPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUdyRCxNQUFNLE9BQU8sYUFBYTs7Ozs7OztJQUV4QixNQUFNLENBQUMsYUFBYSxDQUFDLElBQXFCLEVBQUUsUUFBb0MsRUFBRSxXQUFpQjs7Y0FDM0YsTUFBTSxHQUFHLEVBQUU7UUFDakIsSUFBSSxJQUFJLFlBQVksV0FBVyxFQUFFO1lBQy9CLE9BQU8sQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsbUJBQWEsSUFBSSxFQUFBLEVBQUUsUUFBUSxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUM7U0FDbkY7YUFBTSxJQUFJLElBQUksWUFBWSxTQUFTLEVBQUU7WUFDcEMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQ3BDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsbUJBQVcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBQSxFQUFFLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUNwRyxDQUFDO1NBQ0g7YUFBTSxJQUFJLElBQUksWUFBWSxTQUFTLEVBQUU7O2tCQUM5QixHQUFHLEdBQUcsRUFBRTtZQUNkLENBQUMsbUJBQVcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBQSxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFB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Q0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7YUFDeEM7U0FDRjthQUFNOztrQkFDQyxJQUFJLEdBQVUsWUFBWSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsRUFBRSxDQUFDOztrQkFDOUQsSUFBSSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUMsQ0FBQztZQUM3RCxJQUFJLElBQUksRUFBRTtnQkFDUixNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQzthQUM3QjtTQUNGO1FBQ0QsT0FBTyxZQUFZLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDMUQsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBYnN0cmFjdENvbnRyb2wsIEZvcm1BcnJheSwgRm9ybUNvbnRyb2wsIEZvcm1Hcm91cCwgVmFsaWRhdGlvbkVycm9yc30gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtDb21tb25zVXRpbHN9IGZyb20gJ0Blci91dGlscyc7XG5pbXBvcnQge05nVmFsaWRhdGVNZXNzYWdlc30gZnJvbSAnLi4vdmFsaWRhdG9ycy9hbGwnO1xuXG5cbmV4cG9ydCBjbGFzcyBWYWxpZGF0ZVV0aWxzIHtcblxuICBzdGF0aWMgZ2V0Rm9ybUVycm9ycyhmb3JtOiBBYnN0cmFjdENvbnRyb2wsIG1lc3NhZ2VzPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSwgZm9ybWx5ZmllbGQ/OiBhbnkpIHtcbiAgICBjb25zdCBlcnJvcnMgPSB7fTtcbiAgICBpZiAoZm9ybSBpbnN0YW5jZW9mIEZvcm1Db250cm9sKSB7XG4gICAgICByZXR1cm4gKFZhbGlkYXRlVXRpbHMuZ2V0Q29udHJvbEVycm9ycyg8Rm9ybUNvbnRyb2w+Zm9ybSwgbWVzc2FnZXMsIGZvcm1seWZpZWxkKSk7XG4gICAgfSBlbHNlIGlmIChmb3JtIGluc3RhbmNlb2YgRm9ybUdyb3VwKSB7XG4gICAgICBPYmplY3Qua2V5cyhmb3JtLmNvbnRyb2xzKS5tYXAobmFtZSA9PlxuICAgICAgICBlcnJvcnNbbmFtZV0gPSAoVmFsaWRhdGVVdGlscy5nZXRGb3JtRXJyb3JzKDxGb3JtR3JvdXA+Zm9ybS5jb250cm9sc1tuYW1lXSwgbWVzc2FnZXMsIGZvcm1seWZpZWxkKSlcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChmb3JtIGluc3RhbmNlb2YgRm9ybUFycmF5KSB7XG4gICAgICBjb25zdCBlcnIgPSBbXTtcbiAgICAgICg8Rm9ybUFycmF5PmZvcm0uY29udHJvbHNbbmFtZV0pLmNvbnRyb2xzLmZvckVhY2goY29udHJvbCA9PlxuICAgICAgICBlcnIucHVzaCgoVmFsaWRhdGVVdGlscy5nZXRGb3JtRXJyb3JzKGNvbnRyb2wsIG1lc3NhZ2VzLCBmb3JtbHlmaWVsZCkpKVxuICAgICAgKTtcbiAgICAgIHJldHVybiBlcnI7XG4gICAgfVxuICAgIHJldHVybiBlcnJvcnM7XG4gIH1cblxuICBzdGF0aWMgZ2V0Q29udHJvbEVycm9ycyhjb250cm9sOiBGb3JtQ29udHJvbCwgbWVzc2FnZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBmb3JtbHlmaWVsZD86IGFueSkge1xuICAgIHJldHVybiBWYWxpZGF0ZVV0aWxzLmdldEVycm9yTWVzc2FnZShjb250cm9sLmVycm9ycywgbWVzc2FnZXMsIGZvcm1seWZpZWxkKTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRFcnJvck1lc3NhZ2UoZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JzLCBtZXNzYWdlcz86IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sIGZvcm1seWZpZWxkPzogYW55KSB7XG4gICAgaWYgKCFlcnJvcnMpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlcyA9IHt9O1xuICAgIE9iamVjdC5rZXlzKGVycm9ycykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgbGV0IG1lc3NhZ2U7XG4gICAgICBpZiAoZm9ybWx5ZmllbGQpIHtcbiAgICAgICAgaWYgKGZvcm1seWZpZWxkLnZhbGlkYXRvcnMgJiYgZm9ybWx5ZmllbGQudmFsaWRhdG9yc1trZXldICYmIGZvcm1seWZpZWxkLnZhbGlkYXRvcnNba2V5XS5tZXNzYWdlKSB7XG4gICAgICAgICAgbWVzc2FnZSA9IGZvcm1seWZpZWxkLnZhbGlkYXRvcnNba2V5XS5tZXNzYWdlO1xuICAgICAgICB9IGVsc2UgaWYgKGZvcm1seWZpZWxkLmFzeW5jVmFsaWRhdG9ycyAmJiBmb3JtbHlmaWVsZC5hc3luY1ZhbGlkYXRvcnNba2V5XSAmJiBmb3JtbHlmaWVsZC5hc3luY1ZhbGlkYXRvcnNba2V5XS5tZXNzYWdlKSB7XG4gICAgICAgICAgbWVzc2FnZSA9IGZvcm1seWZpZWxkLmFzeW5jVmFsaWRhdG9yc1trZXldLm1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgICBpZiAobWVzc2FnZXMgJiYgbWVzc2FnZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlc1trZXldO1xuICAgICAgICB9IGVsc2UgaWYgKE5nVmFsaWRhdGVNZXNzYWdlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgbWVzc2FnZSA9IE5nVmFsaWRhdGVNZXNzYWdlc1trZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1lc3NhZ2UgPSBrZXk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlc1trZXldID0gbWVzc2FnZTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlc1trZXldID0gbWVzc2FnZS5hcHBseSh0aGlzLCBbZXJyb3JzW2tleV0sIGZvcm1seWZpZWxkXSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGVycm9yTWVzc2FnZXM7XG4gIH1cblxuICBzdGF0aWMgZHluYVZhbGlkYXRpb25NZXNzYWdlRm4oXG4gICAgZXJyb3IsXG4gICAgY29udGV4dD86IHsgZXJyb3JLZXk/OiBzdHJpbmcsIGZvcm1hdD86IHN0cmluZywgZXJyb3JQcm9wcz86IHN0cmluZyB8IHN0cmluZ1tdLCBmb3JtbHlGaWVsZD86IGFueSB9XG4gICkge1xuICAgIGxldCB2YWx1ZXMgPSBbXTtcbiAgICBpZiAoQ29tbW9uc1V0aWxzLmlzSnNvbihlcnJvcikgJiYgY29udGV4dC5lcnJvclByb3BzKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShjb250ZXh0LmVycm9yUHJvcHMpKSB7XG4gICAgICAgIGNvbnRleHQuZXJyb3JQcm9wcy5mb3JFYWNoKGtleSA9PiB2YWx1ZXMucHVzaChlcnJvcltrZXldKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YWx1ZXMucHVzaChlcnJvcltjb250ZXh0LmVycm9yUHJvcHNdKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZHluYTogYW55W10gPSBDb21tb25zVXRpbHMuZ2V0KGNvbnRleHQsICd2YWxpZGF0aW9uLmR5bmEnLCBbXSk7XG4gICAgICBjb25zdCBpbmZvID0gQ29tbW9uc1V0aWxzLmZpbmQoZHluYSwge2tleTogY29udGV4dC5lcnJvcktleX0pO1xuICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgdmFsdWVzID0gaW5mb1snYXJncyddIHx8IFtdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gQ29tbW9uc1V0aWxzLnRlbXBsYXRlU3RyKGNvbnRleHQuZm9ybWF0LCB2YWx1ZXMpO1xuICB9XG59XG4iXX0=