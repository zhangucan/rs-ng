/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { FormArray, FormControl, FormGroup } from '@angular/forms';
import { CommonsUtils } from '@er/utils';
import { NgValidateMessages } from '../validators/all';
var ValidateUtils = /** @class */ (function () {
    function ValidateUtils() {
    }
    /**
     * @param {?} form
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    ValidateUtils.getFormErrors = /**
     * @param {?} form
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    function (form, messages, formlyfield) {
        /** @type {?} */
        var errors = {};
        if (form instanceof FormControl) {
            return (ValidateUtils.getControlErrors((/** @type {?} */ (form)), messages, formlyfield));
        }
        else if (form instanceof FormGroup) {
            Object.keys(form.controls).map(function (name) {
                return errors[name] = (ValidateUtils.getFormErrors((/** @type {?} */ (form.controls[name])), messages, formlyfield));
            });
        }
        else if (form instanceof FormArray) {
            /** @type {?} */
            var err_1 = [];
            ((/** @type {?} */ (form.controls[name]))).controls.forEach(function (control) {
                return err_1.push((ValidateUtils.getFormErrors(control, messages, formlyfield)));
            });
            return err_1;
        }
        return errors;
    };
    /**
     * @param {?} control
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    ValidateUtils.getControlErrors = /**
     * @param {?} control
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    function (control, messages, formlyfield) {
        return ValidateUtils.getErrorMessage(control.errors, messages, formlyfield);
    };
    /**
     * @param {?} errors
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    ValidateUtils.getErrorMessage = /**
     * @param {?} errors
     * @param {?=} messages
     * @param {?=} formlyfield
     * @return {?}
     */
    function (errors, messages, formlyfield) {
        var _this = this;
        if (!errors) {
            return {};
        }
        /** @type {?} */
        var errorMessages = {};
        Object.keys(errors).forEach(function (key) {
            /** @type {?} */
            var message;
            if (formlyfield) {
                if (formlyfield.validators && formlyfield.validators[key] && formlyfield.validators[key].message) {
                    message = formlyfield.validators[key].message;
                }
                else if (formlyfield.asyncValidators && formlyfield.asyncValidators[key] && formlyfield.asyncValidators[key].message) {
                    message = formlyfield.asyncValidators[key].message;
                }
            }
            if (!message) {
                if (messages && messages.hasOwnProperty(key)) {
                    message = messages[key];
                }
                else if (NgValidateMessages.hasOwnProperty(key)) {
                    message = NgValidateMessages[key];
                }
                else {
                    message = key;
                }
            }
            if (typeof message === 'string') {
                errorMessages[key] = message;
            }
            else if (typeof message === 'function') {
                errorMessages[key] = message.apply(_this, [errors[key], formlyfield]);
            }
        });
        return errorMessages;
    };
    /**
     * @param {?} error
     * @param {?=} context
     * @return {?}
     */
    ValidateUtils.dynaValidationMessageFn = /**
     * @param {?} error
     * @param {?=} context
     * @return {?}
     */
    function (error, context) {
        /** @type {?} */
        var values = [];
        if (CommonsUtils.isJson(error) && context.errorProps) {
            if (Array.isArray(context.errorProps)) {
                context.errorProps.forEach(function (key) { return values.push(error[key]); });
            }
            else {
                values.push(error[context.errorProps]);
            }
        }
        else {
            /** @type {?} */
            var dyna = CommonsUtils.get(context, 'validation.dyna', []);
            /** @type {?} */
            var info = CommonsUtils.find(dyna, { key: context.errorKey });
            if (info) {
                values = info['args'] || [];
            }
        }
        return CommonsUtils.templateStr(context.format, values);
    };
    return ValidateUtils;
}());
export { ValidateUtils };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvdmFsaWRhdGUvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBa0IsU0FBUyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQW1CLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEcsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUN2QyxPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUdyRDtJQUFBO0lBNEVBLENBQUM7Ozs7Ozs7SUExRVEsMkJBQWE7Ozs7OztJQUFwQixVQUFxQixJQUFxQixFQUFFLFFBQW9DLEVBQUUsV0FBaUI7O1lBQzNGLE1BQU0sR0FBRyxFQUFFO1FBQ2pCLElBQUksSUFBSSxZQUFZLFdBQVcsRUFBRTtZQUMvQixPQUFPLENBQUMsYUFBYSxDQUFDLGdCQUFnQixDQUFDLG1CQUFhLElBQUksRUFBQSxFQUFFLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDO1NBQ25GO2FBQU0sSUFBSSxJQUFJLFlBQVksU0FBUyxFQUFFO1lBQ3BDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFBLElBQUk7Z0JBQ2pDLE9BQUEsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxtQkFBVyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFBLEVBQUUsUUFBUSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1lBQW5HLENBQW1HLENBQ3BHLENBQUM7U0FDSDthQUFNLElBQUksSUFBSSxZQUFZLFNBQVMsRUFBRTs7Z0JBQzlCLEtBQUcsR0FBRyxFQUFFO1lBQ2QsQ0FBQyxtQkFBVyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFBLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxD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QUF2QixDQUF1QixDQUFDLENBQUM7YUFDNUQ7aUJBQU07Z0JBQ0wsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7YUFDeEM7U0FDRjthQUFNOztnQkFDQyxJQUFJLEdBQVUsWUFBWSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsRUFBRSxDQUFDOztnQkFDOUQsSUFBSSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUMsQ0FBQztZQUM3RCxJQUFJLElBQUksRUFBRTtnQkFDUixNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQzthQUM3QjtTQUNGO1FBQ0QsT0FBTyxZQUFZLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDMUQsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQTVFRCxJQTRFQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QWJzdHJhY3RDb250cm9sLCBGb3JtQXJyYXksIEZvcm1Db250cm9sLCBGb3JtR3JvdXAsIFZhbGlkYXRpb25FcnJvcnN9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7Q29tbW9uc1V0aWxzfSBmcm9tICdAZXIvdXRpbHMnO1xuaW1wb3J0IHtOZ1ZhbGlkYXRlTWVzc2FnZXN9IGZyb20gJy4uL3ZhbGlkYXRvcnMvYWxsJztcblxuXG5leHBvcnQgY2xhc3MgVmFsaWRhdGVVdGlscyB7XG5cbiAgc3RhdGljIGdldEZvcm1FcnJvcnMoZm9ybTogQWJzdHJhY3RDb250cm9sLCBtZXNzYWdlcz86IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0sIGZvcm1seWZpZWxkPzogYW55KSB7XG4gICAgY29uc3QgZXJyb3JzID0ge307XG4gICAgaWYgKGZvcm0gaW5zdGFuY2VvZiBGb3JtQ29udHJvbCkge1xuICAgICAgcmV0dXJuIChWYWxpZGF0ZVV0aWxzLmdldENvbnRyb2xFcnJvcnMoPEZvcm1Db250cm9sPmZvcm0sIG1lc3NhZ2VzLCBmb3JtbHlmaWVsZCkpO1xuICAgIH0gZWxzZSBpZiAoZm9ybSBpbnN0YW5jZW9mIEZvcm1Hcm91cCkge1xuICAgICAgT2JqZWN0LmtleXMoZm9ybS5jb250cm9scykubWFwKG5hbWUgPT5cbiAgICAgICAgZXJyb3JzW25hbWVdID0gKFZhbGlkYXRlVXRpbHMuZ2V0Rm9ybUVycm9ycyg8Rm9ybUdyb3VwPmZvcm0uY29udHJvbHNbbmFtZV0sIG1lc3NhZ2VzLCBmb3JtbHlmaWVsZCkpXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAoZm9ybSBpbnN0YW5jZW9mIEZvcm1BcnJheSkge1xuICAgICAgY29uc3QgZXJyID0gW107XG4gICAgICAoPEZvcm1BcnJheT5mb3JtLmNvbnRyb2xzW25hbWVdKS5jb250cm9scy5mb3JFYWNoKGNvbnRyb2wgPT5cbiAgICAgICAgZXJyLnB1c2goKFZhbGlkYXRlVXRpbHMuZ2V0Rm9ybUVycm9ycyhjb250cm9sLCBtZXNzYWdlcywgZm9ybWx5ZmllbGQpKSlcbiAgICAgICk7XG4gICAgICByZXR1cm4gZXJyO1xuICAgIH1cbiAgICByZXR1cm4gZXJyb3JzO1xuICB9XG5cbiAgc3RhdGljIGdldENvbnRyb2xFcnJvcnMoY29udHJvbDogRm9ybUNvbnRyb2wsIG1lc3NhZ2VzPzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSwgZm9ybWx5ZmllbGQ/OiBhbnkpIHtcbiAgICByZXR1cm4gVmFsaWRhdGVVdGlscy5nZXRFcnJvck1lc3NhZ2UoY29udHJvbC5lcnJvcnMsIG1lc3NhZ2VzLCBmb3JtbHlmaWVsZCk7XG4gIH1cblxuICBzdGF0aWMgZ2V0RXJyb3JNZXNzYWdlKGVycm9yczogVmFsaWRhdGlvbkVycm9ycywgbWVzc2FnZXM/OiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9LCBmb3JtbHlmaWVsZD86IGFueSkge1xuICAgIGlmICghZXJyb3JzKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPSB7fTtcbiAgICBPYmplY3Qua2V5cyhlcnJvcnMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIGxldCBtZXNzYWdlO1xuICAgICAgaWYgKGZvcm1seWZpZWxkKSB7XG4gICAgICAgIGlmIChmb3JtbHlmaWVsZC52YWxpZGF0b3JzICYmIGZvcm1seWZpZWxkLnZhbGlkYXRvcnNba2V5XSAmJiBmb3JtbHlmaWVsZC52YWxpZGF0b3JzW2tleV0ubWVzc2FnZSkge1xuICAgICAgICAgIG1lc3NhZ2UgPSBmb3JtbHlmaWVsZC52YWxpZGF0b3JzW2tleV0ubWVzc2FnZTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3JtbHlmaWVsZC5hc3luY1ZhbGlkYXRvcnMgJiYgZm9ybWx5ZmllbGQuYXN5bmNWYWxpZGF0b3JzW2tleV0gJiYgZm9ybWx5ZmllbGQuYXN5bmNWYWxpZGF0b3JzW2tleV0ubWVzc2FnZSkge1xuICAgICAgICAgIG1lc3NhZ2UgPSBmb3JtbHlmaWVsZC5hc3luY1ZhbGlkYXRvcnNba2V5XS5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKG1lc3NhZ2VzICYmIG1lc3NhZ2VzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZXNba2V5XTtcbiAgICAgICAgfSBlbHNlIGlmIChOZ1ZhbGlkYXRlTWVzc2FnZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIG1lc3NhZ2UgPSBOZ1ZhbGlkYXRlTWVzc2FnZXNba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZXNzYWdlID0ga2V5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZXNba2V5XSA9IG1lc3NhZ2U7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZXNba2V5XSA9IG1lc3NhZ2UuYXBwbHkodGhpcywgW2Vycm9yc1trZXldLCBmb3JtbHlmaWVsZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBlcnJvck1lc3NhZ2VzO1xuICB9XG5cbiAgc3RhdGljIGR5bmFWYWxpZGF0aW9uTWVzc2FnZUZuKFxuICAgIGVycm9yLFxuICAgIGNvbnRleHQ/OiB7IGVycm9yS2V5Pzogc3RyaW5nLCBmb3JtYXQ/OiBzdHJpbmcsIGVycm9yUHJvcHM/OiBzdHJpbmcgfCBzdHJpbmdbXSwgZm9ybWx5RmllbGQ/OiBhbnkgfVxuICApIHtcbiAgICBsZXQgdmFsdWVzID0gW107XG4gICAgaWYgKENvbW1vbnNVdGlscy5pc0pzb24oZXJyb3IpICYmIGNvbnRleHQuZXJyb3JQcm9wcykge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29udGV4dC5lcnJvclByb3BzKSkge1xuICAgICAgICBjb250ZXh0LmVycm9yUHJvcHMuZm9yRWFjaChrZXkgPT4gdmFsdWVzLnB1c2goZXJyb3Jba2V5XSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWVzLnB1c2goZXJyb3JbY29udGV4dC5lcnJvclByb3BzXSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGR5bmE6IGFueVtdID0gQ29tbW9uc1V0aWxzLmdldChjb250ZXh0LCAndmFsaWRhdGlvbi5keW5hJywgW10pO1xuICAgICAgY29uc3QgaW5mbyA9IENvbW1vbnNVdGlscy5maW5kKGR5bmEsIHtrZXk6IGNvbnRleHQuZXJyb3JLZXl9KTtcbiAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgIHZhbHVlcyA9IGluZm9bJ2FyZ3MnXSB8fCBbXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIENvbW1vbnNVdGlscy50ZW1wbGF0ZVN0cihjb250ZXh0LmZvcm1hdCwgdmFsdWVzKTtcbiAgfVxufVxuIl19