/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ApiServerType, HttpMethod, HttpRequestPayloadType, Order } from '@er/types';
/**
 * @record
 */
export function ErHttpResponse() { }
if (false) {
    /** @type {?|undefined} */
    ErHttpResponse.prototype.success;
    /** @type {?|undefined} */
    ErHttpResponse.prototype.message;
    /** @type {?|undefined} */
    ErHttpResponse.prototype.error;
    /** @type {?|undefined} */
    ErHttpResponse.prototype.content;
    /** @type {?|undefined} */
    ErHttpResponse.prototype.contents;
}
/** @type {?} */
const paramKeys = {
    sort: '_sort',
    order: '_order',
    from: 'from',
    size: 'size',
    page: '_page',
    to: '_end'
};
/** @type {?} */
const responseResolver = response => response;
const ɵ0 = responseResolver;
/** @type {?} */
const updateResponseResolver = response => response && response.hasOwnProperty('id')
    ? { success: true, result: response.id }
    : { failure: true, message: response };
const ɵ1 = updateResponseResolver;
/** @type {?} */
const deleteResponseResolver = response => response && Object.keys(response).length === 0
    ? { success: true, result: {} }
    : { failure: true, message: response };
const ɵ2 = deleteResponseResolver;
/** @type {?} */
export const ErServerApiRequestOptions = {
    serverType: ApiServerType.ER,
    paramsKeys: paramKeys,
    actions: {
        login: {
            uriResolver: () => 'login',
            method: HttpMethod.POST,
            notifySuccess: true,
            successMessage: '登录成功',
            notifyFailure: true,
            onResponse: responseResolver,
            onSuccess: ((resp) => {
                /** @type {?} */
                const content = resp.content;
                return content || {};
            })
        },
        logout: {
            uriResolver: () => 'logout',
            notifySuccess: false,
            onResponse: responseResolver
        },
        changePwd: {
            uriResolver: () => 'user/updatePwd',
            notifySuccess: false,
            onResponse: responseResolver
        },
        register: {
            uriResolver: () => 'user/reg',
            method: HttpMethod.POST,
            notifySuccess: true,
            successMessage: '注册成功'
        },
        getById: {
            uriResolver: (apiEntry, payload) => `${apiEntry}/${payload}`,
            onResponse: (response) => {
                return Object.assign({ id: response['_id'] }, response['_source']);
            }
        },
        getByIds: {
            method: HttpMethod.GET,
            payloadType: HttpRequestPayloadType.PARAMS,
            payloadResolver: (apiEntry, payload, options) => {
                /** @type {?} */
                const _ids = payload;
                if (_ids.length === 0) {
                    throw new Error('id值为空');
                }
                /** @type {?} */
                const keys = options.paramsKeys;
                return {
                    [keys.ids]: _ids,
                    [keys.fields]: payload.fields
                };
            }
        },
        getByQuery: {
            method: HttpMethod.GET,
            payloadType: HttpRequestPayloadType.PARAMS,
            payloadResolver: (apiEntry, payload, options) => {
                /** @type {?} */
                let qParams = '';
                /** @type {?} */
                const requestPayload = payload || {};
                /** @type {?} */
                const query = requestPayload.query;
                if (query) {
                    if (query instanceof Array) {
                        // (query as Query[]).forEach(q => qParams += `${q.field}=${q.value}&`);
                    }
                    else {
                        /** @type {?} */
                        const q = (/** @type {?} */ (query));
                        // qParams = `${q.field}=${q.value}`;
                    }
                }
                const { size, page } = requestPayload;
                if (size || page) {
                    if (!qParams.endsWith('&')) {
                        qParams += '&';
                    }
                    qParams += `${options.paramsKeys.size}=${size || 10}&${options.paramsKeys.page}=${page || 1}`;
                }
                /** @type {?} */
                const sort = requestPayload.sort;
                if (sort) {
                    if (!qParams.endsWith('&')) {
                        qParams += '&';
                    }
                    /** @type {?} */
                    let sortFields = '';
                    /** @type {?} */
                    let sortOrders = '';
                    if (typeof sort === 'string') {
                        qParams += `${options.paramsKeys.sort}=${sort}&${options.paramsKeys.order}=${Order.ASC}`;
                    }
                    else {
                        Object.keys(sort).map(field => {
                            sortFields += `${field},`;
                            sortOrders += `${sort[field]},`;
                        });
                        qParams += `${options.paramsKeys.sort}=${sortFields}&${options.paramsKeys.order}=${sortOrders}`;
                    }
                }
                return qParams;
            },
            onResponse: response => response
        },
        create: {
            method: HttpMethod.POST,
            onResponse: updateResponseResolver,
            notifySuccess: false,
            alertSuccess: true,
            successMessage: '数据保存成功'
        },
        updateById: {
            method: HttpMethod.PUT,
            payloadType: HttpRequestPayloadType.BODY,
            uriResolver: (apiEntry, payload) => `${apiEntry}/${payload.id}`,
            payloadResolver: (apiEntry, payload) => payload.data,
            onResponse: updateResponseResolver,
            notifySuccess: false,
            alertSuccess: true,
            successMessage: '数据更新成功'
        },
        patchById: {
            method: HttpMethod.PATCH,
            payloadType: HttpRequestPayloadType.BODY,
            uriResolver: (apiEntry, payload) => `${apiEntry}/${payload.id}`,
            payloadResolver: (apiEntry, payload) => payload,
            onResponse: updateResponseResolver,
            notifySuccess: true,
            successMessage: '数据更新成功'
        },
        deleteById: {
            method: HttpMethod.DELETE,
            uriResolver: (apiEntry, payload) => `${apiEntry}/${payload}`,
            onResponse: deleteResponseResolver,
            notifySuccess: true,
            successMessage: '数据删除成功'
        }
    }
};
export { ɵ0, ɵ1, ɵ2 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvcHJlc2V0cy8iLCJzb3VyY2VzIjpbImxpYi9hcGktc2VydmVycy9lci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUErQyxhQUFhLEVBQUUsVUFBVSxFQUFFLHNCQUFzQixFQUFFLEtBQUssRUFBUSxNQUFNLFdBQVcsQ0FBQzs7OztBQUV4SSxvQ0FNQzs7O0lBTEMsaUNBQWtCOztJQUNsQixpQ0FBaUI7O0lBQ2pCLCtCQUFlOztJQUNmLGlDQUFjOztJQUNkLGtDQUFpQjs7O01BR2IsU0FBUyxHQUFrQjtJQUMvQixJQUFJLEVBQUUsT0FBTztJQUNiLEtBQUssRUFBRSxRQUFRO0lBQ2YsSUFBSSxFQUFFLE1BQU07SUFDWixJQUFJLEVBQUUsTUFBTTtJQUNaLElBQUksRUFBRSxPQUFPO0lBQ2IsRUFBRSxFQUFFLE1BQU07Q0FDWDs7TUFFSyxnQkFBZ0IsR0FBRyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVE7OztNQUV2QyxzQkFBc0IsR0FBRyxRQUFRLENBQUMsRUFBRSxDQUN4QyxRQUFRLElBQUksUUFBUSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUM7SUFDdkMsQ0FBQyxDQUFDLEVBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsUUFBUSxDQUFDLEVBQUUsRUFBQztJQUN0QyxDQUFDLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUM7OztNQUVsQyxzQkFBc0IsR0FBRyxRQUFRLENBQUMsRUFBRSxDQUN4QyxRQUFRLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQztJQUM1QyxDQUFDLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUM7SUFDN0IsQ0FBQyxDQUFDLEVBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFD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QVEsSUFBSSxPQUFPLEVBQUU7WUFDaEYsVUFBVSxFQUFFLHNCQUFzQjtZQUNsQyxhQUFhLEVBQUUsSUFBSTtZQUNuQixjQUFjLEVBQUUsUUFBUTtTQUN6QjtLQUVGO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0FwaVBhcmFtc0tleXMsIEFwaVBheWxvYWQsIEFwaVJlcXVlc3RPcHRpb25zLCBBcGlTZXJ2ZXJUeXBlLCBIdHRwTWV0aG9kLCBIdHRwUmVxdWVzdFBheWxvYWRUeXBlLCBPcmRlciwgUXVlcnl9IGZyb20gJ0Blci90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXJIdHRwUmVzcG9uc2Uge1xuICBzdWNjZXNzPzogYm9vbGVhbjtcbiAgbWVzc2FnZT86IHN0cmluZztcbiAgZXJyb3I/OiBzdHJpbmc7XG4gIGNvbnRlbnQ/OiBhbnk7XG4gIGNvbnRlbnRzPzogYW55W107XG59XG5cbmNvbnN0IHBhcmFtS2V5czogQXBpUGFyYW1zS2V5cyA9IHtcbiAgc29ydDogJ19zb3J0JyxcbiAgb3JkZXI6ICdfb3JkZXInLFxuICBmcm9tOiAnZnJvbScsXG4gIHNpemU6ICdzaXplJyxcbiAgcGFnZTogJ19wYWdlJyxcbiAgdG86ICdfZW5kJ1xufTtcblxuY29uc3QgcmVzcG9uc2VSZXNvbHZlciA9IHJlc3BvbnNlID0+IHJlc3BvbnNlO1xuXG5jb25zdCB1cGRhdGVSZXNwb25zZVJlc29sdmVyID0gcmVzcG9uc2UgPT5cbiAgcmVzcG9uc2UgJiYgcmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ2lkJylcbiAgICA/IHtzdWNjZXNzOiB0cnVlLCByZXN1bHQ6IHJlc3BvbnNlLmlkfVxuICAgIDoge2ZhaWx1cmU6IHRydWUsIG1lc3NhZ2U6IHJlc3BvbnNlfTtcblxuY29uc3QgZGVsZXRlUmVzcG9uc2VSZXNvbHZlciA9IHJlc3BvbnNlID0+XG4gIHJlc3BvbnNlICYmIE9iamVjdC5rZXlzKHJlc3BvbnNlKS5sZW5ndGggPT09IDBcbiAgICA/IHtzdWNjZXNzOiB0cnVlLCByZXN1bHQ6IHt9fVxuICAgIDoge2ZhaWx1cmU6IHRydWUsIG1lc3NhZ2U6IHJlc3BvbnNlfTtcblxuZXhwb3J0IGNvbnN0IEVyU2VydmVyQXBpUmVxdWVzdE9wdGlvbnM6IEFwaVJlcXVlc3RPcHRpb25zID0ge1xuICBzZXJ2ZXJUeXBlOiBBcGlTZXJ2ZXJUeXBlLkVSLFxuICBwYXJhbXNLZXlzOiBwYXJhbUtleXMsXG4gIGFjdGlvbnM6IHtcblxuICAgIGxvZ2luOiB7XG4gICAgICB1cmlSZXNvbHZlcjogKCkgPT4gJ2xvZ2luJyxcbiAgICAgIG1ldGhvZDogSHR0cE1ldGhvZC5QT1NULFxuICAgICAgbm90aWZ5U3VjY2VzczogdHJ1ZSxcbiAgICAgIHN1Y2Nlc3NNZXNzYWdlOiAn55m75b2V5oiQ5YqfJyxcbiAgICAgIG5vdGlmeUZhaWx1cmU6IHRydWUsXG4gICAgICBvblJlc3BvbnNlOiByZXNwb25zZVJlc29sdmVyLFxuICAgICAgb25TdWNjZXNzOiAoKHJlc3ApID0+IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHJlc3AuY29udGVudDtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQgfHwge307XG4gICAgICB9KVxuICAgIH0sXG5cbiAgICBsb2dvdXQ6IHtcbiAgICAgIHVyaVJlc29sdmVyOiAoKSA9PiAnbG9nb3V0JyxcbiAgICAgIG5vdGlmeVN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgb25SZXNwb25zZTogcmVzcG9uc2VSZXNvbHZlclxuICAgIH0sXG5cbiAgICBjaGFuZ2VQd2Q6IHtcbiAgICAgIHVyaVJlc29sdmVyOiAoKSA9PiAndXNlci91cGRhdGVQd2QnLFxuICAgICAgbm90aWZ5U3VjY2VzczogZmFsc2UsXG4gICAgICBvblJlc3BvbnNlOiByZXNwb25zZVJlc29sdmVyXG4gICAgfSxcblxuICAgIHJlZ2lzdGVyOiB7XG4gICAgICB1cmlSZXNvbHZlcjogKCkgPT4gJ3VzZXIvcmVnJyxcbiAgICAgIG1ldGhvZDogSHR0cE1ldGhvZC5QT1NULFxuICAgICAgbm90aWZ5U3VjY2VzczogdHJ1ZSxcbiAgICAgIHN1Y2Nlc3NNZXNzYWdlOiAn5rOo5YaM5oiQ5YqfJ1xuICAgIH0sXG5cbiAgICBnZXRCeUlkOiB7XG4gICAgICB1cmlSZXNvbHZlcjogKGFwaUVudHJ5OiBzdHJpbmcsIHBheWxvYWQpID0+IGAke2FwaUVudHJ5fS8ke3BheWxvYWR9YCxcbiAgICAgIG9uUmVzcG9uc2U6IChyZXNwb25zZSkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiByZXNwb25zZVsnX2lkJ10sXG4gICAgICAgICAgLi4ucmVzcG9uc2VbJ19zb3VyY2UnXVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRCeUlkczoge1xuICAgICAgbWV0aG9kOiBIdHRwTWV0aG9kLkdFVCxcbiAgICAgIHBheWxvYWRUeXBlOiBIdHRwUmVxdWVzdFBheWxvYWRUeXBlLlBBUkFNUyxcbiAgICAgIHBheWxvYWRSZXNvbHZlcjogKGFwaUVudHJ5OiBzdHJpbmcsIHBheWxvYWQ6IEFwaVBheWxvYWQsIG9wdGlvbnM6IEFwaVJlcXVlc3RPcHRpb25zKSA9PiB7XG4gICAgICAgIGNvbnN0IF9pZHMgPSBwYXlsb2FkOyAvLyB0b2RvOiB0b1N0cmluZ1xuICAgICAgICBpZiAoX2lkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2lk5YC85Li656m6Jyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5cyA9IG9wdGlvbnMucGFyYW1zS2V5cztcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBba2V5cy5pZHNdOiBfaWRzLFxuICAgICAgICAgIFtrZXlzLmZpZWxkc106IHBheWxvYWQuZmllbGRzXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSxcblxuICAgIGdldEJ5UXVlcnk6IHtcbiAgICAgIG1ldGhvZDogSHR0cE1ldGhvZC5HRVQsXG4gICAgICBwYXlsb2FkVHlwZTogSHR0cFJlcXVlc3RQYXlsb2FkVHlwZS5QQVJBTVMsXG4gICAgICBwYXlsb2FkUmVzb2x2ZXI6IChhcGlFbnRyeTogc3RyaW5nLCBwYXlsb2FkOiBBcGlQYXlsb2FkLCBvcHRpb25zOiBBcGlSZXF1ZXN0T3B0aW9ucykgPT4ge1xuICAgICAgICBsZXQgcVBhcmFtcyA9ICcnO1xuICAgICAgICBjb25zdCByZXF1ZXN0UGF5bG9hZCA9IHBheWxvYWQgfHwge307XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gcmVxdWVzdFBheWxvYWQucXVlcnk7XG4gICAgICAgIGlmIChxdWVyeSkge1xuICAgICAgICAgIGlmIChxdWVyeSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAvLyAocXVlcnkgYXMgUXVlcnlbXSkuZm9yRWFjaChxID0+IHFQYXJhbXMgKz0gYCR7cS5maWVsZH09JHtxLnZhbHVlfSZgKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcSA9IDxRdWVyeT5xdWVyeTtcbiAgICAgICAgICAgIC8vIHFQYXJhbXMgPSBgJHtxLmZpZWxkfT0ke3EudmFsdWV9YDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qge3NpemUsIHBhZ2V9ID0gcmVxdWVzdFBheWxvYWQ7XG4gICAgICAgIGlmIChzaXplIHx8IHBhZ2UpIHtcbiAgICAgICAgICBpZiAoIXFQYXJhbXMuZW5kc1dpdGgoJyYnKSkge1xuICAgICAgICAgICAgcVBhcmFtcyArPSAnJic7XG4gICAgICAgICAgfVxuICAgICAgICAgIHFQYXJhbXMgKz0gYCR7b3B0aW9ucy5wYXJhbXNLZXlzLnNpemV9PSR7c2l6ZSB8fCAxMH0mJHtvcHRpb25zLnBhcmFtc0tleXMucGFnZX09JHtwYWdlIHx8IDF9YDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzb3J0ID0gcmVxdWVzdFBheWxvYWQuc29ydDtcbiAgICAgICAgaWYgKHNvcnQpIHtcbiAgICAgICAgICBpZiAoIXFQYXJhbXMuZW5kc1dpdGgoJyYnKSkge1xuICAgICAgICAgICAgcVBhcmFtcyArPSAnJic7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxldCBzb3J0RmllbGRzID0gJyc7XG4gICAgICAgICAgbGV0IHNvcnRPcmRlcnMgPSAnJztcbiAgICAgICAgICBpZiAodHlwZW9mIHNvcnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBxUGFyYW1zICs9IGAke29wdGlvbnMucGFyYW1zS2V5cy5zb3J0fT0ke3NvcnR9JiR7b3B0aW9ucy5wYXJhbXNLZXlzLm9yZGVyfT0ke09yZGVyLkFTQ31gO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhzb3J0KS5tYXAoZmllbGQgPT4ge1xuICAgICAgICAgICAgICBzb3J0RmllbGRzICs9IGAke2ZpZWxkfSxgO1xuICAgICAgICAgICAgICBzb3J0T3JkZXJzICs9IGAke3NvcnRbZmllbGRdfSxgO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBxUGFyYW1zICs9IGAke29wdGlvbnMucGFyYW1zS2V5cy5zb3J0fT0ke3NvcnRGaWVsZHN9JiR7b3B0aW9ucy5wYXJhbXNLZXlzLm9yZGVyfT0ke3NvcnRPcmRlcnN9YDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHFQYXJhbXM7XG4gICAgICB9LFxuICAgICAgb25SZXNwb25zZTogcmVzcG9uc2UgPT4gcmVzcG9uc2VcbiAgICB9LFxuXG4gICAgY3JlYXRlOiB7XG4gICAgICBtZXRob2Q6IEh0dHBNZXRob2QuUE9TVCxcbiAgICAgIG9uUmVzcG9uc2U6IHVwZGF0ZVJlc3BvbnNlUmVzb2x2ZXIsXG4gICAgICBub3RpZnlTdWNjZXNzOiBmYWxzZSxcbiAgICAgIGFsZXJ0U3VjY2VzczogdHJ1ZSxcbiAgICAgIHN1Y2Nlc3NNZXNzYWdlOiAn5pWw5o2u5L+d5a2Y5oiQ5YqfJ1xuICAgIH0sXG5cbiAgICB1cGRhdGVCeUlkOiB7XG4gICAgICBtZXRob2Q6IEh0dHBNZXRob2QuUFVULFxuICAgICAgcGF5bG9hZFR5cGU6IEh0dHBSZXF1ZXN0UGF5bG9hZFR5cGUuQk9EWSxcbiAgICAgIHVyaVJlc29sdmVyOiAoYXBpRW50cnk6IHN0cmluZywgcGF5bG9hZDogQXBpUGF5bG9hZCkgPT4gYCR7YXBpRW50cnl9LyR7cGF5bG9hZC5pZH1gLFxuICAgICAgcGF5bG9hZFJlc29sdmVyOiAoYXBpRW50cnk6IHN0cmluZywgcGF5bG9hZDogQXBpUGF5bG9hZCkgPT4gcGF5bG9hZC5kYXRhLFxuICAgICAgb25SZXNwb25zZTogdXBkYXRlUmVzcG9uc2VSZXNvbHZlcixcbiAgICAgIG5vdGlmeVN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgYWxlcnRTdWNjZXNzOiB0cnVlLFxuICAgICAgc3VjY2Vzc01lc3NhZ2U6ICfmlbDmja7mm7TmlrDmiJDlip8nXG4gICAgfSxcblxuICAgIHBhdGNoQnlJZDoge1xuICAgICAgbWV0aG9kOiBIdHRwTWV0aG9kLlBBVENILFxuICAgICAgcGF5bG9hZFR5cGU6IEh0dHBSZXF1ZXN0UGF5bG9hZFR5cGUuQk9EWSxcbiAgICAgIHVyaVJlc29sdmVyOiAoYXBpRW50cnk6IHN0cmluZywgcGF5bG9hZDogQXBpUGF5bG9hZCkgPT4gYCR7YXBpRW50cnl9LyR7cGF5bG9hZC5pZH1gLFxuICAgICAgcGF5bG9hZFJlc29sdmVyOiAoYXBpRW50cnk6IHN0cmluZywgcGF5bG9hZDogQXBpUGF5bG9hZCkgPT4gcGF5bG9hZCxcbiAgICAgIG9uUmVzcG9uc2U6IHVwZGF0ZVJlc3BvbnNlUmVzb2x2ZXIsXG4gICAgICBub3RpZnlTdWNjZXNzOiB0cnVlLFxuICAgICAgc3VjY2Vzc01lc3NhZ2U6ICfmlbDmja7mm7TmlrDmiJDlip8nXG4gICAgfSxcblxuICAgIGRlbGV0ZUJ5SWQ6IHtcbiAgICAgIG1ldGhvZDogSHR0cE1ldGhvZC5ERUxFVEUsXG4gICAgICB1cmlSZXNvbHZlcjogKGFwaUVudHJ5OiBzdHJpbmcsIHBheWxvYWQ6IEFwaVBheWxvYWQpID0+IGAke2FwaUVudHJ5fS8ke3BheWxvYWR9YCxcbiAgICAgIG9uUmVzcG9uc2U6IGRlbGV0ZVJlc3BvbnNlUmVzb2x2ZXIsXG4gICAgICBub3RpZnlTdWNjZXNzOiB0cnVlLFxuICAgICAgc3VjY2Vzc01lc3NhZ2U6ICfmlbDmja7liKDpmaTmiJDlip8nXG4gICAgfVxuXG4gIH1cbn07XG4iXX0=