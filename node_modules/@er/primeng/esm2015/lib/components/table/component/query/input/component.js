/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { BaseComponent } from '@er/core';
import { AggMethods, DataAttr, DataType } from '@er/types';
import { CommonsUtils, DataItemUtils } from '@er/utils';
import { BehaviorSubject } from 'rxjs';
import { PngTableComponent } from '../../table/component';
export class PngQueryInputComponent extends BaseComponent {
    /**
     * @param {?} pngTable
     */
    constructor(pngTable) {
        super();
        this.pngTable = pngTable;
        this.DATA_TYPE = DataType;
        this.DATA_ATTR = DataAttr;
        this.options = {};
        this.queryValueChange = new EventEmitter();
        this.isTime = false;
        this.autoCompleteProps$ = new BehaviorSubject(undefined);
    }
    /**
     * @return {?}
     */
    get queryValue() {
        return this._queryValue;
    }
    /**
     * @param {?} queryValue
     * @return {?}
     */
    set queryValue(queryValue) {
        this._queryValue = queryValue;
        this.queryValueChange.emit(queryValue);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        super.ngOnInit();
        this.autoProps = (/** @type {?} */ ({
            inputStyle: { 'min-width': '200px' },
            appendTo: 'body',
            forceSelection: false,
            $ext: {
                apiDataProps: Object.assign({}, this.pngTable.getTableQuery(), { searchFields: this.queryKey, returnFields: this.queryKey, aggProps: { name: this.queryKey, field: this.queryKey }, dataPath: `aggs.${this.queryKey}` }),
                dataItemProps: {
                    showCounter: true,
                    dropDownOptionKey: DataItemUtils.ITEM_LABEL_KEY,
                    valueKey: DataItemUtils.ITEM_LABEL_KEY
                }
            }
        }));
        this.sliderProps = (/** @type {?} */ ({
            range: true,
            $ext: {
                apiDataProps: Object.assign({}, this.pngTable.getTableQuery(), { aggProps: [
                        { name: 'max', field: this.queryKey, method: AggMethods.MAX },
                        { name: 'min', field: this.queryKey, method: AggMethods.MIN }
                    ] })
            }
        }));
        if (this.queryDataType === DataType.DATE && this.queryDataAttr) {
            /** @type {?} */
            const attrs = CommonsUtils.getArrayValue(this.queryDataAttr);
            if (attrs.indexOf(DataAttr.DATE) >= 0) {
                this.isTime = false;
            }
            if (attrs.indexOf(DataAttr.TIME) >= 0) {
                this.isTime = true;
            }
        }
    }
}
PngQueryInputComponent.decorators = [
    { type: Component, args: [{
                selector: 'png-query-input',
                template: `
    <ng-container [ngSwitch]="queryDataType">
      <ng-container *ngSwitchCase="DATA_TYPE.NUMBER">
        <png-slider [(ngModel)]="queryValue"
                    erPropsBind
                    [props]="sliderProps"
        >
        </png-slider>
      </ng-container>
      <ng-container *ngSwitchCase="DATA_TYPE.BOOLEAN">
        <p-inputSwitch [(ngModel)]="queryValue">
        </p-inputSwitch>
      </ng-container>
      <ng-container *ngSwitchCase="DATA_TYPE.DATE">
        <ng-container *ngIf="!isTime">
          <png-calendar erPropsBind [(ngModel)]="queryValue"
                        [props]="{ selectionMode: 'range',placeholder:'请选择日期'}">
          </png-calendar>
        </ng-container>
        <ng-container *ngIf="isTime">
          <png-calendar erPropsBind [(ngModel)]="queryValue"
                        [props]="{ timeOnly: true, selectionMode: 'range',placeholder:'请选择时间'}"
          >
          </png-calendar>
        </ng-container>
      </ng-container>
      <ng-container *ngSwitchDefault>
        <png-auto-complete
          [(ngModel)]="queryValue"
          erPropsBind
          [props]="autoProps"
        >
        </png-auto-complete>
        <!--<input type="text" pInputText [(ngModel)]="queryValue" placeholder="输入查询标准">-->
      </ng-container>
    </ng-container>
  `,
                styles: ["/deep/ .ui-multiselect{min-width:150px}/deep/ .ui-multiselect-label-container label{margin:0!important}/deep/ .ui-slider{width:100px;margin:5px}"]
            }] }
];
/** @nocollapse */
PngQueryInputComponent.ctorParameters = () => [
    { type: PngTableComponent }
];
PngQueryInputComponent.propDecorators = {
    queryKey: [{ type: Input }],
    queryDataType: [{ type: Input }],
    queryDataAttr: [{ type: Input }],
    options: [{ type: Input }],
    autoProps: [{ type: Input }],
    sliderProps: [{ type: Input }],
    queryValueChange: [{ type: Output }],
    queryValue: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    PngQueryInputComponent.prototype.DATA_TYPE;
    /** @type {?} */
    PngQueryInputComponent.prototype.DATA_ATTR;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryKey;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryDataType;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryDataAttr;
    /** @type {?} */
    PngQueryInputComponent.prototype.options;
    /** @type {?} */
    PngQueryInputComponent.prototype.autoProps;
    /** @type {?} */
    PngQueryInputComponent.prototype.sliderProps;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryValueChange;
    /** @type {?} */
    PngQueryInputComponent.prototype.isTime;
    /** @type {?} */
    PngQueryInputComponent.prototype.autoCompleteProps$;
    /**
     * @type {?}
     * @private
     */
    PngQueryInputComponent.prototype._queryValue;
    /**
     * @type {?}
     * @private
     */
    PngQueryInputComponent.prototype.pngTable;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVyL3ByaW1lbmcvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90YWJsZS9jb21wb25lbnQvcXVlcnkvaW5wdXQvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQXFCLE1BQU0sRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUN4RixPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3ZDLE9BQU8sRUFBQyxVQUFVLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUN6RCxPQUFPLEVBQUMsWUFBWSxFQUFFLGFBQWEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUN0RCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBR3JDLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBNkN4RCxNQUFNLE9BQU8sc0JBQXVCLFNBQVEsYUFBYTs7OztJQXlCdkQsWUFBb0IsUUFBMkI7UUFDN0MsS0FBSyxFQUFFLENBQUM7UUFEVSxhQUFRLEdBQVIsUUFBUSxDQUFtQjtRQXZCL0MsY0FBUyxHQUFHLFFBQVEsQ0FBQztRQUVyQixjQUFTLEdBQUcsUUFBUSxDQUFDO1FBUVosWUFBTyxHQUFHLEVBQUUsQ0FBQztRQU90QixxQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBRTlDLFdBQU0sR0FBRyxLQUFLLENBQUM7UUFFZix1QkFBa0IsR0FBMEMsSUFBSSxlQUFlLENBQXVCLFNBQVMsQ0FBQyxDQUFDO0lBSWpILENBQUM7Ozs7SUFJRCxJQUNJLFVBQVU7UUFDWixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDMUIsQ0FBQzs7Ozs7SUFFRCxJQUFJLFVBQVUsQ0FBQyxVQUFVO1FBQ3ZCLElBQUksQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDO1FBQzlCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDekMsQ0FBQzs7OztJQUVELFFBQVE7UUFDTixLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLFNBQVMsR0FBRyxtQkFBdUI7WUFDdEMsVUFBVSxFQUFFLEVBQUMsV0FBVyxFQUFFLE9BQU8sRUFBQztZQUNsQyxRQUFRLEVBQUUsTUFBTTtZQUNoQixjQUFjLEVBQUUsS0FBSztZQUNyQixJQUFJLEVBQUU7Z0JBQ0osWUFBWSxvQkFDUCxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxJQUNoQyxZQUFZLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFDM0IsWUFBWSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQzNCLFFBQVEsRUFBRSxFQUFDLElBQUksRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFDLEVBQ3JELFFBQVEsRUFBRSxRQUFRLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FDbEM7Z0JBQ0QsYUFBYSxFQUFFO29CQUNiLFdBQVcsRUFBRSxJQUFJO29CQUNqQixpQkFBaUIsRUFBRSxhQUFhLENBQUMsY0FBYztvQkFDL0MsUUFBUSxFQUFFLGFBQWEsQ0FBQyxjQUFjO2lCQUN2QzthQUNGO1NBQ0YsRUFBQSxDQUFDO1FBQ0YsSUFBSSxDQUFDLFdBQVcsR0FBRyxtQkFBaUI7WUFDbEMsS0FBSyxFQUFFLElBQUk7WUFDWCxJQUFJLEVBQUU7Z0JBQ0osWUFBWSxvQkFDUCxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSxJQUNoQyxRQUFRLEVBQUU7d0JBQ1IsRUFBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFDO3dCQUMzRCxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUM7cUJBQzVELEdBQ0Y7YUFDRjtTQUNGLEVBQUEsQ0FBQztRQUNGLElBQUksSUFBSSxDQUFDLGFBQWEsS0FBSyxRQUFRLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxhQUFhLEVBQUU7O2tCQUN4RCxLQUFLLEdBQUcsWUFBWSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDO1lBQzVELElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNyQyxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQzthQUNyQjtZQUNELElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNyQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQzthQUNwQjtTQUNGO0lBQ0gsQ0FBQzs7O1lBN0hGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsaUJBQWlCO2dCQUMzQixRQUFRLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQW9DVDs7YUFFRjs7OztZQTNDTyxpQkFBaUI7Ozt1QkFtRHRCLEtBQUs7NEJBRUwsS0FBSzs0QkFFTCxLQUFLO3NCQUVMLEtBQUs7d0JBRUwsS0FBSzswQkFFTCxLQUFLOytCQUVMLE1BQU07eUJBYU4sS0FBSzs7OztJQTdCTiwyQ0FBcUI7O0lBRXJCLDJDQUFxQjs7SUFFckIsMENBQTBCOztJQUUxQiwrQ0FBaUM7O0lBRWpDLCtDQUFpQzs7SUFFakMseUNBQXNCOztJQUV0QiwyQ0FBdUI7O0lBRXZCLDZDQUF5Qjs7SUFFekIsa0RBQzhDOztJQUU5Qyx3Q0FBZTs7SUFFZixvREFBaUg7Ozs7O0lBTWpILDZDQUFvQjs7Ozs7SUFKUiwwQ0FBbUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25DaGFuZ2VzLCBPbkluaXQsIE91dHB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0Jhc2VDb21wb25lbnR9IGZyb20gJ0Blci9jb3JlJztcbmltcG9ydCB7QWdnTWV0aG9kcywgRGF0YUF0dHIsIERhdGFUeXBlfSBmcm9tICdAZXIvdHlwZXMnO1xuaW1wb3J0IHtDb21tb25zVXRpbHMsIERhdGFJdGVtVXRpbHN9IGZyb20gJ0Blci91dGlscyc7XG5pbXBvcnQge0JlaGF2aW9yU3ViamVjdH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge1BuZ0F1dG9Db21wbGV0ZVByb3BzfSBmcm9tICcuLi8uLi8uLi8uLi9hdXRvLWNvbXBsZXRlL3R5cGUnO1xuaW1wb3J0IHtQbmdTbGlkZXJQcm9wc30gZnJvbSAnLi4vLi4vLi4vLi4vc2xpZGVyL2NvbXBvbmVudCc7XG5pbXBvcnQge1BuZ1RhYmxlQ29tcG9uZW50fSBmcm9tICcuLi8uLi90YWJsZS9jb21wb25lbnQnO1xuXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3BuZy1xdWVyeS1pbnB1dCcsXG4gIHRlbXBsYXRlOiBgXG4gICAgPG5nLWNvbnRhaW5lciBbbmdTd2l0Y2hdPVwicXVlcnlEYXRhVHlwZVwiPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiREFUQV9UWVBFLk5VTUJFUlwiPlxuICAgICAgICA8cG5nLXNsaWRlciBbKG5nTW9kZWwpXT1cInF1ZXJ5VmFsdWVcIlxuICAgICAgICAgICAgICAgICAgICBlclByb3BzQmluZFxuICAgICAgICAgICAgICAgICAgICBbcHJvcHNdPVwic2xpZGVyUHJvcHNcIlxuICAgICAgICA+XG4gICAgICAgIDwvcG5nLXNsaWRlcj5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiREFUQV9UWVBFLkJPT0xFQU5cIj5cbiAgICAgICAgPHAtaW5wdXRTd2l0Y2ggWyhuZ01vZGVsKV09XCJxdWVyeVZhbHVlXCI+XG4gICAgICAgIDwvcC1pbnB1dFN3aXRjaD5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiREFUQV9UWVBFLkRBVEVcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFpc1RpbWVcIj5cbiAgICAgICAgICA8cG5nLWNhbGVuZGFyIGVyUHJvcHNCaW5kIFsobmdNb2RlbCldPVwicXVlcnlWYWx1ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbcHJvcHNdPVwieyBzZWxlY3Rpb25Nb2RlOiAncmFuZ2UnLHBsYWNlaG9sZGVyOifor7fpgInmi6nml6XmnJ8nfVwiPlxuICAgICAgICAgIDwvcG5nLWNhbGVuZGFyPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImlzVGltZVwiPlxuICAgICAgICAgIDxwbmctY2FsZW5kYXIgZXJQcm9wc0JpbmQgWyhuZ01vZGVsKV09XCJxdWVyeVZhbHVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtwcm9wc109XCJ7IHRpbWVPbmx5OiB0cnVlLCBzZWxlY3Rpb25Nb2RlOiAncmFuZ2UnLHBsYWNlaG9sZGVyOifor7fpgInmi6nml7bpl7QnfVwiXG4gICAgICAgICAgPlxuICAgICAgICAgIDwvcG5nLWNhbGVuZGFyPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hEZWZhdWx0PlxuICAgICAgICA8cG5nLWF1dG8tY29tcGxldGVcbiAgICAgICAgICBbKG5nTW9kZWwpXT1cInF1ZXJ5VmFsdWVcIlxuICAgICAgICAgIGVyUHJvcHNCaW5kXG4gICAgICAgICAgW3Byb3BzXT1cImF1dG9Qcm9wc1wiXG4gICAgICAgID5cbiAgICAgICAgPC9wbmctYXV0by1jb21wbGV0ZT5cbiAgICAgICAgPCEtLTxpbnB1dCB0eXBlPVwidGV4dFwiIHBJbnB1dFRleHQgWyhuZ01vZGVsKV09XCJxdWVyeVZhbHVlXCIgcGxhY2Vob2xkZXI9XCLovpPlhaXmn6Xor6LmoIflh4ZcIj4tLT5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIDwvbmctY29udGFpbmVyPlxuICBgLFxuICBzdHlsZVVybHM6IFsnc3R5bGVzLnNjc3MnXVxufSlcblxuZXhwb3J0IGNsYXNzIFBuZ1F1ZXJ5SW5wdXRDb21wb25lbnQgZXh0ZW5kcyBCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuXG4gIERBVEFfVFlQRSA9IERhdGFUeXBlO1xuXG4gIERBVEFfQVRUUiA9IERhdGFBdHRyO1xuXG4gIEBJbnB1dCgpIHF1ZXJ5S2V5OiBzdHJpbmc7XG5cbiAgQElucHV0KCkgcXVlcnlEYXRhVHlwZTogRGF0YVR5cGU7XG5cbiAgQElucHV0KCkgcXVlcnlEYXRhQXR0cjogRGF0YUF0dHI7XG5cbiAgQElucHV0KCkgb3B0aW9ucyA9IHt9O1xuXG4gIEBJbnB1dCgpIGF1dG9Qcm9wczoge307XG5cbiAgQElucHV0KCkgc2xpZGVyUHJvcHM6IHt9O1xuXG4gIEBPdXRwdXQoKVxuICBxdWVyeVZhbHVlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG5cbiAgaXNUaW1lID0gZmFsc2U7XG5cbiAgYXV0b0NvbXBsZXRlUHJvcHMkOiBCZWhhdmlvclN1YmplY3Q8UG5nQXV0b0NvbXBsZXRlUHJvcHM+ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxQbmdBdXRvQ29tcGxldGVQcm9wcz4odW5kZWZpbmVkKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBuZ1RhYmxlOiBQbmdUYWJsZUNvbXBvbmVudCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBwcml2YXRlIF9xdWVyeVZhbHVlO1xuXG4gIEBJbnB1dCgpXG4gIGdldCBxdWVyeVZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl9xdWVyeVZhbHVlO1xuICB9XG5cbiAgc2V0IHF1ZXJ5VmFsdWUocXVlcnlWYWx1ZSkge1xuICAgIHRoaXMuX3F1ZXJ5VmFsdWUgPSBxdWVyeVZhbHVlO1xuICAgIHRoaXMucXVlcnlWYWx1ZUNoYW5nZS5lbWl0KHF1ZXJ5VmFsdWUpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgc3VwZXIubmdPbkluaXQoKTtcbiAgICB0aGlzLmF1dG9Qcm9wcyA9IDxQbmdBdXRvQ29tcGxldGVQcm9wcz4ge1xuICAgICAgaW5wdXRTdHlsZTogeydtaW4td2lkdGgnOiAnMjAwcHgnfSxcbiAgICAgIGFwcGVuZFRvOiAnYm9keScsXG4gICAgICBmb3JjZVNlbGVjdGlvbjogZmFsc2UsXG4gICAgICAkZXh0OiB7XG4gICAgICAgIGFwaURhdGFQcm9wczoge1xuICAgICAgICAgIC4uLnRoaXMucG5nVGFibGUuZ2V0VGFibGVRdWVyeSgpLFxuICAgICAgICAgIHNlYXJjaEZpZWxkczogdGhpcy5xdWVyeUtleSxcbiAgICAgICAgICByZXR1cm5GaWVsZHM6IHRoaXMucXVlcnlLZXksXG4gICAgICAgICAgYWdnUHJvcHM6IHtuYW1lOiB0aGlzLnF1ZXJ5S2V5LCBmaWVsZDogdGhpcy5xdWVyeUtleX0sXG4gICAgICAgICAgZGF0YVBhdGg6IGBhZ2dzLiR7dGhpcy5xdWVyeUtleX1gXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGFJdGVtUHJvcHM6IHtcbiAgICAgICAgICBzaG93Q291bnRlcjogdHJ1ZSxcbiAgICAgICAgICBkcm9wRG93bk9wdGlvbktleTogRGF0YUl0ZW1VdGlscy5JVEVNX0xBQkVMX0tFWSxcbiAgICAgICAgICB2YWx1ZUtleTogRGF0YUl0ZW1VdGlscy5JVEVNX0xBQkVMX0tFWVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnNsaWRlclByb3BzID0gPFBuZ1NsaWRlclByb3BzPiB7XG4gICAgICByYW5nZTogdHJ1ZSxcbiAgICAgICRleHQ6IHtcbiAgICAgICAgYXBpRGF0YVByb3BzOiB7XG4gICAgICAgICAgLi4udGhpcy5wbmdUYWJsZS5nZXRUYWJsZVF1ZXJ5KCksXG4gICAgICAgICAgYWdnUHJvcHM6IFtcbiAgICAgICAgICAgIHtuYW1lOiAnbWF4JywgZmllbGQ6IHRoaXMucXVlcnlLZXksIG1ldGhvZDogQWdnTWV0aG9kcy5NQVh9LFxuICAgICAgICAgICAge25hbWU6ICdtaW4nLCBmaWVsZDogdGhpcy5xdWVyeUtleSwgbWV0aG9kOiBBZ2dNZXRob2RzLk1JTn1cbiAgICAgICAgICBdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIGlmICh0aGlzLnF1ZXJ5RGF0YVR5cGUgPT09IERhdGFUeXBlLkRBVEUgJiYgdGhpcy5xdWVyeURhdGFBdHRyKSB7XG4gICAgICBjb25zdCBhdHRycyA9IENvbW1vbnNVdGlscy5nZXRBcnJheVZhbHVlKHRoaXMucXVlcnlEYXRhQXR0cik7XG4gICAgICBpZiAoYXR0cnMuaW5kZXhPZihEYXRhQXR0ci5EQVRFKSA+PSAwKSB7XG4gICAgICAgIHRoaXMuaXNUaW1lID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoYXR0cnMuaW5kZXhPZihEYXRhQXR0ci5USU1FKSA+PSAwKSB7XG4gICAgICAgIHRoaXMuaXNUaW1lID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==