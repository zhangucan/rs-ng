/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectionStrategy, Component, Input } from '@angular/core';
import { ApiUtils, BaseComponent, DataFieldUtils } from '@er/core';
import { CommonsUtils } from '@er/utils';
import { PngTableComponent } from '../table/component';
export class PngTableExpandedRowComponent extends BaseComponent {
    /**
     * @param {?} pngTable
     */
    constructor(pngTable) {
        super();
        this.pngTable = pngTable;
        this.customerContent = false;
    }
    /**
     * @return {?}
     */
    get dataColumns() {
        return this.columns.filter(column => column.isDataColumn !== false && !column.isActionColumn);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.rowId) {
            if (this.pngTable.$props.$ext.onExpandRowContent) {
                this.customerContent = true;
                this.expandContent$ = this.pngTable.$props.$ext.onExpandRowContent.method(this.rowId);
            }
            else {
                this.expandContent$ = ApiUtils.getById(this.pngTable.$props.$ext.apiDataProps.apiEntry, this.rowId, {
                    tag: this.rowId,
                    payload: { 'fields': this.pngTable.$props.$ext.expandRowFields || this.pngTable.dataColumnNames }
                });
            }
        }
    }
    /**
     * @param {?} col
     * @param {?} rowData
     * @return {?}
     */
    content(col, rowData) {
        if (!col.key) {
            return;
        }
        if (col.cellContent) {
            console.log('cellcontent');
            return col.cellContent({ row: rowData });
        }
        /** @type {?} */
        let c = rowData[col.key];
        if (CommonsUtils.isJson(c)) {
            /** @type {?} */
            let key;
            if (col.dataField) {
                key = DataFieldUtils.getDefaultFieldName(col.dataField);
            }
            if (key) {
                return CommonsUtils.get(c, key);
            }
            else {
                /** @type {?} */
                const trans = {};
                Object.keys(c).forEach(sub => {
                    /** @type {?} */
                    const label = CommonsUtils.get(col, `dataField.fields.${sub}.label`);
                    if (label) {
                        trans[label] = c[sub];
                    }
                    else {
                        trans[sub] = c[sub];
                    }
                });
                c = trans;
            }
        }
        return CommonsUtils.getText(c);
    }
}
PngTableExpandedRowComponent.decorators = [
    { type: Component, args: [{
                selector: '[png-table-expanded-row]',
                template: `
    <ng-container *ngIf="customerTpl;else default">
      <ng-container *ngTemplateOutlet="customerTpl;context:{$implicit:rowId,context:pngTable}"></ng-container>
    </ng-container>
    <ng-template #default>
      <td colspan="100%">
        <p-card styleClass="ui-card-shadow w-100 ui-table-expanded-content" >
          <er-http-status [tag]="rowId" erPosition></er-http-status>
          <ng-container *ngIf="expandContent$|async as expandContent">
            <div class="row w-100 m-3" style="font-size: 16px">
              <ng-container *ngIf="!customerContent">
                <ng-container *ngFor="let col of dataColumns">
                  <span class="col-2 my-3"><b class="pull-right" [innerHTML]="col.label"></b></span>
                  <ng-container *ngIf="col.expandViewContent;else defaultView">
                    <er-dyna-content [content]="col.expandViewContent" [context]="{data: expandContent, col: col}"></er-dyna-content>
                  </ng-container>
                  <ng-template #defaultView>
                    <span class="col-4 my-3">{{content(col, expandContent)}}</span>
                  </ng-template>
                </ng-container>
              </ng-container>
              <ng-container *ngIf="customerContent">
                <er-dyna-content [content]="expandContent"></er-dyna-content>
              </ng-container>
            </div>
          </ng-container>
        </p-card>
      </td>
    </ng-template>

  `,
                changeDetection: ChangeDetectionStrategy.OnPush
            }] }
];
/** @nocollapse */
PngTableExpandedRowComponent.ctorParameters = () => [
    { type: PngTableComponent }
];
PngTableExpandedRowComponent.propDecorators = {
    rowId: [{ type: Input }],
    columns: [{ type: Input }],
    styleClass: [{ type: Input }],
    style: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.rowId;
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.columns;
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.styleClass;
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.style;
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.expandContent$;
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.customerContent;
    /** @type {?} */
    PngTableExpandedRowComponent.prototype.pngTable;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVyL3ByaW1lbmcvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90YWJsZS9jb21wb25lbnQvZXhwYW5kZWQtcm93L2NvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQTJCLE1BQU0sZUFBZSxDQUFDO0FBQ2xHLE9BQU8sRUFBQyxRQUFRLEVBQUUsYUFBYSxFQUFFLGNBQWMsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUNqRSxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBR3ZDLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLG9CQUFvQixDQUFDO0FBc0NyRCxNQUFNLE9BQU8sNEJBQTZCLFNBQVEsYUFBYTs7OztJQWM3RCxZQUFtQixRQUEyQjtRQUM1QyxLQUFLLEVBQUUsQ0FBQztRQURTLGFBQVEsR0FBUixRQUFRLENBQW1CO1FBRjlDLG9CQUFlLEdBQUcsS0FBSyxDQUFDO0lBSXhCLENBQUM7Ozs7SUFFRCxJQUFJLFdBQVc7UUFDYixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFlBQVksS0FBSyxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDaEcsQ0FBQzs7Ozs7SUFFRCxXQUFXLENBQUMsT0FBc0I7UUFDaEMsSUFBSSxPQUFPLENBQUMsS0FBSyxFQUFFO1lBQ2pCLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGtCQUFrQixFQUFFO2dCQUNoRCxJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztnQkFDNUIsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUN2RjtpQkFBTTtnQkFDTCxJQUFJLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRTtvQkFDbEcsR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLO29CQUNmLE9BQU8sRUFBRSxFQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxFQUFDO2lCQUNoRyxDQUFDLENBQUM7YUFDSjtTQUNGO0lBQ0gsQ0FBQzs7Ozs7O0lBRUQsT0FBTyxDQUFDLEdBQUcsRUFBRSxPQUFPO1FBQ2xCLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFO1lBQ1osT0FBTztTQUNSO1FBQ0QsSUFBSSxHQUFHLENBQUMsV0FBVyxFQUFFO1lBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDM0IsT0FBTyxHQUFHLENBQUMsV0FBVyxDQUFDLEVBQUMsR0FBRyxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7U0FDeEM7O1lBQ0csQ0FBQyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO1FBQ3hCLElBQUksWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRTs7Z0JBQ3RCLEdBQUc7WUFDUCxJQUFJLEdBQUcsQ0FBQyxTQUFTLEVBQUU7Z0JBQ2pCLEdBQUcsR0FBRyxjQUFjLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2FBQ3pEO1lBQ0QsSUFBSSxHQUFHLEVBQUU7Z0JBQ1AsT0FBTyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQzthQUNqQztpQkFBTTs7c0JBQ0MsS0FBSyxHQUFHLEVBQUU7Z0JBQ2hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFOzswQkFDckIsS0FBSyxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLG9CQUFvQixHQUFHLFFBQVEsQ0FBQztvQkFDcEUsSUFBSSxLQUFLLEVBQUU7d0JBQ1QsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztxQkFDdkI7eUJBQU07d0JBQ0wsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztxQkFDckI7Z0JBQ0gsQ0FBQyxDQUFDLENBQUM7Z0JBQ0gsQ0FBQyxHQUFHLEtBQUssQ0FBQzthQUNYO1NBQ0Y7UUFDRCxPQUFPLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7O1lBdEdGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsMEJBQTBCO2dCQUNwQyxRQUFRLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQThCVDtnQkFDRCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTthQUNoRDs7OztZQXBDTyxpQkFBaUI7OztvQkF3Q3RCLEtBQUs7c0JBRUwsS0FBSzt5QkFFTCxLQUFLO29CQUVMLEtBQUs7Ozs7SUFOTiw2Q0FBb0I7O0lBRXBCLCtDQUF3Qzs7SUFFeEMsa0RBQXlCOztJQUV6Qiw2Q0FBbUM7O0lBRW5DLHNEQUFnQzs7SUFFaEMsdURBQXdCOztJQUVaLGdEQUFrQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbXBvbmVudCwgSW5wdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlc30gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0FwaVV0aWxzLCBCYXNlQ29tcG9uZW50LCBEYXRhRmllbGRVdGlsc30gZnJvbSAnQGVyL2NvcmUnO1xuaW1wb3J0IHtDb21tb25zVXRpbHN9IGZyb20gJ0Blci91dGlscyc7XG5pbXBvcnQge09ic2VydmFibGV9IGZyb20gJ3J4anMvaW50ZXJuYWwvT2JzZXJ2YWJsZSc7XG5pbXBvcnQge1BuZ1RhYmxlQ29sdW1uUHJvcHN9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCB7UG5nVGFibGVDb21wb25lbnR9IGZyb20gJy4uL3RhYmxlL2NvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ1twbmctdGFibGUtZXhwYW5kZWQtcm93XScsXG4gIHRlbXBsYXRlOiBgXG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImN1c3RvbWVyVHBsO2Vsc2UgZGVmYXVsdFwiPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImN1c3RvbWVyVHBsO2NvbnRleHQ6eyRpbXBsaWNpdDpyb3dJZCxjb250ZXh0OnBuZ1RhYmxlfVwiPjwvbmctY29udGFpbmVyPlxuICAgIDwvbmctY29udGFpbmVyPlxuICAgIDxuZy10ZW1wbGF0ZSAjZGVmYXVsdD5cbiAgICAgIDx0ZCBjb2xzcGFuPVwiMTAwJVwiPlxuICAgICAgICA8cC1jYXJkIHN0eWxlQ2xhc3M9XCJ1aS1jYXJkLXNoYWRvdyB3LTEwMCB1aS10YWJsZS1leHBhbmRlZC1jb250ZW50XCIgPlxuICAgICAgICAgIDxlci1odHRwLXN0YXR1cyBbdGFnXT1cInJvd0lkXCIgZXJQb3NpdGlvbj48L2VyLWh0dHAtc3RhdHVzPlxuICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJleHBhbmRDb250ZW50JHxhc3luYyBhcyBleHBhbmRDb250ZW50XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicm93IHctMTAwIG0tM1wiIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4XCI+XG4gICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhY3VzdG9tZXJDb250ZW50XCI+XG4gICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgY29sIG9mIGRhdGFDb2x1bW5zXCI+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNvbC0yIG15LTNcIj48YiBjbGFzcz1cInB1bGwtcmlnaHRcIiBbaW5uZXJIVE1MXT1cImNvbC5sYWJlbFwiPjwvYj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY29sLmV4cGFuZFZpZXdDb250ZW50O2Vsc2UgZGVmYXVsdFZpZXdcIj5cbiAgICAgICAgICAgICAgICAgICAgPGVyLWR5bmEtY29udGVudCBbY29udGVudF09XCJjb2wuZXhwYW5kVmlld0NvbnRlbnRcIiBbY29udGV4dF09XCJ7ZGF0YTogZXhwYW5kQ29udGVudCwgY29sOiBjb2x9XCI+PC9lci1keW5hLWNvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSAjZGVmYXVsdFZpZXc+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY29sLTQgbXktM1wiPnt7Y29udGVudChjb2wsIGV4cGFuZENvbnRlbnQpfX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImN1c3RvbWVyQ29udGVudFwiPlxuICAgICAgICAgICAgICAgIDxlci1keW5hLWNvbnRlbnQgW2NvbnRlbnRdPVwiZXhwYW5kQ29udGVudFwiPjwvZXItZHluYS1jb250ZW50PlxuICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8L3AtY2FyZD5cbiAgICAgIDwvdGQ+XG4gICAgPC9uZy10ZW1wbGF0ZT5cblxuICBgLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcblxuZXhwb3J0IGNsYXNzIFBuZ1RhYmxlRXhwYW5kZWRSb3dDb21wb25lbnQgZXh0ZW5kcyBCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcblxuICBASW5wdXQoKSByb3dJZDogYW55O1xuXG4gIEBJbnB1dCgpIGNvbHVtbnM6IFBuZ1RhYmxlQ29sdW1uUHJvcHNbXTtcblxuICBASW5wdXQoKSBzdHlsZUNsYXNzOiBhbnk7XG5cbiAgQElucHV0KCkgc3R5bGU6IHt9IHwgKChyb3cpID0+IHt9KTtcblxuICBleHBhbmRDb250ZW50JDogT2JzZXJ2YWJsZTxhbnk+O1xuXG4gIGN1c3RvbWVyQ29udGVudCA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBwbmdUYWJsZTogUG5nVGFibGVDb21wb25lbnQpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgZ2V0IGRhdGFDb2x1bW5zKCkge1xuICAgIHJldHVybiB0aGlzLmNvbHVtbnMuZmlsdGVyKGNvbHVtbiA9PiBjb2x1bW4uaXNEYXRhQ29sdW1uICE9PSBmYWxzZSAmJiAhY29sdW1uLmlzQWN0aW9uQ29sdW1uKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAoY2hhbmdlcy5yb3dJZCkge1xuICAgICAgaWYgKHRoaXMucG5nVGFibGUuJHByb3BzLiRleHQub25FeHBhbmRSb3dDb250ZW50KSB7XG4gICAgICAgIHRoaXMuY3VzdG9tZXJDb250ZW50ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5leHBhbmRDb250ZW50JCA9IHRoaXMucG5nVGFibGUuJHByb3BzLiRleHQub25FeHBhbmRSb3dDb250ZW50Lm1ldGhvZCh0aGlzLnJvd0lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZXhwYW5kQ29udGVudCQgPSBBcGlVdGlscy5nZXRCeUlkKHRoaXMucG5nVGFibGUuJHByb3BzLiRleHQuYXBpRGF0YVByb3BzLmFwaUVudHJ5LCB0aGlzLnJvd0lkLCB7XG4gICAgICAgICAgdGFnOiB0aGlzLnJvd0lkLFxuICAgICAgICAgIHBheWxvYWQ6IHsnZmllbGRzJzogdGhpcy5wbmdUYWJsZS4kcHJvcHMuJGV4dC5leHBhbmRSb3dGaWVsZHMgfHwgdGhpcy5wbmdUYWJsZS5kYXRhQ29sdW1uTmFtZXN9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnRlbnQoY29sLCByb3dEYXRhKSB7XG4gICAgaWYgKCFjb2wua2V5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb2wuY2VsbENvbnRlbnQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdjZWxsY29udGVudCcpO1xuICAgICAgcmV0dXJuIGNvbC5jZWxsQ29udGVudCh7cm93OiByb3dEYXRhfSk7XG4gICAgfVxuICAgIGxldCBjID0gcm93RGF0YVtjb2wua2V5XTtcbiAgICBpZiAoQ29tbW9uc1V0aWxzLmlzSnNvbihjKSkge1xuICAgICAgbGV0IGtleTtcbiAgICAgIGlmIChjb2wuZGF0YUZpZWxkKSB7XG4gICAgICAgIGtleSA9IERhdGFGaWVsZFV0aWxzLmdldERlZmF1bHRGaWVsZE5hbWUoY29sLmRhdGFGaWVsZCk7XG4gICAgICB9XG4gICAgICBpZiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBDb21tb25zVXRpbHMuZ2V0KGMsIGtleSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB0cmFucyA9IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyhjKS5mb3JFYWNoKHN1YiA9PiB7XG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBDb21tb25zVXRpbHMuZ2V0KGNvbCwgYGRhdGFGaWVsZC5maWVsZHMuJHtzdWJ9LmxhYmVsYCk7XG4gICAgICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgICAgICB0cmFuc1tsYWJlbF0gPSBjW3N1Yl07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyYW5zW3N1Yl0gPSBjW3N1Yl07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYyA9IHRyYW5zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gQ29tbW9uc1V0aWxzLmdldFRleHQoYyk7XG4gIH1cbn1cbiJdfQ==