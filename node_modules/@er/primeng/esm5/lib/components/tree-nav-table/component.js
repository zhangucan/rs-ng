/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, Input, ViewChild } from '@angular/core';
import { ActivatedRoute, NavigationEnd, Router } from '@angular/router';
import { RouteBindComponent } from '@er/core';
import { ANIMATIONS } from '@er/presets';
import { CommonsUtils, IdUtils } from '@er/utils';
import { PngTableComponent } from '../table/component/table/component';
import { PngTreeComponent } from '../tree/component';
var PngTreeNavTableComponent = /** @class */ (function (_super) {
    tslib_1.__extends(PngTreeNavTableComponent, _super);
    function PngTreeNavTableComponent(cd, router, activatedRoute) {
        var _this = _super.call(this) || this;
        _this.cd = cd;
        _this.router = router;
        _this.activatedRoute = activatedRoute;
        _this.switchable = true;
        _this.hideTree = false;
        _this.$subscriptions = _this.router.events.subscribe(function (event) {
            if (event instanceof NavigationEnd) {
                _this.isFormOutlet = event.url.indexOf('(aux:') > 0;
                if (_this.isRestore) {
                    _this.isRestore = false;
                    _this.refresh();
                }
                _this.cd.markForCheck();
            }
        });
        return _this;
    }
    Object.defineProperty(PngTreeNavTableComponent.prototype, "isFormOutlet", {
        get: /**
         * @return {?}
         */
        function () {
            return this._isFormOutlet;
        },
        set: /**
         * @param {?} formOutlet
         * @return {?}
         */
        function (formOutlet) {
            if (this.isFormOutlet !== formOutlet) {
                this._isFormOutlet = formOutlet;
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PngTreeNavTableComponent.prototype.refresh = /**
     * @return {?}
     */
    function () {
        this.pngTable.load();
        if (this.pngTree && this.refreshTree) {
            this.refreshTree = false;
            this.pngTree.load();
        }
    };
    /**
     * @param {?} props
     * @return {?}
     */
    PngTreeNavTableComponent.prototype.beforeRoutePropsBind = /**
     * @param {?} props
     * @return {?}
     */
    function (props) {
        this.tree = undefined;
        this.table = undefined;
        this.switchable = true;
        this.hideTree = false;
        if (props.caption) {
            CommonsUtils.set(props, 'table.caption', props.caption);
        }
        return props;
    };
    /**
     * @return {?}
     */
    PngTreeNavTableComponent.prototype.afterRoutePropsBind = /**
     * @return {?}
     */
    function () {
        if (!this.tree) {
            this.switchable = false;
        }
        else {
            this.hideTree = false;
            this.switchable = true;
            this.tree.$id = IdUtils.getRandom();
            this.tree.$container = this;
            CommonsUtils.set(this.tree, '$ext.$container', this);
        }
        if (this.table) {
            this.table.$id = IdUtils.getRandom();
            this.table.$container = this;
            CommonsUtils.set(this.table, '$ext.$container', this);
        }
    };
    /**
     * @return {?}
     */
    PngTreeNavTableComponent.prototype.closeTree = /**
     * @return {?}
     */
    function () {
        this.hideTree = true;
    };
    /**
     * @return {?}
     */
    PngTreeNavTableComponent.prototype.back = /**
     * @return {?}
     */
    function () {
        this.isRestore = true;
        this.router.navigate(['./', { outlets: { aux: null } }], {
            relativeTo: this.activatedRoute
        });
    };
    PngTreeNavTableComponent.decorators = [
        { type: Component, args: [{
                    selector: 'png-tree-nav-table',
                    template: "\n    <div [hidden]=\"isFormOutlet\">\n      <er-fluid-container>\n        <er-left-right [hideLeft]=\"!tree || hideTree\" [switchable]=\"!!tree && switchable\">\n          <ng-template erTypedTemplate=\"left\">\n            <png-panel *ngIf=\"tree\" [icon]=\"tree.$ext?.captionIcon || 'fa fa-tree'\" [header]=\"tree.$ext?.caption || '\u7BA1\u7406\u6811'\">\n              <png-tree erPropsBind [props]=\"tree\" (onEmptyNode)=\"closeTree()\"></png-tree>\n            </png-panel>\n          </ng-template>\n          <ng-template erTypedTemplate=\"right\">\n            <div *ngIf=\"table\">\n              <div [@fadeIn]=\"true\">\n                <png-table erPropsBind [props]=\"table\"></png-table>\n              </div>\n            </div>\n          </ng-template>\n        </er-left-right>\n      </er-fluid-container>\n    </div>\n    <router-outlet name=\"aux\">\n      <ng-container *ngTemplateOutlet=\"goBack\"></ng-container>\n    </router-outlet>\n    <ng-container *ngTemplateOutlet=\"goBack\"></ng-container>\n    <ng-template #goBack>\n      <div *ngIf=\"isFormOutlet\">\n        <a (click)=\"back()\" class=\"btn btn-outline-primary\"\n           title=\"\u8FD4\u56DE\u5230\u6570\u636E\u6D4F\u89C8\"> <i class=\"fa fa-2x text-danger fa-sign-out fa-rotate-180\"></i> \u8FD4\u56DE</a>\n\n      </div>\n    </ng-template>\n  ",
                    animations: [
                        ANIMATIONS.zoomIn,
                        ANIMATIONS.fadeIn
                    ],
                    changeDetection: ChangeDetectionStrategy.OnPush
                }] }
    ];
    /** @nocollapse */
    PngTreeNavTableComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef },
        { type: Router },
        { type: ActivatedRoute }
    ]; };
    PngTreeNavTableComponent.propDecorators = {
        tree: [{ type: Input }],
        table: [{ type: Input }],
        switchable: [{ type: Input }],
        hideTree: [{ type: Input }],
        pngTable: [{ type: ViewChild, args: [PngTableComponent,] }],
        pngTree: [{ type: ViewChild, args: [PngTreeComponent,] }]
    };
    return PngTreeNavTableComponent;
}(RouteBindComponent));
export { PngTreeNavTableComponent };
if (false) {
    /** @type {?} */
    PngTreeNavTableComponent.prototype.tree;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.table;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.switchable;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.hideTree;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.pngTable;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.pngTree;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.refreshTree;
    /** @type {?} */
    PngTreeNavTableComponent.prototype.isRestore;
    /** @type {?} */
    PngTreeNavTableComponent.prototype._isFormOutlet;
    /**
     * @type {?}
     * @private
     */
    PngTreeNavTableComponent.prototype.cd;
    /**
     * @type {?}
     * @private
     */
    PngTreeNavTableComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    PngTreeNavTableComponent.prototype.activatedRoute;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVyL3ByaW1lbmcvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90cmVlLW5hdi10YWJsZS9jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUMsdUJBQXVCLEVBQUUsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDdEcsT0FBTyxFQUFDLGNBQWMsRUFBRSxhQUFhLEVBQUUsTUFBTSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDdEUsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQzVDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDdkMsT0FBTyxFQUFDLFlBQVksRUFBRSxPQUFPLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDaEQsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sb0NBQW9DLENBQUM7QUFFckUsT0FBTyxFQUFDLGdCQUFnQixFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFHbkQ7SUF1QzhDLG9EQUFrQjtJQW1COUQsa0NBQW9CLEVBQXFCLEVBQVUsTUFBYyxFQUFVLGNBQThCO1FBQXpHLFlBQ0UsaUJBQU8sU0FXUjtRQVptQixRQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUFVLFlBQU0sR0FBTixNQUFNLENBQVE7UUFBVSxvQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFiaEcsZ0JBQVUsR0FBRyxJQUFJLENBQUM7UUFFbEIsY0FBUSxHQUFHLEtBQUssQ0FBQztRQWF4QixLQUFJLENBQUMsY0FBYyxHQUFHLEtBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxVQUFBLEtBQUs7WUFDdEQsSUFBSSxLQUFLLFlBQVksYUFBYSxFQUFFO2dCQUNsQyxLQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxD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QkEvSEYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxvQkFBb0I7b0JBQzlCLFFBQVEsRUFBRSw2ekNBOEJUO29CQUNELFVBQVUsRUFBRTt3QkFDVixVQUFVLENBQUMsTUFBTTt3QkFDakIsVUFBVSxDQUFDLE1BQU07cUJBQ2xCO29CQUNELGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNO2lCQUNoRDs7OztnQkFoRGdDLGlCQUFpQjtnQkFDWCxNQUFNO2dCQUFyQyxjQUFjOzs7dUJBa0RuQixLQUFLO3dCQUVMLEtBQUs7NkJBRUwsS0FBSzsyQkFFTCxLQUFLOzJCQUVMLFNBQVMsU0FBQyxpQkFBaUI7MEJBRTNCLFNBQVMsU0FBQyxnQkFBZ0I7O0lBa0Y3QiwrQkFBQztDQUFBLEFBcklELENBdUM4QyxrQkFBa0IsR0E4Ri9EO1NBOUZZLHdCQUF3Qjs7O0lBRW5DLHdDQUE0Qjs7SUFFNUIseUNBQThCOztJQUU5Qiw4Q0FBMkI7O0lBRTNCLDRDQUEwQjs7SUFFMUIsNENBQTBEOztJQUUxRCwyQ0FBdUQ7O0lBRXZELCtDQUFxQjs7SUFFckIsNkNBQW1COztJQUNuQixpREFBdUI7Ozs7O0lBRVgsc0NBQTZCOzs7OztJQUFFLDBDQUFzQjs7Ozs7SUFBRSxrREFBc0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBJbnB1dCwgVmlld0NoaWxkfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7QWN0aXZhdGVkUm91dGUsIE5hdmlnYXRpb25FbmQsIFJvdXRlcn0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7Um91dGVCaW5kQ29tcG9uZW50fSBmcm9tICdAZXIvY29yZSc7XG5pbXBvcnQge0FOSU1BVElPTlN9IGZyb20gJ0Blci9wcmVzZXRzJztcbmltcG9ydCB7Q29tbW9uc1V0aWxzLCBJZFV0aWxzfSBmcm9tICdAZXIvdXRpbHMnO1xuaW1wb3J0IHtQbmdUYWJsZUNvbXBvbmVudH0gZnJvbSAnLi4vdGFibGUvY29tcG9uZW50L3RhYmxlL2NvbXBvbmVudCc7XG5pbXBvcnQge1BuZ1RhYmxlUHJvcHN9IGZyb20gJy4uL3RhYmxlL3R5cGVzJztcbmltcG9ydCB7UG5nVHJlZUNvbXBvbmVudH0gZnJvbSAnLi4vdHJlZS9jb21wb25lbnQnO1xuaW1wb3J0IHtQbmdUcmVlUHJvcHN9IGZyb20gJy4uL3RyZWUvdHlwZXMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdwbmctdHJlZS1uYXYtdGFibGUnLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXYgW2hpZGRlbl09XCJpc0Zvcm1PdXRsZXRcIj5cbiAgICAgIDxlci1mbHVpZC1jb250YWluZXI+XG4gICAgICAgIDxlci1sZWZ0LXJpZ2h0IFtoaWRlTGVmdF09XCIhdHJlZSB8fCBoaWRlVHJlZVwiIFtzd2l0Y2hhYmxlXT1cIiEhdHJlZSAmJiBzd2l0Y2hhYmxlXCI+XG4gICAgICAgICAgPG5nLXRlbXBsYXRlIGVyVHlwZWRUZW1wbGF0ZT1cImxlZnRcIj5cbiAgICAgICAgICAgIDxwbmctcGFuZWwgKm5nSWY9XCJ0cmVlXCIgW2ljb25dPVwidHJlZS4kZXh0Py5jYXB0aW9uSWNvbiB8fCAnZmEgZmEtdHJlZSdcIiBbaGVhZGVyXT1cInRyZWUuJGV4dD8uY2FwdGlvbiB8fCAn566h55CG5qCRJ1wiPlxuICAgICAgICAgICAgICA8cG5nLXRyZWUgZXJQcm9wc0JpbmQgW3Byb3BzXT1cInRyZWVcIiAob25FbXB0eU5vZGUpPVwiY2xvc2VUcmVlKClcIj48L3BuZy10cmVlPlxuICAgICAgICAgICAgPC9wbmctcGFuZWw+XG4gICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICA8bmctdGVtcGxhdGUgZXJUeXBlZFRlbXBsYXRlPVwicmlnaHRcIj5cbiAgICAgICAgICAgIDxkaXYgKm5nSWY9XCJ0YWJsZVwiPlxuICAgICAgICAgICAgICA8ZGl2IFtAZmFkZUluXT1cInRydWVcIj5cbiAgICAgICAgICAgICAgICA8cG5nLXRhYmxlIGVyUHJvcHNCaW5kIFtwcm9wc109XCJ0YWJsZVwiPjwvcG5nLXRhYmxlPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDwvZXItbGVmdC1yaWdodD5cbiAgICAgIDwvZXItZmx1aWQtY29udGFpbmVyPlxuICAgIDwvZGl2PlxuICAgIDxyb3V0ZXItb3V0bGV0IG5hbWU9XCJhdXhcIj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJnb0JhY2tcIj48L25nLWNvbnRhaW5lcj5cbiAgICA8L3JvdXRlci1vdXRsZXQ+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImdvQmFja1wiPjwvbmctY29udGFpbmVyPlxuICAgIDxuZy10ZW1wbGF0ZSAjZ29CYWNrPlxuICAgICAgPGRpdiAqbmdJZj1cImlzRm9ybU91dGxldFwiPlxuICAgICAgICA8YSAoY2xpY2spPVwiYmFjaygpXCIgY2xhc3M9XCJidG4gYnRuLW91dGxpbmUtcHJpbWFyeVwiXG4gICAgICAgICAgIHRpdGxlPVwi6L+U5Zue5Yiw5pWw5o2u5rWP6KeIXCI+IDxpIGNsYXNzPVwiZmEgZmEtMnggdGV4dC1kYW5nZXIgZmEtc2lnbi1vdXQgZmEtcm90YXRlLTE4MFwiPjwvaT4g6L+U5ZuePC9hPlxuXG4gICAgICA8L2Rpdj5cbiAgICA8L25nLXRlbXBsYXRlPlxuICBgLFxuICBhbmltYXRpb25zOiBbXG4gICAgQU5JTUFUSU9OUy56b29tSW4sXG4gICAgQU5JTUFUSU9OUy5mYWRlSW5cbiAgXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgUG5nVHJlZU5hdlRhYmxlQ29tcG9uZW50IGV4dGVuZHMgUm91dGVCaW5kQ29tcG9uZW50IHtcblxuICBASW5wdXQoKSB0cmVlOiBQbmdUcmVlUHJvcHM7XG5cbiAgQElucHV0KCkgdGFibGU6IFBuZ1RhYmxlUHJvcHM7XG5cbiAgQElucHV0KCkgc3dpdGNoYWJsZSA9IHRydWU7XG5cbiAgQElucHV0KCkgaGlkZVRyZWUgPSBmYWxzZTtcblxuICBAVmlld0NoaWxkKFBuZ1RhYmxlQ29tcG9uZW50KSBwbmdUYWJsZTogUG5nVGFibGVDb21wb25lbnQ7XG5cbiAgQFZpZXdDaGlsZChQbmdUcmVlQ29tcG9uZW50KSBwbmdUcmVlOiBQbmdUcmVlQ29tcG9uZW50O1xuXG4gIHJlZnJlc2hUcmVlOiBib29sZWFuO1xuXG4gIGlzUmVzdG9yZTogYm9vbGVhbjtcbiAgX2lzRm9ybU91dGxldDogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZiwgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlciwgcHJpdmF0ZSBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuJHN1YnNjcmlwdGlvbnMgPSB0aGlzLnJvdXRlci5ldmVudHMuc3Vic2NyaWJlKGV2ZW50ID0+IHtcbiAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE5hdmlnYXRpb25FbmQpIHtcbiAgICAgICAgdGhpcy5pc0Zvcm1PdXRsZXQgPSBldmVudC51cmwuaW5kZXhPZignKGF1eDonKSA+IDA7XG4gICAgICAgIGlmICh0aGlzLmlzUmVzdG9yZSkge1xuICAgICAgICAgIHRoaXMuaXNSZXN0b3JlID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldCBpc0Zvcm1PdXRsZXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzRm9ybU91dGxldDtcbiAgfVxuXG4gIHNldCBpc0Zvcm1PdXRsZXQoZm9ybU91dGxldCkge1xuICAgIGlmICh0aGlzLmlzRm9ybU91dGxldCAhPT0gZm9ybU91dGxldCkge1xuICAgICAgdGhpcy5faXNGb3JtT3V0bGV0ID0gZm9ybU91dGxldDtcbiAgICB9XG4gIH1cblxuICByZWZyZXNoKCkge1xuICAgIHRoaXMucG5nVGFibGUubG9hZCgpO1xuICAgIGlmICh0aGlzLnBuZ1RyZWUgJiYgdGhpcy5yZWZyZXNoVHJlZSkge1xuICAgICAgdGhpcy5yZWZyZXNoVHJlZSA9IGZhbHNlO1xuICAgICAgdGhpcy5wbmdUcmVlLmxvYWQoKTtcbiAgICB9XG4gIH1cblxuICBiZWZvcmVSb3V0ZVByb3BzQmluZChwcm9wcykge1xuICAgIHRoaXMudHJlZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnRhYmxlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc3dpdGNoYWJsZSA9IHRydWU7XG4gICAgdGhpcy5oaWRlVHJlZSA9IGZhbHNlO1xuICAgIGlmIChwcm9wcy5jYXB0aW9uKSB7XG4gICAgICBDb21tb25zVXRpbHMuc2V0KHByb3BzLCAndGFibGUuY2FwdGlvbicsIHByb3BzLmNhcHRpb24pO1xuICAgIH1cbiAgICByZXR1cm4gcHJvcHM7XG4gIH1cblxuICBhZnRlclJvdXRlUHJvcHNCaW5kKCkge1xuICAgIGlmICghdGhpcy50cmVlKSB7XG4gICAgICB0aGlzLnN3aXRjaGFibGUgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oaWRlVHJlZSA9IGZhbHNlO1xuICAgICAgdGhpcy5zd2l0Y2hhYmxlID0gdHJ1ZTtcbiAgICAgIHRoaXMudHJlZS4kaWQgPSBJZFV0aWxzLmdldFJhbmRvbSgpO1xuICAgICAgdGhpcy50cmVlLiRjb250YWluZXIgPSB0aGlzO1xuICAgICAgQ29tbW9uc1V0aWxzLnNldCh0aGlzLnRyZWUsICckZXh0LiRjb250YWluZXInLCB0aGlzKTtcbiAgICB9XG4gICAgaWYgKHRoaXMudGFibGUpIHtcbiAgICAgIHRoaXMudGFibGUuJGlkID0gSWRVdGlscy5nZXRSYW5kb20oKTtcbiAgICAgIHRoaXMudGFibGUuJGNvbnRhaW5lciA9IHRoaXM7XG4gICAgICBDb21tb25zVXRpbHMuc2V0KHRoaXMudGFibGUsICckZXh0LiRjb250YWluZXInLCB0aGlzKTtcbiAgICB9XG4gIH1cblxuICBjbG9zZVRyZWUoKSB7XG4gICAgdGhpcy5oaWRlVHJlZSA9IHRydWU7XG4gIH1cblxuICBiYWNrKCkge1xuICAgIHRoaXMuaXNSZXN0b3JlID0gdHJ1ZTtcbiAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy4vJywge291dGxldHM6IHthdXg6IG51bGx9fV0sIHtcbiAgICAgIHJlbGF0aXZlVG86IHRoaXMuYWN0aXZhdGVkUm91dGVcbiAgICB9KTtcbiAgfVxuXG4gIC8vIG5nT25Jbml0KCkge1xuICAvLyAgIHN1cGVyLm5nT25Jbml0KCk7XG4gIC8vICAgYWxlcnQoKTtcbiAgLy8gfVxufVxuIl19