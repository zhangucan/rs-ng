/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { BaseComponent } from '@er/core';
import { AggMethods, DataAttr, DataType } from '@er/types';
import { CommonsUtils, DataItemUtils } from '@er/utils';
import { BehaviorSubject } from 'rxjs';
import { PngTableComponent } from '../../table/component';
var PngQueryInputComponent = /** @class */ (function (_super) {
    tslib_1.__extends(PngQueryInputComponent, _super);
    function PngQueryInputComponent(pngTable) {
        var _this = _super.call(this) || this;
        _this.pngTable = pngTable;
        _this.DATA_TYPE = DataType;
        _this.DATA_ATTR = DataAttr;
        _this.options = {};
        _this.queryValueChange = new EventEmitter();
        _this.isTime = false;
        _this.autoCompleteProps$ = new BehaviorSubject(undefined);
        return _this;
    }
    Object.defineProperty(PngQueryInputComponent.prototype, "queryValue", {
        get: /**
         * @return {?}
         */
        function () {
            return this._queryValue;
        },
        set: /**
         * @param {?} queryValue
         * @return {?}
         */
        function (queryValue) {
            this._queryValue = queryValue;
            this.queryValueChange.emit(queryValue);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    PngQueryInputComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        _super.prototype.ngOnInit.call(this);
        this.autoProps = (/** @type {?} */ ({
            inputStyle: { 'min-width': '200px' },
            appendTo: 'body',
            forceSelection: false,
            $ext: {
                apiDataProps: tslib_1.__assign({}, this.pngTable.getTableQuery(), { searchFields: this.queryKey, returnFields: this.queryKey, aggProps: { name: this.queryKey, field: this.queryKey }, dataPath: "aggs." + this.queryKey }),
                dataItemProps: {
                    showCounter: true,
                    dropDownOptionKey: DataItemUtils.ITEM_LABEL_KEY,
                    valueKey: DataItemUtils.ITEM_LABEL_KEY
                }
            }
        }));
        this.sliderProps = (/** @type {?} */ ({
            range: true,
            $ext: {
                apiDataProps: tslib_1.__assign({}, this.pngTable.getTableQuery(), { aggProps: [
                        { name: 'max', field: this.queryKey, method: AggMethods.MAX },
                        { name: 'min', field: this.queryKey, method: AggMethods.MIN }
                    ] })
            }
        }));
        if (this.queryDataType === DataType.DATE && this.queryDataAttr) {
            /** @type {?} */
            var attrs = CommonsUtils.getArrayValue(this.queryDataAttr);
            if (attrs.indexOf(DataAttr.DATE) >= 0) {
                this.isTime = false;
            }
            if (attrs.indexOf(DataAttr.TIME) >= 0) {
                this.isTime = true;
            }
        }
    };
    PngQueryInputComponent.decorators = [
        { type: Component, args: [{
                    selector: 'png-query-input',
                    template: "\n    <ng-container [ngSwitch]=\"queryDataType\">\n      <ng-container *ngSwitchCase=\"DATA_TYPE.NUMBER\">\n        <png-slider [(ngModel)]=\"queryValue\"\n                    erPropsBind\n                    [props]=\"sliderProps\"\n        >\n        </png-slider>\n      </ng-container>\n      <ng-container *ngSwitchCase=\"DATA_TYPE.BOOLEAN\">\n        <p-inputSwitch [(ngModel)]=\"queryValue\">\n        </p-inputSwitch>\n      </ng-container>\n      <ng-container *ngSwitchCase=\"DATA_TYPE.DATE\">\n        <ng-container *ngIf=\"!isTime\">\n          <png-calendar erPropsBind [(ngModel)]=\"queryValue\"\n                        [props]=\"{ selectionMode: 'range',placeholder:'\u8BF7\u9009\u62E9\u65E5\u671F'}\">\n          </png-calendar>\n        </ng-container>\n        <ng-container *ngIf=\"isTime\">\n          <png-calendar erPropsBind [(ngModel)]=\"queryValue\"\n                        [props]=\"{ timeOnly: true, selectionMode: 'range',placeholder:'\u8BF7\u9009\u62E9\u65F6\u95F4'}\"\n          >\n          </png-calendar>\n        </ng-container>\n      </ng-container>\n      <ng-container *ngSwitchDefault>\n        <png-auto-complete\n          [(ngModel)]=\"queryValue\"\n          erPropsBind\n          [props]=\"autoProps\"\n        >\n        </png-auto-complete>\n        <!--<input type=\"text\" pInputText [(ngModel)]=\"queryValue\" placeholder=\"\u8F93\u5165\u67E5\u8BE2\u6807\u51C6\">-->\n      </ng-container>\n    </ng-container>\n  ",
                    styles: ["/deep/ .ui-multiselect{min-width:150px}/deep/ .ui-multiselect-label-container label{margin:0!important}/deep/ .ui-slider{width:100px;margin:5px}"]
                }] }
    ];
    /** @nocollapse */
    PngQueryInputComponent.ctorParameters = function () { return [
        { type: PngTableComponent }
    ]; };
    PngQueryInputComponent.propDecorators = {
        queryKey: [{ type: Input }],
        queryDataType: [{ type: Input }],
        queryDataAttr: [{ type: Input }],
        options: [{ type: Input }],
        autoProps: [{ type: Input }],
        sliderProps: [{ type: Input }],
        queryValueChange: [{ type: Output }],
        queryValue: [{ type: Input }]
    };
    return PngQueryInputComponent;
}(BaseComponent));
export { PngQueryInputComponent };
if (false) {
    /** @type {?} */
    PngQueryInputComponent.prototype.DATA_TYPE;
    /** @type {?} */
    PngQueryInputComponent.prototype.DATA_ATTR;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryKey;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryDataType;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryDataAttr;
    /** @type {?} */
    PngQueryInputComponent.prototype.options;
    /** @type {?} */
    PngQueryInputComponent.prototype.autoProps;
    /** @type {?} */
    PngQueryInputComponent.prototype.sliderProps;
    /** @type {?} */
    PngQueryInputComponent.prototype.queryValueChange;
    /** @type {?} */
    PngQueryInputComponent.prototype.isTime;
    /** @type {?} */
    PngQueryInputComponent.prototype.autoCompleteProps$;
    /**
     * @type {?}
     * @private
     */
    PngQueryInputComponent.prototype._queryValue;
    /**
     * @type {?}
     * @private
     */
    PngQueryInputComponent.prototype.pngTable;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGVyL3ByaW1lbmcvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90YWJsZS9jb21wb25lbnQvcXVlcnkvaW5wdXQvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFxQixNQUFNLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDeEYsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUN2QyxPQUFPLEVBQUMsVUFBVSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDekQsT0FBTyxFQUFDLFlBQVksRUFBRSxhQUFhLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDdEQsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUdyQyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUd4RDtJQTBDNEMsa0RBQWE7SUF5QnZELGdDQUFvQixRQUEyQjtRQUEvQyxZQUNFLGlCQUFPLFNBQ1I7UUFGbUIsY0FBUSxHQUFSLFFBQVEsQ0FBbUI7UUF2Qi9DLGVBQVMsR0FBRyxRQUFRLENBQUM7UUFFckIsZUFBUyxHQUFHLFFBQVEsQ0FBQztRQVFaLGFBQU8sR0FBRyxFQUFFLENBQUM7UUFPdEIsc0JBQWdCLEdBQUcsSUFBSSxZQUFZLEVBQVUsQ0FBQztRQUU5QyxZQUFNLEdBQUcsS0FBSyxDQUFDO1FBRWYsd0JBQWtCLEdBQTBDLElBQUksZUFBZSxDQUF1QixTQUFTLENBQUMsQ0FBQzs7SUFJakgsQ0FBQztJQUlELHNCQUNJLDhDQUFVOzs7O1FBRGQ7WUFFRSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDMUIsQ0FBQzs7Ozs7UUFFRCxVQUFlLFVBQVU7WUFDdkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxVQUFVLENBQUM7WUFDOUIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN6QyxDQUFDOzs7T0FMQTs7OztJQU9ELHlDQUFROzs7SUFBUjtRQUNFLGlCQUFNLFFBQVEsV0FBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxTQUFTLEdBQUcsbUJBQXVCO1lBQ3RDLFVBQVUsRUFBRSxFQUFDLFdBQVcsRUFBRSxPQUFPLEVBQUM7WUFDbEMsUUFBUSxFQUFFLE1BQU07WUFDaEIsY0FBYyxFQUFFLEtBQUs7WUFDckIsSUFBSSxFQUFFO2dCQUNKLFlBQVksdUJBQ1AsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsSUFDaEMsWUFBWSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQzNCLFlBQVksRUFBRSxJQUFJLENBQUMsUUFBUSxFQUMzQixRQUFRLEVBQUUsRUFBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBQyxFQUNyRCxRQUFRLEVBQUUsVUFBUSxJQUFJLENBQUMsUUFBVSxHQUNsQztnQkFDRCxhQUFhLEVBQUU7b0JBQ2IsV0FBVyxFQUFFLElBQUk7b0JBQ2pCLGlCQUFpQixFQUFFLGFBQWEsQ0FBQyxjQUFjO29CQUMvQyxRQUFRLEVBQUUsYUFBYSxDQUFDLGNBQWM7aUJBQ3ZDO2FBQ0Y7U0FDRixFQUFBLENBQUM7UUFDRixJQUFJLENBQUMsV0FBVyxHQUFHLG1CQUFpQjtZQUNsQyxLQUFLLEVBQUUsSUFBSTtZQUNYLElBQUksRUFBRTtnQkFDSixZQUFZLHVCQUNQLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxFQUFFLElBQ2hDLFFBQVEsRUFBRTt3QkFDUixFQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUM7d0JBQzNELEVBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBQztxQkFDNUQsR0FDRjthQUNGO1NBQ0YsRUFBQSxDQUFDO1FBQ0YsSUFBSSxJQUFJLENBQUMsYUFBYSxLQUFLLFFBQVEsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTs7Z0JBQ3hELEtBQUssR0FBRyxZQUFZLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUM7WUFDNUQsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3JDLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO2FBQ3JCO1lBQ0QsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQ3JDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO2FBQ3BCO1NBQ0Y7SUFDSCxDQUFDOztnQkE3SEYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxpQkFBaUI7b0JBQzNCLFFBQVEsRUFBRSw0N0NBb0NUOztpQkFFRjs7OztnQkEzQ08saUJBQWlCOzs7MkJBbUR0QixLQUFLO2dDQUVMLEtBQUs7Z0NBRUwsS0FBSzswQkFFTCxLQUFLOzRCQUVMLEtBQUs7OEJBRUwsS0FBSzttQ0FFTCxNQUFNOzZCQWFOLEtBQUs7O0lBcURSLDZCQUFDO0NBQUEsQUE5SEQsQ0EwQzRDLGFBQWEsR0FvRnhEO1NBcEZZLHNCQUFzQjs7O0lBRWpDLDJDQUFxQjs7SUFFckIsMkNBQXFCOztJQUVyQiwwQ0FBMEI7O0lBRTFCLCtDQUFpQzs7SUFFakMsK0NBQWlDOztJQUVqQyx5Q0FBc0I7O0lBRXRCLDJDQUF1Qjs7SUFFdkIsNkNBQXlCOztJQUV6QixrREFDOEM7O0lBRTlDLHdDQUFlOztJQUVmLG9EQUFpSDs7Ozs7SUFNakgsNkNBQW9COzs7OztJQUpSLDBDQUFtQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE9uSW5pdCwgT3V0cHV0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7QmFzZUNvbXBvbmVudH0gZnJvbSAnQGVyL2NvcmUnO1xuaW1wb3J0IHtBZ2dNZXRob2RzLCBEYXRhQXR0ciwgRGF0YVR5cGV9IGZyb20gJ0Blci90eXBlcyc7XG5pbXBvcnQge0NvbW1vbnNVdGlscywgRGF0YUl0ZW1VdGlsc30gZnJvbSAnQGVyL3V0aWxzJztcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7UG5nQXV0b0NvbXBsZXRlUHJvcHN9IGZyb20gJy4uLy4uLy4uLy4uL2F1dG8tY29tcGxldGUvdHlwZSc7XG5pbXBvcnQge1BuZ1NsaWRlclByb3BzfSBmcm9tICcuLi8uLi8uLi8uLi9zbGlkZXIvY29tcG9uZW50JztcbmltcG9ydCB7UG5nVGFibGVDb21wb25lbnR9IGZyb20gJy4uLy4uL3RhYmxlL2NvbXBvbmVudCc7XG5cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAncG5nLXF1ZXJ5LWlucHV0JyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8bmctY29udGFpbmVyIFtuZ1N3aXRjaF09XCJxdWVyeURhdGFUeXBlXCI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaENhc2U9XCJEQVRBX1RZUEUuTlVNQkVSXCI+XG4gICAgICAgIDxwbmctc2xpZGVyIFsobmdNb2RlbCldPVwicXVlcnlWYWx1ZVwiXG4gICAgICAgICAgICAgICAgICAgIGVyUHJvcHNCaW5kXG4gICAgICAgICAgICAgICAgICAgIFtwcm9wc109XCJzbGlkZXJQcm9wc1wiXG4gICAgICAgID5cbiAgICAgICAgPC9wbmctc2xpZGVyPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaENhc2U9XCJEQVRBX1RZUEUuQk9PTEVBTlwiPlxuICAgICAgICA8cC1pbnB1dFN3aXRjaCBbKG5nTW9kZWwpXT1cInF1ZXJ5VmFsdWVcIj5cbiAgICAgICAgPC9wLWlucHV0U3dpdGNoPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaENhc2U9XCJEQVRBX1RZUEUuREFURVwiPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWlzVGltZVwiPlxuICAgICAgICAgIDxwbmctY2FsZW5kYXIgZXJQcm9wc0JpbmQgWyhuZ01vZGVsKV09XCJxdWVyeVZhbHVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtwcm9wc109XCJ7IHNlbGVjdGlvbk1vZGU6ICdyYW5nZScscGxhY2Vob2xkZXI6J+ivt+mAieaLqeaXpeacnyd9XCI+XG4gICAgICAgICAgPC9wbmctY2FsZW5kYXI+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNUaW1lXCI+XG4gICAgICAgICAgPHBuZy1jYWxlbmRhciBlclByb3BzQmluZCBbKG5nTW9kZWwpXT1cInF1ZXJ5VmFsdWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3Byb3BzXT1cInsgdGltZU9ubHk6IHRydWUsIHNlbGVjdGlvbk1vZGU6ICdyYW5nZScscGxhY2Vob2xkZXI6J+ivt+mAieaLqeaXtumXtCd9XCJcbiAgICAgICAgICA+XG4gICAgICAgICAgPC9wbmctY2FsZW5kYXI+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaERlZmF1bHQ+XG4gICAgICAgIDxwbmctYXV0by1jb21wbGV0ZVxuICAgICAgICAgIFsobmdNb2RlbCldPVwicXVlcnlWYWx1ZVwiXG4gICAgICAgICAgZXJQcm9wc0JpbmRcbiAgICAgICAgICBbcHJvcHNdPVwiYXV0b1Byb3BzXCJcbiAgICAgICAgPlxuICAgICAgICA8L3BuZy1hdXRvLWNvbXBsZXRlPlxuICAgICAgICA8IS0tPGlucHV0IHR5cGU9XCJ0ZXh0XCIgcElucHV0VGV4dCBbKG5nTW9kZWwpXT1cInF1ZXJ5VmFsdWVcIiBwbGFjZWhvbGRlcj1cIui+k+WFpeafpeivouagh+WHhlwiPi0tPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIGAsXG4gIHN0eWxlVXJsczogWydzdHlsZXMuc2NzcyddXG59KVxuXG5leHBvcnQgY2xhc3MgUG5nUXVlcnlJbnB1dENvbXBvbmVudCBleHRlbmRzIEJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG5cbiAgREFUQV9UWVBFID0gRGF0YVR5cGU7XG5cbiAgREFUQV9BVFRSID0gRGF0YUF0dHI7XG5cbiAgQElucHV0KCkgcXVlcnlLZXk6IHN0cmluZztcblxuICBASW5wdXQoKSBxdWVyeURhdGFUeXBlOiBEYXRhVHlwZTtcblxuICBASW5wdXQoKSBxdWVyeURhdGFBdHRyOiBEYXRhQXR0cjtcblxuICBASW5wdXQoKSBvcHRpb25zID0ge307XG5cbiAgQElucHV0KCkgYXV0b1Byb3BzOiB7fTtcblxuICBASW5wdXQoKSBzbGlkZXJQcm9wczoge307XG5cbiAgQE91dHB1dCgpXG4gIHF1ZXJ5VmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcblxuICBpc1RpbWUgPSBmYWxzZTtcblxuICBhdXRvQ29tcGxldGVQcm9wcyQ6IEJlaGF2aW9yU3ViamVjdDxQbmdBdXRvQ29tcGxldGVQcm9wcz4gPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFBuZ0F1dG9Db21wbGV0ZVByb3BzPih1bmRlZmluZWQpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcG5nVGFibGU6IFBuZ1RhYmxlQ29tcG9uZW50KSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgX3F1ZXJ5VmFsdWU7XG5cbiAgQElucHV0KClcbiAgZ2V0IHF1ZXJ5VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3F1ZXJ5VmFsdWU7XG4gIH1cblxuICBzZXQgcXVlcnlWYWx1ZShxdWVyeVZhbHVlKSB7XG4gICAgdGhpcy5fcXVlcnlWYWx1ZSA9IHF1ZXJ5VmFsdWU7XG4gICAgdGhpcy5xdWVyeVZhbHVlQ2hhbmdlLmVtaXQocXVlcnlWYWx1ZSk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBzdXBlci5uZ09uSW5pdCgpO1xuICAgIHRoaXMuYXV0b1Byb3BzID0gPFBuZ0F1dG9Db21wbGV0ZVByb3BzPiB7XG4gICAgICBpbnB1dFN0eWxlOiB7J21pbi13aWR0aCc6ICcyMDBweCd9LFxuICAgICAgYXBwZW5kVG86ICdib2R5JyxcbiAgICAgIGZvcmNlU2VsZWN0aW9uOiBmYWxzZSxcbiAgICAgICRleHQ6IHtcbiAgICAgICAgYXBpRGF0YVByb3BzOiB7XG4gICAgICAgICAgLi4udGhpcy5wbmdUYWJsZS5nZXRUYWJsZVF1ZXJ5KCksXG4gICAgICAgICAgc2VhcmNoRmllbGRzOiB0aGlzLnF1ZXJ5S2V5LFxuICAgICAgICAgIHJldHVybkZpZWxkczogdGhpcy5xdWVyeUtleSxcbiAgICAgICAgICBhZ2dQcm9wczoge25hbWU6IHRoaXMucXVlcnlLZXksIGZpZWxkOiB0aGlzLnF1ZXJ5S2V5fSxcbiAgICAgICAgICBkYXRhUGF0aDogYGFnZ3MuJHt0aGlzLnF1ZXJ5S2V5fWBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YUl0ZW1Qcm9wczoge1xuICAgICAgICAgIHNob3dDb3VudGVyOiB0cnVlLFxuICAgICAgICAgIGRyb3BEb3duT3B0aW9uS2V5OiBEYXRhSXRlbVV0aWxzLklURU1fTEFCRUxfS0VZLFxuICAgICAgICAgIHZhbHVlS2V5OiBEYXRhSXRlbVV0aWxzLklURU1fTEFCRUxfS0VZXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuc2xpZGVyUHJvcHMgPSA8UG5nU2xpZGVyUHJvcHM+IHtcbiAgICAgIHJhbmdlOiB0cnVlLFxuICAgICAgJGV4dDoge1xuICAgICAgICBhcGlEYXRhUHJvcHM6IHtcbiAgICAgICAgICAuLi50aGlzLnBuZ1RhYmxlLmdldFRhYmxlUXVlcnkoKSxcbiAgICAgICAgICBhZ2dQcm9wczogW1xuICAgICAgICAgICAge25hbWU6ICdtYXgnLCBmaWVsZDogdGhpcy5xdWVyeUtleSwgbWV0aG9kOiBBZ2dNZXRob2RzLk1BWH0sXG4gICAgICAgICAgICB7bmFtZTogJ21pbicsIGZpZWxkOiB0aGlzLnF1ZXJ5S2V5LCBtZXRob2Q6IEFnZ01ldGhvZHMuTUlOfVxuICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgaWYgKHRoaXMucXVlcnlEYXRhVHlwZSA9PT0gRGF0YVR5cGUuREFURSAmJiB0aGlzLnF1ZXJ5RGF0YUF0dHIpIHtcbiAgICAgIGNvbnN0IGF0dHJzID0gQ29tbW9uc1V0aWxzLmdldEFycmF5VmFsdWUodGhpcy5xdWVyeURhdGFBdHRyKTtcbiAgICAgIGlmIChhdHRycy5pbmRleE9mKERhdGFBdHRyLkRBVEUpID49IDApIHtcbiAgICAgICAgdGhpcy5pc1RpbWUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChhdHRycy5pbmRleE9mKERhdGFBdHRyLlRJTUUpID49IDApIHtcbiAgICAgICAgdGhpcy5pc1RpbWUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19