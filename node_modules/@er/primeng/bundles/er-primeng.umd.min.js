!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@er/image-editor"),require("@angular/platform-browser"),require("primeng/api"),require("elastic-builder"),require("@er/validate"),require("@angular/router"),require("@er/presets"),require("primeng/primeng"),require("primeng/table"),require("primeng/toast"),require("rxjs"),require("@angular/forms"),require("@er/types"),require("rxjs/operators"),require("@angular/animations"),require("@angular/core"),require("@er/core"),require("@er/utils")):"function"==typeof define&&define.amd?define("@er/primeng",["exports","@er/image-editor","@angular/platform-browser","primeng/api","elastic-builder","@er/validate","@angular/router","@er/presets","primeng/primeng","primeng/table","primeng/toast","rxjs","@angular/forms","@er/types","rxjs/operators","@angular/animations","@angular/core","@er/core","@er/utils"],t):t((e.er=e.er||{},e.er.primeng={}),e.imageEditor,e.ng.platformBrowser,e.api,e.esb,e.validate,e.ng.router,e.presets,e.primeng,e.table,e.toast,e.rxjs,e.ng.forms,e.types,e.rxjs.operators,e.ng.animations,e.ng.core,e.core$1,e.utils)}(this,function(e,t,n,a,i,o,r,s,l,p,c,u,g,d,m,h,f,y,x){"use strict";var v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function b(e,t){function n(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var C=function(){return(C=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,a,i=n.call(e),r=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)r.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(n=i["return"])&&n.call(i)}finally{if(a)throw a.error}}return r}function $(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}var T={minLength:0,size:10,dropdown:!0,forceSelection:!0,$ext:{apiDataProps:{dataPath:"items",autoFetch:!1}}},I=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.valueParser=e.parseValue,e.$defaultProps=T,e}return b(e,n),e.prototype.onPropsInit=function(){n.prototype.onPropsInit.call(this);var e="请输入";if(this.$props.$ext.apiDataProps&&(this.$props.$ext.apiDataProps.withPrefix||this.$props.$ext.apiDataProps.withTerm||this.$props.$ext.apiDataProps.withWildcard||(this.$props.$ext.apiDataProps.withPy=this.$props.$ext.apiDataProps.withPy||!0,this.$props.$ext.apiDataProps.withZh=this.$props.$ext.apiDataProps.withZh||!0),this.$props.placeholder||(this.$props.$ext.apiDataProps.withPy&&(e+="拼音首字母，"),this.$props.$ext.apiDataProps.withZh&&(e+="汉字关键字"),e+="筛选",this.$props.placeholder=e)),this.$props.$ext.dataItemProps&&(!this.$props.field&&x.CommonsUtils.isString(this.$props.$ext.dataItemProps.labelKey)&&(this.$props.field=this.$props.$ext.dataItemProps.labelKey),this.$props.$ext.dataItemProps.showCounter&&!this.$props.$ext.apiDataProps.aggProps)){var t=this.$props.$ext.apiDataProps.returnFields;this.$props.$ext.apiDataProps.aggProps=t}},e.prototype.complete=function(e){this.apiDataProps=C({},this.apiDataProps,{queryValue:e.query})},e.decorators=[{type:f.Component,args:[{selector:"png-auto-complete",template:'\n    <div class="inner-addon">\n      <p-autoComplete\n        [(ngModel)]="value"\n        erPropsBind\n        [props]="$props"\n        [context]="ctx"\n        [erApiData]="apiDataProps"\n        (completeMethod)="complete($event)"\n        [suggestions]="data$|async"\n        (onBlur)="updateTouch()"\n      >\n        <ng-template let-item pTemplate="item">\n          <er-data-item [customerTpl]="template(\'_\')"\n                        [item]="item"\n                        [props]="$props.$ext.dataItemProps"\n          >\n          </er-data-item>\n        </ng-template>\n      </p-autoComplete>\n      <i *ngIf="value && resettable && !disabled" title="清除输入内容" class="fa fa-trash text-muted right" [ngClass]="$props.dropdown? \'clear1\': \'clear2\'" (click)="reset()"></i>\n    </div>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}],styles:[".clear1{right:22px!important}.clear2{right:2px!important}"]}]}],e}(y.DataAwareControlWrapperComponent),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.$props&&this.$props.hidden&&x.CommonsUtils.getValue(this.$props.hidden,this.outputContext)||!1},enumerable:!0,configurable:!0}),t.prototype.onPropsInit=function(){var n=this,e=x.CommonsUtils.copy(this.$props||{});e.menu&&e.menu.forEach(function(e){if(e.command){var t=e.command;e.command=function(e){return n.onMenuCommand(t,e)}}}),this.$props=C({},s.DEFAULT_BUTTON_PROPS,e)},t.prototype.onMenuCommand=function(e,t){e.call(this,C({},t||{},this.outputContext||{}))},t.prototype.setState=function(e){this.icon=e?"fa fa-cog fa-spin":this.$props.icon},t.decorators=[{type:f.Component,args:[{selector:"png-button",template:'<ng-container *ngIf="!isHidden">\n  <p-splitButton *ngIf="$props?.menu"\n                 erPropsBind\n                 [props]="$props"\n                 [context]="outputContext"\n  >\n  </p-splitButton>\n  <p-button *ngIf="!$props?.menu" [title]="$props?.title || \'\'"\n            erPropsBind\n            [props]="$props"\n            [context]="outputContext"\n  >\n  </p-button>\n</ng-container>\n'}]}],t}(y.WrapperComponent),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),Object.defineProperty(t.prototype,"hasOverlay",{get:function(){return this.btns&&this.btns.some(function(e){return!!e.overlay})},enumerable:!0,configurable:!0}),t.prototype.toggle=function(e,t){t.toggle(e)},t.decorators=[{type:f.Component,args:[{selector:"png-buttons",template:'<div [ngClass]="styleClass" [ngStyle]="style">\n  <ng-container *ngIf="btns">\n    <div class="d-flex">\n      <ng-container *ngFor="let btn of btns">\n        <ng-container *ngIf="!btn.overlay">\n          <png-button [outputContext]="context || btn.context" [props]="btn" class="mr-2 w-100"\n                      erPropsBind></png-button>\n        </ng-container>\n      </ng-container>\n      <ng-container *ngIf="hasOverlay">\n        <button pButton title="更多操作..." icon="fa fa-caret-down"\n                (click)="toggle($event, buttonsOverlayPanel)"></button>\n        <p-overlayPanel #buttonsOverlayPanel [dismissable]="true" appendTo="body">\n        <span *ngFor="let btn of btns">\n          <ng-container *ngIf="btn.overlay">\n           <png-button class="ml-2" erPropsBind [props]="btn" [outputContext]="context || btn.context"></png-button>\n          </ng-container>\n        </span>\n        </p-overlayPanel>\n      </ng-container>\n    </div>\n  </ng-container>\n</div>\n'}]}],t.propDecorators={context:[{type:f.Input}],btns:[{type:f.Input}],style:[{type:f.Input}],styleClass:[{type:f.Input}]},t}(y.BaseComponent),O={dateFormat:"yy-mm-dd",hourFormat:"24",locale:{firstDayOfWeek:0,dayNames:["周日","周一","周二","周三","周四","周五","周六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["周日","周一","周二","周三","周四","周五","周六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今天",clear:"清除"},monthNavigator:!0,yearNavigator:!0,showIcon:!0,readonlyInput:!1,yearRange:"2000:2030",showButtonBar:!0},A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modelFormatter=e.formatter,e.today=x.DateUtils.getDay(),e.templateNames={header:"header",footer:"footer",date:"date"},e.$defaultProps=O,e}return b(e,t),e.prototype.formatter=function(e){if(e)return x.DateUtils.toDate(e)},e.decorators=[{type:f.Component,args:[{selector:"png-calendar",template:'\n    <p-calendar\n      [(ngModel)]="value"\n      erPropsBind\n      [props]="$props"\n      [context]="ctx"\n      [monthNavigator]="$props.monthNavigator"\n      [yearNavigator]="$props.yearNavigator"\n      [yearRange]="$props.yearRange"\n      (onBlur)="updateTouch()"\n    >\n      <p-header *ngIf="template(templateNames.header)">\n        <ng-container *ngTemplateOutlet="template(templateNames.header)"></ng-container>\n      </p-header>\n\n      <p-footer *ngIf="template(templateNames.footer)">\n        <ng-container *ngTemplateOutlet="template(templateNames.footer)"></ng-container>\n      </p-footer>\n      \n      <ng-template pTemplate="date" let-date>\n        <ng-container *ngTemplateOutlet="template(templateNames.date, dateTpl);context:{$implicit: date}"></ng-container>\n      </ng-template>\n    </p-calendar>\n\n    <ng-template #dateTpl let-date>\n      <span [ngClass]="{\'bg-red white\': (date.day === today)}"\n            style="border-radius:50%;">{{date.day}}</span>\n    </ng-template>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.ControlWrapperComponent),D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=d.ChartType.BAR,e.plugins=[],e.responsive=!0,e.switchable=!0,e.templateNames={header:"header"},e.onDataSelect=new f.EventEmitter,e.data$=new u.BehaviorSubject(undefined),e.chartTypes=[{label:"柱状图",value:d.ChartType.BAR,icon:"fa fa-bar-chart"},{label:"圆饼图",value:d.ChartType.PIE,icon:"fa fa-pie-chart"},{label:"曲线图",value:d.ChartType.LINE,icon:"fa fa-line-chart"},{label:"雷达图",value:d.ChartType.RADAR,icon:"fa fa-bar"},{label:"区域图",value:d.ChartType.AREA,icon:"fa fa-area-chart"},{label:"环形图",value:d.ChartType.DOUGHNUT,icon:"fa fa-circle"}],e}return b(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.data$.value},set:function(e){this.data$.next(e||{})},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){this.rawData=undefined,this.buildChart()},e.prototype.changeType=function(){this.buildChart()},e.prototype.reBuildChart=function(){this.rawData=undefined,this.buildChart()},e.prototype.buildChart=function(){var t=this;if(this.$id||(this.$id=x.IdUtils.getRandom()),this.rawData)this.resolvedRawData(this.rawData);else if(this.dataSource){var e=this.dataSource;if(!e.hasOwnProperty("apiDataProps")){var n=e;(e={}).apiDataProps=n}this.resolveDataSource&&(e=this.resolveDataSource.method(e)),y.ApiUtils.batchFetch(e,this.$id).subscribe(function(e){t.rawData=e,t.resolvedRawData(t.rawData)})}},e.prototype.resolvedRawData=function(o){var a=this;if(x.CommonsUtils.isEmpty(o))this.data={};else{var e=void 0,i=[],r=[];if(x.CommonsUtils.isFunction(this.dimensions))e=this.dimensions(o);else if(this.dimensions)x.CommonsUtils.getArrayValue(this.dimensions).forEach(function(e,t){a.resolveDimension&&(e=a.resolveDimension.method(e));var n=x.ChartUtils.buildChartData(o,{type:a.type,dimension:e,dataItemProps:a.dataItemProps},t);i.push.apply(i,$(n.datasets)),0===r.length&&(r=n.labels)}),e={labels:r,datasets:i};else e=x.ChartUtils.buildChartData(o,{type:this.type,dataItemProps:this.dataItemProps});this.data=e}},e.decorators=[{type:f.Component,args:[{selector:"png-chart",template:'\n    <p-panel [toggleable]="true" [showHeader]="!!caption">\n      <p-header>\n        <i [ngClass]="captionIcon || \'fa fa-bar-chart\'"></i>\n        <span [innerHTML]="caption|erSafeHtml"></span>\n        <ng-container *ngTemplateOutlet="templates[templateNames.header]"></ng-container>\n      </p-header>\n      <er-http-status class="mr-2" [tag]="$id"></er-http-status>\n      <div class="p-3" *ngIf="switchable">\n        <p-selectButton erPosition="center" [options]="chartTypes" [(ngModel)]="type" (onChange)="changeType()"></p-selectButton>\n      </div>\n      <p-chart\n        [type]="type"\n        [options]="options"\n        [data]="data$|async"\n        [plugins]="plugins"\n        [width]="width "\n        [height]="height"\n        [responsive]="responsive"\n        (onDataSelect)="onDataSelect.emit($event)"\n      >\n      </p-chart>\n    </p-panel>\n\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.propDecorators={$id:[{type:f.Input}],type:[{type:f.Input}],rawData:[{type:f.Input}],options:[{type:f.Input}],caption:[{type:f.Input}],captionIcon:[{type:f.Input}],query:[{type:f.Input}],plugins:[{type:f.Input}],width:[{type:f.Input}],height:[{type:f.Input}],responsive:[{type:f.Input}],switchable:[{type:f.Input}],dataSource:[{type:f.Input}],dataItemProps:[{type:f.Input}],dimensions:[{type:f.Input}],resolveDataSource:[{type:f.Input}],resolveDimension:[{type:f.Input}],onDataSelect:[{type:f.Output}],data:[{type:f.Input}]},e}(y.BaseComponent),k={$ext:{inline:!0}},E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueParser=e.parseValue,e.modelFormatter=e.formatModel,e.$defaultProps=k,e}return b(e,t),Object.defineProperty(e.prototype,"chkValue",{get:function(){return this._chkValue},set:function(e){var n=this;this._chkValue=e;var o=this.data$.value;if(x.CommonsUtils.isArray(o)){var a=[];e.forEach(function(t){var e=o.filter(function(e){return e[n.dataKey]===t});1===e.length&&a.push(x.DataItemUtils.getItemValue(e[0],n.valueKey))}),this.value=0<a.length?a:null}else this.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataKey",{get:function(){return x.CommonsUtils.get(this.$props,"$ext.dataItemProps.idKey","value")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueKey",{get:function(){return x.CommonsUtils.get(this.$props,"$ext.dataItemProps.valueKey","value")},enumerable:!0,configurable:!0}),e.prototype.formatModel=function(e){var t=this;if(this.$props&&!this.$props.label&&e){var n=x.CommonsUtils.getArrayValue(e);return this._chkValue=[],n.forEach(function(e){x.CommonsUtils.isJson(e)?t._chkValue.push(x.DataItemUtils.getItemValue(e,t.dataKey)):t._chkValue.push(e)}),n}return e},e.decorators=[{type:f.Component,args:[{selector:"png-check-box",template:'\n    <ng-container *ngIf="$props.label;else multiTpl">\n      <p-checkbox\n        class="m-2"\n        [(ngModel)]="value"\n        erPropsBind\n        [props]="$props"\n        [context]="ctx"\n        binary="true"\n        (onChange)="updateTouch()"\n      >\n      </p-checkbox>\n    </ng-container>\n    <ng-template #multiTpl>\n      <div class="d-flex pb-2"\n           [ngClass]="$props.$ext[\'inline\']===false?\'flex-column\':\'flex-wrap\'"\n           [erApiData]="apiDataProps"\n      >\n        <ng-container *ngFor="let option of data$|async|erDataItems:$props.$ext.dataItemProps;let i=index">\n          <span class="d-flex align-items-center">\n             <p-checkbox\n               class="m-2"\n               [(ngModel)]="chkValue"\n               [attr.index]="i"\n               erPropsBind\n               [props]="$props"\n               [context]="ctx"\n               [value]="option.data|erValue:dataKey"\n               (onChange)="updateTouch()"\n             >\n             </p-checkbox>\n             <span class="mr-4" [innerHTML]="option.label|erSafeHtml"></span>\n          </span>\n        </ng-container>\n      </div>\n    </ng-template>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.DataAwareControlWrapperComponent),M={width:300,closeOnEscape:!0,rtl:!1,closable:!0,responsive:!0,header:"操作确认",icon:"fa fa-question-circle-o text-danger",acceptLabel:"确定",acceptIcon:"fa-check text-success",acceptVisible:!0,rejectLabel:"取消",rejectIcon:"fa-close text-danger",rejectVisible:!0},U=function(o){function e(e,t){var n=o.call(this)||this;return n.confirmationService=e,n.cd=t,n.options={},n.onAccept=new f.EventEmitter,n.onReject=new f.EventEmitter,n.dlgOptions={},n}return b(e,o),e.prototype.ngOnInit=function(){var t=this;this.dlgOptions=C({},M,{header:this.header,content:this.content,acceptEvent:this.onAccept,rejectEvent:this.onReject},this.options),this.$subscriptions=x.StatesUtils.observe(d.StateNames.confirm).pipe(m.filter(function(e){return e&&e.open})).subscribe(function(e){t.open(e)})},e.prototype.open=function(e){e&&(this.dlgOptions=C({},M,e)),this.confirmationService.confirm(this.getConfirmation(this.dlgOptions)),this.cd.detectChanges()},e.prototype.getConfirmation=function(e){return{message:e.content,icon:e.icon,header:e.header,acceptVisible:e.acceptVisible,rejectVisible:e.rejectVisible,acceptLabel:e.acceptLabel,rejectLabel:e.rejectLabel,accept:this.accept.bind(this),reject:this.reject.bind(this)}},e.prototype.accept=function(){this.onAccept.emit(),this.dlgOptions.onAccept&&this.dlgOptions.onAccept.call(this.dlgOptions.context,!0),x.StatesUtils.create(d.StateNames.confirm,{open:!1,accept:!0,reject:!1})},e.prototype.reject=function(){this.onReject.emit(),this.options.onReject&&this.options.onReject.call(this.options.context,!1),x.StatesUtils.create(d.StateNames.confirm,{open:!1,accept:!1,reject:!0})},e.decorators=[{type:f.Component,args:[{selector:"png-confirm-dialog",template:'\n    <p-confirmDialog #dlg>\n      <p-footer>\n        <button type="button" class="ui-button-rounded ui-button-success" *ngIf="dlgOptions.acceptVisible" pButton icon="pi pi-check"\n                [label]="dlgOptions.acceptLabel"\n                (click)="dlg.accept()"></button>\n        <button type="button" class="ui-button-rounded ui-button-danger" *ngIf="dlgOptions.rejectVisible" pButton icon="pi pi-times"\n                [label]="dlgOptions.rejectLabel"\n                (click)="dlg.reject()"></button>\n      </p-footer>\n    </p-confirmDialog>',providers:[a.ConfirmationService],changeDetection:f.ChangeDetectionStrategy.OnPush,styles:[""]}]}],e.ctorParameters=function(){return[{type:a.ConfirmationService},{type:f.ChangeDetectorRef}]},e.propDecorators={header:[{type:f.Input}],content:[{type:f.Input}],options:[{type:f.Input}],onAccept:[{type:f.Output}],onReject:[{type:f.Output}]},e}(y.BaseComponent),R={accept:"image/*",name:"files",files:[],multiple:!1,previewWidth:50,invalidFileSizeMessageSummary:'"{0}: 文件大小无效, "',invalidFileSizeMessageDetail:'"最大上传文件大小 {0}."',invalidFileTypeMessageSummary:'"{0}: 无效的文件类型, "',invalidFileTypeMessageDetail:'"可上传的文件类型: {0}."',chooseLabel:"选择",uploadLabel:"上传",cancelLabel:"取消",$ext:{attrsName:"attrs",waterMark:"公司名称",maxSize:.5,maxHeight:200,maxWidth:300,smallSize:50,storeTo:"db"}},V=function(a){function e(e,t,n){var o=a.call(this)||this;return o.imageToolsService=e,o.sanitizer=t,o.cd=n,o.selectedFiles$=new u.BehaviorSubject([]),o.uploadedFiles=[],o.$defaultProps=R,o.showUpload=!0,o.uploadProgress$=new u.Subject,o.processing$=new u.Subject,o.fileAttrs={},o}return b(e,a),Object.defineProperty(e.prototype,"uploadValue",{get:function(){return this.value?x.CommonsUtils.getArrayValue(this.value):this.value},enumerable:!0,configurable:!0}),e.prototype.fileIcon=function(e){var t,n=(this.fileUpload.getFileExtension(e)||"").toLowerCase();switch(n=n.substring(1,4)){case"txt":t="text";break;case"xls":t="excel";break;case"doc":t="word";break;case"zip":t="zip";break;case"pdf":t="pdf";break;case"mp3":t="audio";break;case"mp4":t="video";break;default:t=0<=["txt","doc","xls",".pdf",".zip"].indexOf(n)?n:undefined}return t?"file-"+t+"-o":"file-o"},e.prototype.ngOnChanges=function(e){},e.prototype.writeValue=function(e){a.prototype.writeValue.call(this,e),this.showUpload=!(e&&this.$props&&!this.$props.multiple),this.cd.detectChanges()},e.prototype.onPropsInit=function(){a.prototype.onPropsInit.call(this),this.$props.url||(this.$props.url=""+x.ConfigUtils.getConfig().api.servers.image.uri,y.LogUtils.debug(this,"文件上传路径",this.$props.url))},e.prototype.onSelect=function(e){for(var o=this,t=e.files,n=function(e){var n=t[e];a.processing$.next(!0),a.imageToolsService.resizeImage(n,a.$props.$ext.maxWidth,a.$props.$ext.maxHeight).subscribe(function(e){o.imageToolsService.compressImage(e,o.$props.$ext.maxSize).subscribe(function(t){t.objectURL=o.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(t)),o.selectedFiles$.next(o.selectedFiles$.value.concat(t)),o.processing$.next(!1),o.fileUpload.files=o.fileUpload.files.map(function(e){return e.name===n.name?t:e})})})},a=this,i=0;i<t.length;i++)n(i)},e.prototype["delete"]=function(e,t){var n=this.selectedFiles$.value;n.splice(t,1),this.selectedFiles$.next(n),this.fileUpload.remove(e,t)},e.prototype.remove=function(t){var n=this;this.$subscriptions=y.HttpUtils.request({uri:x.ConfigUtils.getConfig().api.servers.image.uri+"/"+t,method:d.HttpMethod.DELETE}).subscribe(function(e){e&&e.success&&(n.$props.multiple?n.value=n.value.filter(function(e){return e!==t}):n.value=undefined,n.showUpload=!0,n.cd.detectChanges())})},e.prototype.setFileAttr=function(e,t){this.fileAttrs[t.name]=e.target.value},e.prototype.onBeforeSend=function(e){var t=this,n=e.formData;n.append(this.$props.$ext.attrsName,"waterMark="+this.$props.$ext.waterMark),n.append(this.$props.$ext.attrsName,"smallSize="+this.$props.$ext.smallSize),n.append(this.$props.$ext.attrsName,"storeTo="+this.$props.$ext.storeTo),x.CommonsUtils.isEmpty(this.fileAttrs)||Object.keys(this.fileAttrs).forEach(function(e){n.append(t.$props.$ext.attrsName,e+"="+t.fileAttrs[e])})},e.prototype.onProgress=function(e){this.uploadProgress$.next(e.progress)},e.prototype.onUploadSuccess=function(e){var t,n;try{for(var o=function s(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(e.files),a=o.next();!a.done;a=o.next()){var i=a.value;this.uploadedFiles.push(i)}}catch(l){t={error:l}}finally{try{a&&!a.done&&(n=o["return"])&&n.call(o)}finally{if(t)throw t.error}}var r=JSON.parse(e.xhr.responseText);r.success&&(x.StatesUtils.create(d.StateNames.notify,{message:"文件上传成功",title:"提示"}),this.$props.multiple?this.value=$(this.value||[],Object.keys(r.content).map(function(e){return r.content[e]})):(this.value=Object.keys(r.content).map(function(e){return r.content[e]})[0],this.showUpload=!1),this.fileAttrs={},this.selectedFiles$.next([]),this.uploadProgress$.next(undefined),this.cd.detectChanges())},e.prototype.onUploadFailed=function(e){var t=JSON.parse(e.xhr.responseText);x.StatesUtils.create(d.StateNames.notify,{level:d.NotifyLevel.ERROR,message:t.message,title:"文件上传失败"}),this.uploadProgress$.next(undefined)},e.decorators=[{type:f.Component,args:[{selector:"png-file-upload",template:'\n    <ng-container *ngIf="showUpload">\n      <p-fileUpload\n        #fileUpload\n        erPropsBind\n        [props]="$props || {}"\n        [context]="ctx"\n        (onSelect)="onSelect($event)"\n        (onUpload)="onUploadSuccess($event)"\n        (onError)="onUploadFailed($event)"\n        (onProgress)="onProgress($event)"\n        (onBeforeSend)="onBeforeSend($event)"\n      >\n        <ng-template pTemplate="toolbar">\n          <div *ngIf="uploadProgress$|async as uploadProgress">\n            <p-progressBar [value]="uploadProgress"></p-progressBar>\n          </div>\n        </ng-template>\n        <ng-template pTemplate="file"></ng-template>\n        <ng-template pTemplate="content">\n          <span class="text-muted small" *ngIf="!fileUpload.hasFiles()">您也可以拖动文件到这里</span>\n        </ng-template>\n      </p-fileUpload>\n      <div *ngIf="processing$|async"><i class="fa fa-spin fa-gears"></i>正在处理图片</div>\n      <div class="ui-fileupload-row" *ngFor="let file of selectedFiles$|async; let i = index">\n      <div>\n        <span class="badge badge-info">{{i + 1}}</span>\n      </div>\n      <div>\n        <png-image *ngIf="fileUpload.isImage(file)"\n                   [src]="file[\'objectURL\']" [imageStyle]="{width: $props.previewWidth + \'px\'}">\n        </png-image>\n        <span *ngIf="!fileUpload.isImage(file)" class="fa fa-2x text-primary fa-{{fileIcon(file)}}"></span>\n      </div>\n      <div>{{file.name}}</div>\n      <div>{{fileUpload.formatSize(file.size)}}<span class="text-danger">(压缩后)</span></div>\n      <div>\n        <input pInputText placeholder="图片描述信息" size="50" (change)="setFileAttr($event,file)"/>\n      </div>\n      <div>\n        <button type="button" icon="pi pi-times white" pButton (click)="delete($event,i)"></button>\n      </div>\n    </div>\n    </ng-container>\n\n    <div *ngIf="uploadValue && uploadValue.length>0">\n      <div style="text-decoration: underline;font-weight: bold">已上传文件：</div>\n      <div class="ui-fileupload-row" *ngFor="let fileId of uploadValue">\n        <div>\n          <png-image [fileId]="fileId" size="small"\n                     styleClass="d-flex align-items-center"\n                     imageStyleClass="mr-3"\n                     [imageStyle]="{width:$props.previewWidth}">\n          </png-image>\n        </div>\n        <div>\n          <button type="button" icon="pi pi-times white" pButton (click)="remove(fileId)"></button>\n        </div>\n      </div>\n    </div>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[{type:t.ImageToolsService},{type:n.DomSanitizer},{type:f.ChangeDetectorRef}]},e.propDecorators={maxSize:[{type:f.Input}],fileUpload:[{type:f.ViewChild,args:["fileUpload"]}]},e}(y.ControlWrapperComponent),N=function(o){function e(e,t){var n=o.call(this)||this;return n.cd=e,n.sanitizer=t,n.imageViewStyle={"max-height":"300px","max-width":"500px",overflow:"auto"},n.showDescription=!0,n.descriptionChange=new f.EventEmitter,n}return b(e,o),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},set:function(e){this._description=e,this.descriptionChange.emit(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){var o,a=this;if(e.src&&(x.CommonsUtils.isArray(this.src)?1===this.src.length?(this.images=undefined,this.image=this.src[0],this.fullImage=this.src[0]):(this.images=[],this.image=this.src[0],this.fullImage=this.src[0],this.src.forEach(function(e){x.CommonsUtils.isString(e)?a.images.push({source:e}):a.images.push(e)})):(this.images=undefined,this.image=this.src,this.fullImage=this.src)),e.fileId)if(this.fileId){if(x.CommonsUtils.isArray(this.fileId)){if(0===this.fileId.length)return this.images=undefined,void(this.image=null);o=this.fileId[0]}else o=this.fileId;y.HttpUtils.request({uri:x.ConfigUtils.getConfig().api.servers.image.uri+"/"+o+(this.size?"?"+this.size:""),observe:"events",responseType:d.HttpResponseType.BLOB}).subscribe(function(e){var t=a.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(e.body));a.images=undefined,a.image=t,a.fullImage=x.ConfigUtils.getConfig().api.servers.image.uri+"/"+o;var n=e.headers.getAll("description");n&&0<n.length&&(a.description=n[0]),a.cd.detectChanges()})}else this.images=undefined,this.image=null},e.prototype.viewImage=function(){this.images?(this.imageViewer.show(),this.imageViewer.center()):this.image&&x.DialogUtils.info("图片预览",this.imageViewTpl,{})},e.decorators=[{type:f.Component,args:[{selector:"png-image",template:'\n    <div [ngClass]="styleClass" [ngStyle]="style">\n      <img *ngIf="image"\n           style="margin: 5px"\n           [src]="image"\n           [ngClass]="imageStyleClass"\n           [ngStyle]="imageStyle"\n           [title]="description || \'\'"\n           (click)="viewImage()"/>\n      <div *ngIf="showDescription" [ngClass]="descriptionStyleClass" [ngStyle]="descriptionStyle">\n        {{description}}\n      </div>\n    </div>\n    <ng-template #imageView>\n      <img [src]="fullImage" [ngStyle]="imageViewStyle" [ngClass]="imageViewStyleClass"/>\n    </ng-template>\n    <ng-template #imagesView>\n      <p-lightbox [images]="images" [styleClass]="boxStyleClass" [style]="boxStyle"></p-lightbox>\n    </ng-template>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:f.ChangeDetectorRef},{type:n.DomSanitizer}]},e.propDecorators={src:[{type:f.Input}],styleClass:[{type:f.Input}],style:[{type:f.Input}],imageStyleClass:[{type:f.Input}],imageStyle:[{type:f.Input}],descriptionStyleClass:[{type:f.Input}],descriptionStyle:[{type:f.Input}],boxStyleClass:[{type:f.Input}],boxStyle:[{type:f.Input}],imageViewStyleClass:[{type:f.Input}],imageViewStyle:[{type:f.Input}],showDescription:[{type:f.Input}],size:[{type:f.Input}],fileId:[{type:f.Input}],imageViewTpl:[{type:f.ViewChild,args:["imageView"]}],imageViewer:[{type:f.ViewChild,args:["imagesView"]}],descriptionChange:[{type:f.Output}]},e}(y.BaseComponent),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.decorators=[{type:f.Component,args:[{selector:"png-input",template:'\n    <div class="ui-inputgroup">\n      <ng-container *ngIf="attrs?.$ext?.preIcon || attrs?.$ext?.preText">\n        <span class="ui-inputgroup-addon"><i [ngClass]="attrs?.$ext?.preIcon"></i>{{attrs?.$ext?.preText}}</span>\n      </ng-container>\n      <png-buttons *ngIf="attrs?.$ext?.preButtons" [btns]="attrs.$ext.preButtons" [context]="ctx"></png-buttons>\n      <ng-container *ngIf="attrs?.$ext?.floatLabel;else inputTpl">\n       <span class="ui-float-label">\n         <ng-container *ngTemplateOutlet="inputTpl"></ng-container>\n         <label style="font-weight: bold;">{{attrs?.$ext.label}}</label>\n       </span>\n      </ng-container>\n      <ng-template #inputTpl>\n        <span class="w-100 inner-addon">\n          <input pInputText\n                 [(ngModel)]="value"\n                 type="{{attrs?.type || \'text\'}}"\n                 erPropsBind\n                 [attrs]="attrs"\n                 [context]="ctx"\n                 [pKeyFilter]="attrs?.$ext?.inputRule || \'alphanum\'"\n                 (blur)="updateTouch()"/>\n          <i *ngIf="value && !disabled && resettable" title="清除输入内容" class="fa fa-trash gray right" (click)="reset()"></i>\n       </span>\n      </ng-template>\n      <ng-container *ngIf="attrs?.$ext?.postIcon || attrs?.$ext?.postText">\n        <span class="ui-inputgroup-addon"><i [ngClass]="attrs?.$ext?.postIcon"></i>{{attrs?.$ext?.postText}}</span>\n      </ng-container>\n      <png-buttons *ngIf="attrs?.$ext?.postButtons" [btns]="attrs.$ext.postButtons" [context]="ctx"></png-buttons>\n    </div>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return t}),multi:!0}],styles:["\n    .ui-float-label {\n      width: 100%\n    }\n\n    .ui-float-label > label {\n      font-size: 1em;\n      color: inherit\n    }\n  "]}]}],t.propDecorators={attrs:[{type:f.Input}]},t}(y.ControlWrapperComponent),B={optionLabel:"label",checkbox:!0,multiple:!0,showToggleAll:!0,$ext:{dataItemProps:{itemStyleClass:"d-inline-flex ml-2"}}},F=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateNames={header:"header",footer:"footer",item:"item"},e.$defaultProps=B,e}return b(e,t),e.decorators=[{type:f.Component,args:[{selector:"png-list-box",template:'\n    <p-listbox\n      [(ngModel)]="value"\n      erPropsBind\n      [props]="$props"\n      [context]="ctx"\n      [erApiData]="apiDataProps"\n      [options]="data$|async"\n      (onChange)="updateTouch()"\n    >\n      <p-header *ngIf="template(templateNames.header)">\n        <ng-container *ngTemplateOutlet="template(templateNames.header)"></ng-container>\n      </p-header>\n\n      <p-header *ngIf="header">\n        <div [innerHTML]="header"></div>\n      </p-header>\n\n      <p-footer *ngIf="template(templateNames.footer)">\n        <ng-container *ngTemplateOutlet="template(templateNames.footer)"></ng-container>\n      </p-footer>\n\n      <p-footer *ngIf="$props.$ext[\'showValue\'] || footer">\n        <ng-container *ngIf="$props.$ext[\'showValue\']">\n          选中值：{{value | erValue: $props.$ext[\'field\']}}\n        </ng-container>\n        <ng-container *ngIf="footer">\n          <div [innerHTML]="footer"></div>\n        </ng-container>\n      </p-footer>\n\n      <ng-template let-item let-i="index" pTemplate="item">\n        <er-data-item [customerTpl]="template(templateNames.item)"\n                      [item]="item.value"\n                      [props]="$props.$ext.dataItemProps">\n        </er-data-item>\n      </ng-template>\n    </p-listbox>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e.propDecorators={header:[{type:f.Input}],footer:[{type:f.Input}]},e}(y.DataAwareControlWrapperComponent),H={defaultLabel:"请选择",selectedItemsLabel:"选中{0} 项",filter:!1,showToggleAll:!0,$ext:{dataItemProps:{itemStyleClass:"d-inline-flex ml-2"}}},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$defaultProps=H,e}return b(e,t),e.decorators=[{type:f.Component,args:[{selector:"png-multi-select",template:'\n    <p-multiSelect\n      [(ngModel)]="value"\n      erPropsBind\n      [props]="$props"\n      [context]="ctx"\n      [erApiData]="apiDataProps"\n      [options]="data$|async|erDataItems:$props.$ext.dataItemProps"\n      (onBlur)="updateTouch()"\n    >\n      <ng-template let-item pTemplate="item">\n        <er-data-item [customerTpl]="template(\'_\')"\n                         [item]="item.data"\n                         [props]="$props.$ext.dataItemProps">\n        </er-data-item>\n      </ng-template>\n    </p-multiSelect>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.DataAwareControlWrapperComponent),q={animation:!0,duration:3e3,immutable:!0,closable:!0,autoZIndex:!0,position:d.UiPosition.rightTop},z=function(o){function e(e,t){var n=o.call(this)||this;return n.messageService=e,n.cd=t,n.alert=C({},q,x.ConfigUtils.getConfig().alert||{}),n.defaultNotifyType=x.ConfigUtils.getConfig().notify||d.NotifyType.ALERT,n}return b(e,o),e.prototype.ngOnInit=function(){var n=this;this.$subscriptions=x.StatesUtils.observe(d.StateNames.notify).pipe(m.filter(function(e){return e&&e.message}),m.filter(function(e){return e.type===d.NotifyType.ALERT||!e.type&&n.defaultNotifyType===d.NotifyType.ALERT})).subscribe(function(e){var t=n.getNotifyModel(e);n.messageService.add(t),n.cd.detectChanges()})},e.prototype.getNotifyModel=function(e){return{key:e.key,severity:e.level||d.NotifyLevel.INFO,summary:e.title,detail:e.message,sticky:e.sticky||!1,life:e.duration||e.level===d.NotifyLevel.ERROR?2*q.duration:q.duration,closable:e.closable||!0,data:e.data}},e.decorators=[{type:f.Component,args:[{selector:"png-alert",template:'\n    <p-toast [styleClass]="alert.styleClass"\n             [style]="alert.style"\n             [position]="alert.position"\n             [autoZIndex]="alert.autoZIndex"\n    ></p-toast>\n  ',providers:[a.MessageService],changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:a.MessageService},{type:f.ChangeDetectorRef}]},e}(y.BaseComponent),K={level:d.NotifyLevel.INFO,animation:!0,closable:!0,baseZIndex:2e3},j=function(o){function e(e,t){var n=o.call(this)||this;return n.messageService=e,n.cd=t,n.announce=C({},K,x.ConfigUtils.getConfig().announce||{}),n.defaultNotifyType=x.ConfigUtils.getConfig().notify,n}return b(e,o),e.prototype.ngOnInit=function(){var n=this;this.$subscriptions=x.StatesUtils.observe(d.StateNames.notify).pipe(m.filter(function(e){return e&&e.message}),m.filter(function(e){return e.type===d.NotifyType.ANNOUNCE||!e.type&&n.defaultNotifyType===d.NotifyType.ANNOUNCE})).subscribe(function(e){var t=n.getNotifyModel(e);n.messageService.add(t),n.cd.detectChanges()})},e.prototype.getNotifyModel=function(e){return{key:e.key,severity:e.level||d.NotifyLevel.INFO,summary:e.title,detail:e.message,closable:e.closable,data:e.data}},e.decorators=[{type:f.Component,args:[{selector:"png-announce",template:'\n    <p-messages [styleClass]="announce.styleClass"\n                [style]="announce.style"\n                [closable]="announce.closable"\n    ></p-messages>\n  ',providers:[a.MessageService],changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:a.MessageService},{type:f.ChangeDetectorRef}]},e}(y.BaseComponent),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),Object.defineProperty(t.prototype,"labels",{get:function(){var e=x.DataItemUtils.getItemLabel(this.item,this.props.dropDownOptionKey||this.props.labelKey||"label");return x.CommonsUtils.isArray(e)?e:[e]},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.props||(this.props={})},t.decorators=[{type:f.Component,args:[{selector:"png-option-item",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:{$implicit:item}"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <div class="d-flex option-item" [ngClass]="props.itemStyleClass || \'ui-helper-clearfix\'">\n          <span class="label mr-3" *ngFor="let label of labels" [ngClass]="props.labelStyleClass" [innerHTML]="label"></span>\n          <span class="pull-right count" *ngIf="props.showCounter && item[\'count\']">\n          <span [ngClass]="props.counterStyleClass || \'badge badge-pill badge-info\'">{{item[\'count\']}}</span>\n        </span>\n      </div>\n    </ng-template>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush,styles:[".option-item{border-bottom:1px solid #d5d5d5;font-size:.8em}.option-item:hover{font-weight:700;font-size:1em}"]}]}],t.propDecorators={item:[{type:f.Input}],props:[{type:f.Input}]},t}(y.BaseComponent),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t.prototype.show=function(e){this.panel.show(e)},t.prototype.toggle=function(e){this.panel.toggle(e)},t.prototype.hide=function(){this.panel.hide()},t.decorators=[{type:f.Component,args:[{selector:"png-overlay-panel",template:'<p-overlayPanel #overlayPanel [showCloseIcon]="true" [dismissable]="false">\n   <er-dyna-content [content]="content" [context]="context"></er-dyna-content>\n</p-overlayPanel>\n',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],t.propDecorators={content:[{type:f.Input}],context:[{type:f.Input}],panel:[{type:f.ViewChild,args:[l.OverlayPanel]}]},t}(y.BaseComponent),Q=function(o){function e(){var e=null!==o&&o.apply(this,arguments)||this;return e.collapsed=!1,e.toggleable=!1,e.showHeader=!0,e.templateNames={header:"header",footer:"footer"},e}return b(e,o),e.prototype.ngAfterViewInit=function(){var t=this;o.prototype.ngAfterViewInit.call(this);var n=this.panelEle.nativeElement.querySelector(".ui-panel-titlebar");n&&(this.barStyleClass&&x.DomUtils.addClasses(n,this.barStyleClass),this.barStyle&&Object.keys(this.barStyle).forEach(function(e){y.DiUtils.get(f.Renderer2).setStyle(n,e,t.barStyle[e])}))},e.decorators=[{type:f.Component,args:[{selector:"png-panel",template:'<div class="ui-g">\n  <div class="ui-g-12">\n    <p-panel #pngPanel [styleClass]="styleClass" [style]="style" [toggleable]="toggleable" [showHeader]="showHeader"\n             [collapsed]="collapsed">\n      <p-header>\n        <ng-container *ngIf="header">\n          <i *ngIf="icon" [class]="icon"></i>\n          <er-dyna-content [content]="header" class="d-inline-block"></er-dyna-content>\n        </ng-container>\n        <ng-container *ngIf="template(templateNames.header)">\n          <ng-container *ngTemplateOutlet="template(templateNames.header)"></ng-container>\n        </ng-container>\n      </p-header>\n      <ng-content></ng-content>\n      <ng-container *ngIf="footer || template(templateNames.footer)">\n        <p-footer>\n          <ng-container *ngIf="footer">\n            <er-dyna-content [content]="footer"></er-dyna-content>\n          </ng-container>\n          <ng-container *ngIf="template(templateNames.footer)">\n            <ng-container *ngTemplateOutlet="template(templateNames.footer)"></ng-container>\n          </ng-container>\n        </p-footer>\n      </ng-container>\n    </p-panel>\n  </div>\n</div>\n\n',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.propDecorators={barStyle:[{type:f.Input}],barStyleClass:[{type:f.Input}],style:[{type:f.Input}],styleClass:[{type:f.Input}],header:[{type:f.Input}],footer:[{type:f.Input}],icon:[{type:f.Input}],collapsed:[{type:f.Input}],toggleable:[{type:f.Input}],showHeader:[{type:f.Input}],panelEle:[{type:f.ViewChild,args:["pngPanel",{read:f.ElementRef}]}]},e}(y.BaseComponent),G={draggable:!0,minHeight:100,minWidth:140,resizable:!0,modal:!0,closeOnEscape:!0,dismissableMask:!1,rtl:!1,closable:!0,responsive:!0,maximizable:!0,blockScroll:!0,breakpoint:640,showHeader:!0,showFooter:!0,baseZIndex:2e3,autoZIndex:!0,closeLabel:"关闭",closeIcon:"fa fa-close"},Z=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.onClose=new f.EventEmitter,e.onAction=new f.EventEmitter,e.templateNames={header:"header",content:"content",footer:"footer"},e}return b(e,n),Object.defineProperty(e.prototype,"options",{set:function(e){this.dlgOptions$=u.of(this.resolveDlgOptions(e))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var t=this;this.dlgOptions$=x.StatesUtils.observe(d.StateNames.popup).pipe(m.filter(function(e){return!!e}),m.map(function(e){return t.resolveDlgOptions(e)}),m.takeUntil(this.destroyed$))},e.prototype.resolveDlgOptions=function(e){var t=C({},G,{header:this.header,content:this.content},e);return(e.contentMaxHeight||e.contentMaxWidth)&&(t.contentStyle=C({},t.contentStyle||{},{"max-height":(e.contentMaxHeight||3e3)+"px","max-width":(e.contentMaxWidth||3e3)+"px"})),t},e.prototype.showEvent=function(e,t){n.prototype.emitEvent.call(this,"onShow",{scope:t,event:e,context:t.context})},e.prototype.closeDlg=function(e,t){this.canClose&&!this.canClose({scope:t,event:e,context:t.context})||x.StatesUtils.create(d.StateNames.popup,{visible:!1})},e.decorators=[{type:f.Component,args:[{selector:"png-popup-dialog",template:'<ng-container *ngIf="dlgOptions$|async as dlgOptions">\n  <p-dialog #pngDialog\n            [(visible)]="dlgOptions.visible"\n            [minWidth]="dlgOptions.minWidth"\n            [minHeight]="dlgOptions.minHeight"\n            [width]="dlgOptions.width"\n            [height]="dlgOptions.height"\n            [modal]="dlgOptions.modal"\n            [draggable]="dlgOptions.draggable"\n            [resizable]="dlgOptions.resizable"\n            [closeOnEscape]="dlgOptions.closeOnEscape"\n            [contentStyle]="dlgOptions.contentStyle"\n            [dismissableMask]="dlgOptions.dismissableMask"\n            [rtl]="dlgOptions.rtl"\n            [closable]="dlgOptions.closable"\n            [responsive]="dlgOptions.responsive"\n            [breakpoint]="dlgOptions.breakpoint"\n            [appendTo]="dlgOptions.appendTo"\n            [maximizable]="dlgOptions.maximizable"\n            [blockScroll]="dlgOptions.blockScroll"\n            [style]="dlgOptions.style"\n            [styleClass]="dlgOptions.styleClass"\n            [showHeader]="dlgOptions.showHeader"\n            [positionLeft]="dlgOptions.positionLeft"\n            [positionTop]="dlgOptions.positionTop"\n            (onShow)="showEvent(pngDialog,dlgOptions)"\n  >\n    <p-header>\n      <ng-container *ngIf="templates[templateNames.header]">\n        <ng-container *ngTemplateOutlet="templates[templateNames.header]"></ng-container>\n      </ng-container>\n      <span [innerHTML]="dlgOptions.header"></span>\n    </p-header>\n\n    <ng-container *ngTemplateOutlet="templates[templateNames.content]"></ng-container>\n\n    <ng-container *ngIf="dlgOptions.content">\n      <er-dyna-content [content]="dlgOptions.content"></er-dyna-content>\n    </ng-container>\n\n    <ng-content></ng-content>\n\n    <p-footer *ngIf="dlgOptions.showFooter">\n      <ng-container *ngIf="templates[templateNames.footer]">\n        <ng-container *ngTemplateOutlet="templates[templateNames.footer]"></ng-container>\n      </ng-container>\n      <ng-container *ngIf="!templates[templateNames.footer]">\n        <png-buttons [btns]="dlgOptions.buttons" [context]="dlgOptions.context"></png-buttons>\n        <button pButton type="button" class="ui-button-rounded ui-button-danger" iconPos="left"\n                (click)="closeDlg(pngDialog,dlgOptions)"\n                [icon]="dlgOptions.closeIcon" [label]="dlgOptions.closeLabel"></button>\n      </ng-container>\n    </p-footer>\n  </p-dialog>\n</ng-container>\n\n\n\n\n',changeDetection:f.ChangeDetectionStrategy.OnPush,styles:[":host::ng-deep .ui-dialog-titlebar{background-color:#0d7a8b!important;color:#fff!important}"]}]}],e.propDecorators={header:[{type:f.Input}],content:[{type:f.Input}],canClose:[{type:f.Input}],onClose:[{type:f.Output}],onAction:[{type:f.Output}],options:[{type:f.Input}]},e}(y.BaseComponent),J={$ext:{inline:!1}},X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueParser=e.parseValue,e.modelFormatter=e.formatModel,e.$defaultProps=J,e}return b(e,t),Object.defineProperty(e.prototype,"rbValue",{get:function(){return this._rbValue},set:function(t){var n=this;this._rbValue=t;var e=this.data$.value;if(x.CommonsUtils.isArray(e)){var o=e.filter(function(e){return e[n.dataKey]===t});1===o.length?this.value=x.DataItemUtils.getItemValue(o[0],this.valueKey):this.value=null}else this.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataKey",{get:function(){return x.CommonsUtils.get(this.$props,"$ext.dataItemProps.idKey","value")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueKey",{get:function(){return x.CommonsUtils.get(this.$props,"$ext.dataItemProps.valueKey","value")},enumerable:!0,configurable:!0}),e.prototype.formatModel=function(e){return x.CommonsUtils.isJson(e)&&(this._rbValue=x.DataItemUtils.getItemValue(e,this.dataKey)),e},e.decorators=[{type:f.Component,args:[{selector:"png-radio",template:'\n    <div class="d-flex pb-2" [erApiData]="apiDataProps" [ngClass]="$props.$ext[\'inline\']===false?\'flex-column\':\'flex-wrap\'">\n      <ng-container *ngFor="let option of data$|async|erDataItems:$props.$ext.dataItemProps;let i=index">\n       <span class="d-flex align-items-center">\n        <p-radioButton\n          class="m-2"\n          [(ngModel)]="rbValue"\n          erPropsBind\n          [props]="$props"\n          [context]="ctx"\n          [inputId]="i"\n          [value]="option.data|erValue:dataKey"\n          (onClick)="updateTouch()"\n        >\n        </p-radioButton>\n        <span class="mr-4" [innerHTML]="option.label|erSafeHtml"></span>\n       </span>\n      </ng-container>\n    </div>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.DataAwareControlWrapperComponent),ee={stars:5,iconOnClass:"fa fa-star fa-2x",iconOffClass:"fa fa-star-o fa-2x",iconCancelClass:"fa fa-ban fa-2x red"},te=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$defaultProps=ee,e}return b(e,t),e.decorators=[{type:f.Component,args:[{selector:"png-rating",template:'\n    <p-rating\n      [(ngModel)]="value"\n      erPropsBind\n      [props]="$props"\n      [context]="ctx"\n      (onRate)="updateTouch()"\n    >\n    </p-rating>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.DataAwareControlWrapperComponent),ne=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.searched=!1,e.title="按关键字搜索,输入回车键执行",e.onSearch=new f.EventEmitter,e.onSearchChange=new f.EventEmitter,e}return b(e,t),e.prototype.search=function(){this.searched=!0,this.onSearch.emit(this.searchKey)},e.prototype.keyChange=function(){this.searchKey&&0!==this.searchKey.length||this.clearSearch(),this.onSearchChange.emit(this.searchKey)},e.prototype.clearSearch=function(){this.searchKey=undefined,this.searched&&this.onSearch.emit(undefined),this.searched=!1},e.prototype.showHelp=function(){x.DialogUtils.info("查询操作符",'\n    <div class="ml-3">\n       <div><b class="font-weight-bold">+</b> 并且</div>\n       <div><b class="font-weight-bold">|</b> 或者</div>\n       <div><b class="font-weight-bold">-</b> 排除</div>\n       <div><b class="font-weight-bold">*</b> 开头</div>\n       <div><b class="font-weight-bold">( )</b> 优先</div>\n    </div>\n    ')},e.decorators=[{type:f.Component,args:[{selector:"png-search-box",template:'\n    <span class="inner-addon" [ngClass]="styleClass" [ngStyle]="style">\n      <i class="fa fa-search text-primary left"></i>\n      <input [title]="title" pInputText placeholder="输入搜索关键字或拼音" [(ngModel)]="searchKey" (keydown.enter)="search()" (keyup)="keyChange()"/>\n      <i *ngIf="searchKey" class="fa fa-trash gray right" [title]="title" (click)="clearSearch()"></i>\n   </span>\n    <span class="position-container"><i title="多值查询帮助" class="fa fa-question-circle green position-absolute" style="right:2px"\n                                        (click)="showHelp()"></i></span>\n\n  '}]}],e.propDecorators={styleClass:[{type:f.Input}],style:[{type:f.Input}],title:[{type:f.Input}],onSearch:[{type:f.Output}],onSearchChange:[{type:f.Output}]},e}(y.BaseComponent),oe={multiple:!1},ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$defaultProps=oe,e.templateNames={item:"item"},e}return b(e,t),e.decorators=[{type:f.Component,args:[{selector:"png-select-button",template:'\n    <p-selectButton\n      [(ngModel)]="value"\n      erPropsBind\n      [props]="$props"\n      [context]="ctx"\n      [erApiData]="apiDataProps"\n      [options]="data$|async|erDataItems:$props.$ext.dataItemProps"\n      (onOptionClick)="updateTouch()"\n    >\n      <ng-template let-item>\n        <er-data-item [customerTpl]="template(templateNames.item)"\n                      [item]="item.data"\n                      [props]="$props.$ext.dataItemProps">\n        </er-data-item>\n      </ng-template>  \n    </p-selectButton>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.DataAwareControlWrapperComponent),ie={autoWidth:!1,placeholder:"请选择",showClear:!0,editable:!1,$ext:{}},re=function(n){function e(e){var t=n.call(this)||this;return t.cd=e,t.$defaultProps=ie,t.templateNames={group:"group",item:"item"},t}return b(e,n),e.prototype.onPropsInit=function(){n.prototype.onPropsInit.call(this),!this.$props.group&&this.$props.$ext&&this.$props.$ext.dataItemProps&&this.$props.$ext.dataItemProps.groupKey&&(this.$props.group=!0)},e.decorators=[{type:f.Component,args:[{selector:"png-select",template:'\n    <p-dropdown\n      [(ngModel)]="value"\n      erPropsBind\n      [props]="$props"\n      [context]="ctx"\n      [erApiData]="apiDataProps"\n      [options]="data$|async|erDataItems:$props?.$ext?.dataItemProps"\n      (onBlur)="updateTouch()"\n    >\n      <ng-template let-group pTemplate="group">\n        <ng-container *ngTemplateOutlet="template(templateNames.group,groupTpl);context:{$implicit:group}"></ng-container>\n      </ng-template>\n      <ng-template let-group #groupTpl>\n        <span *ngIf="group" style="font-size: 1em"><i class="fa fa-group text-primary"></i> {{group.label}}</span>\n      </ng-template>\n      <ng-template let-item pTemplate="item">\n        <er-data-item [customerTpl]="template(templateNames.item)"\n                      [item]="item.data"\n                      [props]="$props.$ext.dataItemProps">\n        </er-data-item>\n      </ng-template>\n    </p-dropdown>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}],styles:["/deep/ .ui-dropdown-item{border-bottom:1px solid #a8a8a8!important;font-size:.8em;color:#000!important}/deep/ .ui-dropdown-item:hover{background-color:transparent!important;font-weight:700;color:red!important;font-size:1em}"]}]}],e.ctorParameters=function(){return[{type:f.ChangeDetectorRef}]},e.propDecorators={dropDown:[{type:f.ViewChild,args:[l.Dropdown]}]},e}(y.DataAwareControlWrapperComponent),se={min:0,max:100,range:!1,orientation:"horizontal"},le=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$defaultProps=se,e}return b(e,t),Object.defineProperty(e.prototype,"current",{get:function(){return x.CommonsUtils.join(this.value,"——")},enumerable:!0,configurable:!0}),e.prototype.initValue=function(e){e.hasOwnProperty("min")&&e.hasOwnProperty("max")?(this.min=e.min,this.max=e.max,this.value=[e.min,e.max]):this.value=e},e.decorators=[{type:f.Component,args:[{selector:"png-slider",template:'\n    <small class="d-inline w-25">值：{{current}}</small>\n    <p-slider class="d-inline"\n              [erApiData]="apiDataProps"\n              [(ngModel)]="value"\n              erPropsBind\n              [props]="$props"\n              [min]="min"\n              [max]="max"\n              (onChange)="updateTouch()"\n              (onDataReady)="initValue($event)"\n    >\n    </p-slider>\n\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}]}]}],e}(y.DataAwareControlWrapperComponent),pe={cellStyleClass:"text-right",sortable:!0,filterable:!0,aggable:!0,width:"150px"},ce={value:[],tableStyleClass:"rounded shadow",dataKey:"id",alwaysShowPaginator:!0,autoLayout:!0,columnResizeMode:"expand",compareSelectionBy:"equals",defaultSortOrder:1,resizableColumns:!0,reorderableColumns:!0,responsive:!0,filterDelay:300,filters:{},rowHover:!0,loadingIcon:"fa fa-spin fa-2x fa-circle-o-notch",lazy:!0,lazyLoadOnInit:!1,rows:10,pageLinks:5,rowsPerPageOptions:[10,30,50],paginator:!0,paginatorPosition:"both",rowExpandMode:"multiple",sortMode:"single",sortOrder:1,$ext:{emptyMessage:"没有显示内容",hasColumnSelector:!0,columnSelectorStyleClass:"d-inline-block align-middle pull-right",rowHeight:"30px",rowActionsPlaceAhead:!1,frozenActionColumn:!1,hasSearchInput:!0,hasSearchBox:!1,hasRowIndex:!1,hasRowCheckbox:!1,hasHeaderSummary:!1,hasPaginatorLeft:!0,hasPaginatorRight:!1,rowExpandable:!1,hasAddAction:!1,hasDeleteAction:!1,hasAuditAction:!1,hasDownloadAction:!1,routerOutlet:"aux",addRouter:"add",viewRouter:"view",editRouter:"edit",auditRouter:"audit",downloadRouter:"download"}},ue={label:"行号",width:"50px",cellClass:"text-right",sortable:!1,filterable:!1,aggable:!1,order:-100,isDataColumn:!1,cellContent:function(e){return e.rowIndex+1}},ge={label:"操作",width:"150px",cellStyleClass:"text-left",sortable:!1,filterable:!1,aggable:!1,dataAttr:d.DataAttr.BUTTONS,isActionColumn:!0,cellContent:[]},de={$id:"add",title:"新建一条信息",label:"新建",icon:"fa fa-plus",styleClass:"ui-button-rounded ui-button-success",onClick:function(e){e.pngTable.navigate(e.pngTable.$props.$ext.addRouter,[],{tableId:e.pngTable.$id})}},me={$id:"view",title:"查看",icon:"fa fa-edit",styleClass:"ui-button-rounded ui-button-info",onClick:function(e){e.pngTable.navigate(e.pngTable.$props.$ext.viewRouter,[e.row.id])}},he={$id:"edit",title:"修改",icon:"fa fa-edit",styleClass:"ui-button-rounded ui-button-warning",onClick:function(e){e.pngTable.navigate(e.pngTable.$props.$ext.editRouter,[e.row.id],{tableId:e.pngTable.$id})}},fe={$id:"delete",title:"删除",icon:"fa fa-trash",styleClass:"ui-button-rounded ui-button-danger",onClick:function(e){y.ApiUtils.deleteById(e.pngTable.$props.$ext.apiDataProps.apiEntry,e.row.id).subscribe(function(){e.pngTable.load(),x.StatesUtils.update(e.pngTable.$props.$id,{deleted:e.row.id})})}},ye={$id:"audit",title:"审核",icon:"fa fa-check",styleClass:"ui-button-rounded ui-button-success",onClick:function(e){e.pngTable.navigate(e.pngTable.$props.$ext.auditRouter,[e.row.id],{action:"audit",tableId:e.pngTable.$id})}},xe={$id:"download",title:"下载",icon:"fa fa-download",overlay:!0,styleClass:"ui-button-rounded ui-button-success",onClick:function(e){e.pngTable.navigate(e.pngTable.$props.$ext.downloadRouter,[e.row.id])}},ve=function(){function e(){}return e.resolveColumnByDataField=function(e){if(e.dataField){e.dataField=x.CommonsUtils.merge(y.DataFieldUtils.getFieldDefaultProps(e.dataField),e.dataField);var t=e.dataField,n=t.key,o=t.label,a=t.dataType,i=t.dataAttr,r=t.order,s=t.hidden,l=e.dataField.key;e.sortKey||e.dataField.dataType!==d.DataType.JSON||(l=e.dataField.sortKey||e.dataField.key+"."+y.DataFieldUtils.getDefaultFieldName(e.dataField));var p=e.id||e.key||e.dataField.key;x.CommonsUtils.defaults(e,x.CommonsUtils.pickBy({id:p,key:n,label:o,dataType:a,dataAttr:i,order:r,hidden:s,sortKey:l},x.CommonsUtils.lodash().identity))}},e}(),be=function(a){function e(e,t,n){var o=a.call(this)||this;return o.cd=e,o.router=t,o.activatedRoute=n,o.OVERLAY_TYPE=d.OverlayType,o.bodyData$=new u.BehaviorSubject([]),o.columns$=new u.BehaviorSubject(undefined),o.templateNames={caption:"caption",spanHeader:"spanHeader",header:"header",headerSummary:"headerSummary",body:"body",frozenRows:"frozenRows",cell:"cell",dataCell:"dataCell",footer:"footer",footerSummary:"summary",colGroup:"colgroup",rowExpansion:"rowexpansion",paginatorLeft:"paginatorLeft",paginatorRight:"paginatorRight"},o.$defaultProps=ce,o.eventQuery=[],o.selectedRows=[],o["switch"]=!0,o}return b(e,a),Object.defineProperty(e.prototype,"apiEntry",{get:function(){return this.$props.$ext.apiDataProps&&this.$props.$ext.apiDataProps.apiEntry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$id",{get:function(){return this.$props.$id},enumerable:!0,configurable:!0}),e.prototype.onPropsInit=function(){var t=this;if(this.$props.entity){if(!this.$props.caption||this.$props.caption.method){var e=x.CommonsUtils.getValue(this.$props.caption,this.$props.entity.label);this.$props.caption=e||"浏览"+(this.$props.entity.label||"")}this.$props.$ext.apiDataProps||(this.$props.$ext.apiDataProps={}),this.$props.$ext.apiDataProps.apiEntry||(this.$props.$ext.apiDataProps.apiEntry=this.$props.entity.apiEntry||"")}if(this.$props.columns){this.resoleActionsColumn(this.$props);var n=0;this.$props.columns.forEach(function(e){ve.resolveColumnByDataField(e),x.CommonsUtils.defaults(e,pe),e.order||(e.order=++n),t.$props.scrollable&&t.$props.scrollWidth&&e.width&&e.width.endsWith("%")&&(e.width=pe.width),e.overlays&&(e.overlays=x.CommonsUtils.getArrayValue(e.overlays)),e.headerOverlays&&(e.headerOverlays=x.CommonsUtils.getArrayValue(e.headerOverlays))})}this.$props.virtualScroll&&(this.$props.alwaysShowPaginator=!1,this.$props.paginator=!1),this.$props.scrollable&&x.CommonsUtils.set(this.$props,"style.width",this.$props.scrollWidth);var o=this.$props.columns.filter(function(e){return e.frozen});if(0<o.length){this.$props.frozenColumns=o,this.$props.$ext.rowHeight||(this.$props.$ext.rowHeight="30px");var a=0;o.forEach(function(e){var t=150;e.width&&(t=Number(e.width.substr(0,e.width.length-2))),a+=t||150,e.styleClass=e.styleClass||" table-frozen-column"}),this.$props.frozenWidth=a+"px"}this.updateColumns(),this.apiDataProps=this.getApiDataProps(),this.$subscriptions=x.StatesUtils.observe(this.$id).pipe(m.filter(function(e){return!!e}),m.skip(1)).subscribe(function(e){t.table.first=0,t.load(e)}),this.$props.$ext.dataItems&&this.data$.next({items:this.$props.$ext.dataItems,total:this.$props.$ext.dataItems.length}),x.StatesUtils.create(this.$id,{component:this},!0)},e.prototype.updateColumns=function(e){var t,n=this;(t=e?e.value:this.$props.columns.filter(function(e){return!e.frozen})||[]).sort(function(e,t){return e.order-t.order}),this.dataColumns=t.filter(function(e){return!e.isActionColumn||!(e.hidden&&!e.fetch)}),e||(t=t.filter(function(e){return!e.hidden})),this.dataColumnNames=x.CommonsUtils.compact(this.dataColumns.map(function(e){return e.key})),this.$props.frozenColumns&&this.$props.frozenColumns.forEach(function(e){e.key&&n.dataColumnNames.push(e.key)}),this.columns$.next(t),e&&this.load()},e.prototype.updateColAggKeys=function(e){if(e.column){var t=e.column,n=[];e.methods&&0<e.methods.length&&e.methods.forEach(function(e){n.push({name:t.key+"-"+e,field:t.aggKey||t.key,method:d.AggMethodsProps[e].key})}),t.aggProps=n,x.StatesUtils.update(this.$id,{})}},e.prototype.updateColFilters=function(e){if(e.column){var t=e.column;t.filters=[],e.value&&t.filters.push(e.value),x.StatesUtils.update(this.$id,{})}},e.prototype.updateSimpleSearch=function(e){x.CommonsUtils.isEmpty(e)?this.simpleQuery=undefined:(-1===e.indexOf('"')&&(e='"'+e+'"'),this.simpleQuery=[i.simpleQueryStringQuery(e)]),this.load()},e.prototype.getColumnByKey=function(t){var e=this.$props.columns.filter(function(e){return e.key===t});return 1<=e.length?e[0]:undefined},e.prototype.getRowStyleClass=function(e){return x.CommonsUtils.getValue(this.$props.$ext.rowStyleClass,e)},e.prototype.getRowStyle=function(e){var t=x.CommonsUtils.getValue(this.$props.$ext.rowStyle,e)||{};return this.$props.$ext.rowHeight&&(t.height=this.$props.$ext.rowHeight),t},e.prototype.getHeaderStyleClass=function(e){return x.CommonsUtils.getValue(e.headerStyleClass,e)},e.prototype.getHeaderStyle=function(e){return x.CommonsUtils.getValue(e.headerStyle,e)},e.prototype.rowSelect=function(e){this.updateTouch(),this.value=x.DataItemUtils.getItemValue(e,this.$props.$ext.dataItemProps&&this.$props.$ext.dataItemProps.valueKey)},e.prototype.load=function(e){this.apiDataProps=this.getApiDataProps(e),this.cd.markForCheck()},e.prototype.onDataReady=function(e){var t=x.CommonsUtils.get(this.$props,"$ext.apiDataProps.dataPath");t&&"/"!==t?this.bodyData$.next(e):this.bodyData$.next(e.items||[])},e.prototype.showOverlay=function(e){e&&e.content&&(this.overlayContext=C({dismissable:!0,showCloseIcon:!0},e),this.overlayPanel.hide(),this.overlayPanel.toggle(e.$event),this.cd.detectChanges())},e.prototype.hidePanel=function(){this.overlayPanel.hide()},e.prototype.resetQuery=function(){this.simpleQuery=undefined,this.complexQuery=undefined},e.prototype.resetForeignQuery=function(){this.eventQuery=[]},e.prototype.navigate=function(e,t,n){var o;this.router.navigate([{outlets:(o={},o[this.$props.$ext.routerOutlet]=$([e],t),o)}],{relativeTo:this.activatedRoute,skipLocationChange:!1,queryParams:n})},e.prototype.ngOnDestroy=function(){this.$props&&this.$props.$id&&x.StatesUtils.deleteState(this.$props.$id),a.prototype.ngOnDestroy.call(this)},e.prototype.getTableQuery=function(e){var t;e&&(e.query||e.filter)&&(this.eventQuery=$(x.CommonsUtils.getArrayValue(e.query||{}),x.CommonsUtils.getArrayValue(e.filter||{})));var n=$(this.getColumnsFilters(),this.eventQuery,this.simpleQuery||[],x.CommonsUtils.getArrayValue(this.complexQuery)||[]),o=x.CommonsUtils.copy(x.CommonsUtils.get(this.$props,"$ext.apiDataProps")),a=o.filter||{};a.$and?a.$and=$(a.$and,n):a.$or?a.$and=n:a=x.CommonsUtils.getArrayValue(a).concat(n),a=a.filter(function(e){return!x.CommonsUtils.isEmpty(e)});var i=o.aggProps||{};i=(i=x.CommonsUtils.getArrayValue(i).concat(this.getColumnsAggs())).filter(function(e){return 0<Object.keys(e).length});var r=o.sort||[],s=this.table.createLazyLoadMetadata();r=x.CommonsUtils.getArrayValue(r);var l=s.sortField;if(l){var p=this.getColumnByKey(l),c=p&&p.sortKey||l;r.push(((t={})[c]=1===s.sortOrder?d.Order.ASC:d.Order.DESC,t))}return delete o.filter,delete o.aggProps,C({},o,{filter:a,aggProps:i,sort:r})},e.prototype.getColumnsFilters=function(){var o=[];return(this.columns$.value||[]).concat(this.$props.frozenColumns||[]).filter(function(e){return e.filters}).forEach(function(n){return n.filters.filter(function(e){return e}).forEach(function(e){var t;switch(n.filterDataType||n.dataType||n.dataField&&n.dataField.dataType||d.DataType.STRING){case d.DataType.NUMBER:case d.DataType.DATE:t=x.CommonsUtils.isArray(e)?i.rangeQuery(n.filterKey||n.key).gte(e[0]).lte(e[1]):i.rangeQuery(n.filterKey||n.key).gte(e).lte(e);break;default:t=i.matchQuery(n.filterKey||n.key,e)}o.push(t)})}),o},e.prototype.getColumnsAggs=function(){var t=[];return(this.columns$.value||[]).concat(this.$props.frozenColumns||[]).filter(function(e){return e.aggProps}).forEach(function(e){t=t.concat(e.aggProps)}),t},e.prototype.resoleActionsColumn=function(e){var n,o=-1;e.columns.some(function(e,t){return!!e.isActionColumn&&(n=e,o=t,!0)}),0<=o&&(e.columns=x.CommonsUtils.removeByIndex(e.columns,o)),e.$ext.hasAddAction&&(this.addBtn=C({},de,{context:this}));var t=[];e.$ext.hasViewAction&&t.push(C({},me,{show:e.$ext.hasViewAction})),e.$ext.hasDeleteAction&&t.push(C({},fe,{show:e.$ext.hasDeleteAction})),e.$ext.hasAuditAction&&t.push(C({},ye,{show:e.$ext.hasAuditAction})),e.$ext.hasDownloadAction&&t.push(C({},xe,{show:e.$ext.hasDownloadAction})),e.$ext.hasEditAction&&t.push(C({},he,{show:e.$ext.hasEditAction})),0<t.length&&!n&&(n=C({},ge,n||{})),0<t.length&&(n.cellContent=$(x.CommonsUtils.getArrayValue(n.cellContent)||[],t)),n&&(this.$props.$ext.frozenActionColumn&&(n.frozen=!0),this.$props.$ext.rowActionsPlaceAhead?this.$props.columns.splice(0,0,n):this.$props.columns.push(n)),this.$props.$ext.hasRowIndex&&this.$props.columns.splice(0,0,ue)},e.prototype.getApiDataProps=function(e){var t=this.table.createLazyLoadMetadata(),n=this.getTableQuery(e),o=C({},n,{dataPath:"/",returnFields:this.dataColumnNames,from:t.first,size:t.rows});return o.requestOptions=o.requestOptions||{},o.requestOptions.tag||(o.requestOptions.tag=this.$id),o},e.decorators=[{type:f.Component,args:[{selector:"png-table",template:'<p-table #pngTable\n         (onDataReady)="onDataReady($event)"\n         (onLazyLoad)="load($event)"\n         (selectionChange)="rowSelect($event)"\n         [(selection)]="selectedRows"\n         [columns]="columns$|async"\n         [context]="ctx"\n         [erApiData]="apiDataProps"\n         [props]="$props"\n         [totalRecords]="(data$|async)?.total"\n         [value]="bodyData$|async"\n         erPropsBind\n>\n  <ng-template pTemplate="caption">\n    <png-table-caption\n      (onSimpleSearch)="updateSimpleSearch($event)"\n      [addButton]="addBtn"\n      [caption]="$props.caption"\n      [customerTpl]="template(templateNames.caption)"\n      [hasAddAction]="$props.$ext.hasAddAction"\n      [hasSearchBox]="$props.$ext.hasSearchBox"\n      [hasSearchInput]="$props.$ext.hasSearchInput"\n    >\n    </png-table-caption>\n    <ng-container *ngIf="$props.$ext.caption">\n      <er-dyna-content [content]="$props.$ext.caption" [context]="getEventContext()"></er-dyna-content>\n    </ng-container>\n  </ng-template>\n\n  <ng-template let-columns pTemplate="colgroup">\n    <ng-container *ngTemplateOutlet="colGroupTpl;\n                     context:{$implicit:$props,context:getEventContext(),columns:columns}">\n    </ng-container>\n  </ng-template>\n\n\n  <ng-template let-columns pTemplate="header">\n    <ng-container\n      *ngTemplateOutlet="template(templateNames.spanHeader); context:{$implicit:columns}"></ng-container>\n    <ng-container *ngIf="$props.$ext.spanHeader">\n      <span [outerHTML]="$props.$ext.spanHeader"></span>\n    </ng-container>\n    <tr (onAggKeysSet)="updateColAggKeys($event)"\n        (onFiltersSet)="updateColFilters($event)"\n        [columns]="columns"\n        [customerTpl]="template(templateNames.header)"\n        png-table-header\n    >\n    </tr>\n\n    <ng-container *ngIf="(data$|async)?.aggs as aggValues">\n      <tr [aggValues]="aggValues"\n          [columns]="columns"\n          [customerTpl]="template(templateNames.headerSummary)"\n          png-table-summary\n      >\n      </tr>\n    </ng-container>\n  </ng-template>\n\n  \x3c!--<ng-container *ngIf="$$props.frozenValue">--\x3e\n  \x3c!--<ng-template pTemplate="frozenrows" let-row let-columns="columns">--\x3e\n  \x3c!--<ng-container *ngTemplateOutlet="template(templateNames.frozenRows,defaultBodyTpl);--\x3e\n  \x3c!--context:{$implicit:row,columns:columns,$props:$$props,table:pngTable}">--\x3e\n  \x3c!--</ng-container>--\x3e\n  \x3c!--</ng-template>--\x3e\n  \x3c!--</ng-container>--\x3e\n\n  <ng-template let-columns="columns" let-expanded="expanded" let-row let-rowIndex="rowIndex" pTemplate="body">\n    <tr [cellTpl]="template(templateNames.cell)"\n        [columns]="columns"\n        [customerTpl]="template(templateNames.body)"\n        [dataCellTpl]="template(templateNames.dataCell)"\n        [expanded]="expanded"\n        [ngClass]="getRowStyleClass({row: row, rowIndex: rowIndex})"\n        [ngStyle]="getRowStyle({row: row, rowIndex: rowIndex})"\n        [pSelectableRowIndex]="rowIndex"\n        [pSelectableRow]="row"\n        [rowIndex]="rowIndex"\n        [row]="row"\n        png-table-body-row\n    >\n    </tr>\n  </ng-template>\n\n  <ng-template let-columns="columns" let-row pTemplate="rowexpansion">\n    <tr [columns]="dataColumns"\n        [customerTpl]="template(templateNames.rowExpansion)"\n        [rowId]="row[$props.dataKey || \'id\']"\n        png-table-expanded-row\n    >\n    </tr>\n  </ng-template>\n\n  <ng-template let-columns pTemplate="footer">\n    <tr [columns]="columns"\n        [customerTpl]="template(templateNames.footer)"\n        png-table-footer\n    >\n    </tr>\n  </ng-template>\n\n  <ng-container *ngIf="(data$|async)?.aggs as aggValues">\n    <ng-template pTemplate="summary">\n      <tr [aggValues]="aggValues"\n          [columns]="dataColumns"\n          [customerTpl]="template(templateNames.footerSummary)"\n          png-table-summary\n      >\n      </tr>\n    </ng-template>\n  </ng-container>\n\n  <ng-template let-state pTemplate="paginatorleft">\n    <ng-container *ngIf="(data$|async)?.total as totalRecords">\n      <ng-container\n        *ngTemplateOutlet="template(templateNames.paginatorLeft,paginationLeftTpl);context:{$implicit:state,totalRecords:totalRecords}">\n      </ng-container>\n    </ng-container>\n  </ng-template>\n\n  <ng-template let-state pTemplate="paginatorright">\n    <div class="d-flex align-content-center">\n      <er-http-status [tag]="$id" class="mr-2"></er-http-status>\n      <ng-container *ngIf="$props.$ext.hasColumnSelector">\n        <png-table-column-selector\n          (onColumnsChange)="updateColumns($event)"\n          [columns]="columns$|async"\n          [optionColumns]="$props.columns"\n        >\n        </png-table-column-selector>\n      </ng-container>\n      <ng-container *ngIf="$props.$ext.hasPaginatorRight">\n        <ng-container\n          *ngTemplateOutlet="template(templateNames.paginatorRight);context:{$implicit:state}"></ng-container>\n      </ng-container>\n    </div>\n  </ng-template>\n\n\n  <ng-template #colGroupTpl let-columns="columns" let-props>\n    <colgroup>\n      <col *ngIf="props.$ext.rowExpandable" style="width: 3em">\n      <col *ngIf="props.$ext.hasRowCheckbox" style="width: 3em">\n      <col *ngFor="let col of columns" [ngClass]="getHeaderStyleClass(col)"\n           [ngStyle]="getHeaderStyle(col)"\n           [width]="col.width"\n      >\n    </colgroup>\n  </ng-template>\n\n  <ng-template #defaultFrozonRowsTpl let-columns="columns" let-row>\n  </ng-template>\n\n  <ng-template let-columns pTemplate="emptymessage">\n    <tr>\n      <td [attr.colspan]="columns?.length">\n        <strong>{{$props.$ext.emptyMessage}}</strong>\n      </td>\n    </tr>\n  </ng-template>\n</p-table>\n\n<ng-template #paginationLeftTpl let-state let-totalRecords="totalRecords">\n  <span class="paginationLeft"><span *ngIf="simpleQuery || complexQuery"\n                                     class="font-weight-bold text-danger "><u>搜索结果</u></span>显示 {{totalRecords < 1 ? 0 : state.first + 1}}\n    -\n  {{totalRecords > 0 ? ((state.rows+ state.first) <= totalRecords ? (state.rows + state.first) :\n  totalRecords) : 0}}，共 {{totalRecords ? totalRecords : 0}} 条</span>\n</ng-template>\n\n\n<p-overlayPanel #overlayPanel [dismissable]="overlayContext?.dismissable"\n                [showCloseIcon]="overlayContext?.showCloseIcon"\n                [id]="overlayContext?.id"\n                [ngStyle]="overlayContext?.overlayStyle"\n                [styleClass]="overlayContext?.overlayStyleClass">\n  <ng-container *ngIf="overlayContext">\n    <ng-container [ngSwitch]="overlayContext.type">\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.PANEL">\n        <er-dyna-content [content]="overlayContext.content"\n                         [context]="overlayContext.context"\n                         [styleClass]="overlayContext.styleClass"\n                         [style]="overlayContext.style"\n        ></er-dyna-content>\n      </ng-container>\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.TABLE">\n        <png-table erPropsBind [props]="overlayContext.content"></png-table>\n      </ng-container>\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.CHART">\n        <png-chart erPropsBind [props]="overlayContext.content"></png-chart>\n      </ng-container>\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.MENU">\n        <p-menu appendTo="body" [popup]="true" [model]="overlayContext.content"></p-menu>\n      </ng-container>\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.TREE">\n        <pre [erJsonViewer]="overlayContext.content" openLevel="1"></pre>\n      </ng-container>\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.FRAME">\n        <iframe [ngClass]="overlayContext.styleClass" [ngStyle]="overlayContext.style"\n                [src]="overlayContext.content|erSafeHtml:\'resource\'" frameborder="0"\n                allowfullscreen></iframe>\n      </ng-container>\n      <ng-container *ngSwitchCase="OVERLAY_TYPE.COMPONENT">\n        <er-dyna-content [content]="overlayContext.content"\n                         [context]="overlayContext.context"\n                         [styleClass]="overlayContext.styleClass"\n                         [style]="overlayContext.style"\n        ></er-dyna-content>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n</p-overlayPanel>\n\n\x3c!--<div style="position: relative;">--\x3e\n\x3c!--<p-paginator rows="10"--\x3e\n\x3c!--(onLazyLoad)="load($event)"--\x3e\n\x3c!--(onPageChange)="load($event)"--\x3e\n\x3c!--[totalRecords]="totalRecords"--\x3e\n\x3c!--[rowsPerPageOptions]="[10, 25]">--\x3e\n\x3c!--</p-paginator>--\x3e\n\x3c!--<span style="position: absolute; top:3px; right:5px; margin: 5px;">Total records: {{totalRecords}} </span>--\x3e\n\x3c!--</div>--\x3e\n',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}],changeDetection:f.ChangeDetectionStrategy.OnPush,styles:["/deep/ .ui-paginator{font-size:.8rem!important}/deep/ td.col-expandable,/deep/ th.col-expandable{width:1em}/deep/ td.col-checkbox,/deep/ th.col-checkbox{width:1em}/deep/ td.col-radio,/deep/ th.col-radio{width:5px}/deep/ td.row-index,/deep/ th.row-index{width:100px}/deep/ td.circle,/deep/ th.circle{border-radius:50%!important}/deep/ td.col-summary,/deep/ th.col-summary{background-color:#068020;color:#fff!important}"]}]}],e.ctorParameters=function(){return[{type:f.ChangeDetectorRef},{type:r.Router},{type:r.ActivatedRoute}]},e.propDecorators={table:[{type:f.ViewChild,args:["pngTable"]}],overlayPanel:[{type:f.ViewChild,args:["overlayPanel"]}],popupMenu:[{type:f.ViewChild,args:[l.Menu]}]},e}(y.DataAwareControlWrapperComponent),Ce=function(){function e(e,t){this.domHandler=e,this.controlContainer=t,this.tooltipPosition="right"}return e.prototype.ngOnInit=function(){if(!this.control&&this.controlContainer){var e=this.controlContainer.formDirective?this.controlContainer.formDirective.form:null;e&&(this.control=x.FormUtils.getFormControl.apply(x.FormUtils,$([e],this.controlContainer.path,[this.controlName])))}},e.prototype.onMouseEnter=function(){this.control.invalid&&this.showErrMsg()},e.prototype.onMouseLeave=function(){this.hide()},e.prototype.onFocusIn=function(){this.control.invalid&&this.showErrMsg()},e.prototype.onFocusOut=function(){this.hide()},e.prototype.onKeyup=function(){this.control.invalid?this.showErrMsg():this.hide()},e.prototype.showErrMsg=function(){this.errorMessage=this.getErrorMsg(),null!==this.errorMessage&&this.errorMessage!==undefined&&this.show()},e.prototype.getErrorMsg=function(){var e=o.ValidateUtils.getErrorMessage(this.control.errors,this.messages);return 0<Object.keys(e).length?e[Object.keys(e)[0]]:undefined},e.prototype.hide=function(){this.ngOnDestroy()},e.prototype.show=function(){this.container?this.domHandler.findSingle(this.container,".ui-tooltip-text").innerText=this.errorMessage:this.create();var e,t,n=this.domHandler.getOffset(this["in"].nativeElement),o=n.top,a=n.left;switch(this.container.style.display="block",this.tooltipPosition){case"right":e=a+this.domHandler.getOuterWidth(this["in"].nativeElement),t=o+(this.domHandler.getOuterHeight(this["in"].nativeElement)-this.domHandler.getOuterHeight(this.container))/2;break;case"left":e=a-this.domHandler.getOuterWidth(this.container),t=o+(this.domHandler.getOuterHeight(this["in"].nativeElement)-this.domHandler.getOuterHeight(this.container))/2;break;case"top":e=a+(this.domHandler.getOuterWidth(this["in"].nativeElement)-this.domHandler.getOuterWidth(this.container))/2,t=o-this.domHandler.getOuterHeight(this.container);break;case"bottom":e=a+(this.domHandler.getOuterWidth(this["in"].nativeElement)-this.domHandler.getOuterWidth(this.container))/2,t=o+this.domHandler.getOuterHeight(this["in"].nativeElement)}this.container.style.left=e+"px",this.container.style.top=t+"px",this.container.style.zIndex=999999},e.prototype.create=function(){var e="ui-widget ui-tooltip ui-tooltip-"+this.tooltipPosition;this.container=document.createElement("div"),this.tooltipStyleClass&&(e+=" "+this.tooltipStyleClass),this.container.className=e;var t=document.createElement("div");t.className="ui-tooltip-arrow",this.container.appendChild(t);var n=document.createElement("div");n.className="ui-tooltip-text ui-shadow ui-corner-all",n.innerHTML=this.errorMessage,this.positionStyle&&(this.container.style.position=this.positionStyle),this.container.appendChild(n),document.body.appendChild(this.container)},e.prototype.ngOnDestroy=function(){this.container&&this.container.parentElement&&document.body.removeChild(this.container),this.container=null},e.decorators=[{type:f.Component,args:[{selector:"png-tooltip",template:'\n    <div #in style="display:inline-block;position:relative">\n      <ng-content></ng-content>\n    </div>\n  ',providers:[l.DomHandler]}]}],e.ctorParameters=function(){return[{type:l.DomHandler},{type:g.ControlContainer,decorators:[{type:f.Optional}]}]},e.propDecorators={tooltipPosition:[{type:f.Input}],control:[{type:f.Input}],controlName:[{type:f.Input}],positionStyle:[{type:f.Input}],tooltipStyleClass:[{type:f.Input}],messages:[{type:f.Input}],"in":[{type:f.ViewChild,args:["in"]}],onMouseEnter:[{type:f.HostListener,args:["mouseenter"]}],onMouseLeave:[{type:f.HostListener,args:["mouseleave"]}],onFocusIn:[{type:f.HostListener,args:["focusin"]}],onFocusOut:[{type:f.HostListener,args:["focusout"]}],onKeyup:[{type:f.HostListener,args:["keyup"]}]},e}(),we={idKey:"id",labelKey:"label",parentKey:"parent",childrenKey:"children",leafKey:"leaf",dataKey:"data",expandedKey:"expanded"},$e={style:{"max-height.px":500,"max-width.px":350,overflow:"auto"},emptyMessage:"没有节点信息",$ext:{apiDataProps:{dataPath:"items",size:9999},dataItemProps:{idKey:"id",parentKey:"parent",labelKey:"name",leafKey:"leaf"},nodesFormat:"plainArray",lazy:!1,hasSearchBox:!0,autoExpandLevel:1,expandedIcon:"fa fa-folder-open",collapsedIcon:"fa fa-folder",icon:"fa fa-leaf"}},Te=function(n){function e(e){var t=n.call(this)||this;return t.cd=e,t.templateNames={icon:"icon",node:"node"},t.onEmptyNode=new f.EventEmitter,t.onLazyLoad=new f.EventEmitter,t.$defaultProps=$e,t.modelFormatter=t.formatModel,t.valueParser=t.parseValue,t}return b(e,n),Object.defineProperty(e.prototype,"selection",{get:function(){return this._selection},set:function(e){this._selection=e,this.value=e},enumerable:!0,configurable:!0}),e.prototype.onPropsInit=function(){this.filtered=!1,this.loading$=y.HTTP_TAG_STATE$(this.$props.$id),this.$props.$ext.dataItems&&this.data$.next(this.$props.$ext.dataItems),x.StatesUtils.create(this.$props.$id,{component:this},!0)},e.prototype.load=function(){this.apiDataProps=C({},this.apiDataProps),this.cd.markForCheck()},e.prototype.formatModel=function(e){return e&&(this.selectedNodeValues=e),e},e.prototype.parseValue=function(e){var t,n=this;return x.CommonsUtils.isArray(e)?t=x.CommonsUtils.flattenDeep(e).map(function(e){return n.getSelectedNodeValues(e)}):x.CommonsUtils.isJson(e)&&(t=this.getSelectedNodeValues(e)),t=x.CommonsUtils.flatten(t),t=x.CommonsUtils.unique(t,this.$props.$ext.dataItemProps.idKey),t=x.CommonsUtils.orderBy(t,this.$props.$ext.dataItemProps.idKey,"asc"),this.$props&&this.$props.$id&&x.StatesUtils.update(this.$props.$id,{selectedNodeValues:t}),this.selectedNodeValues=t},e.prototype.expandAll=function(){var t=this;this.data$.value.forEach(function(e){x.TreeUtils.expandNode(e,!0,t.$props.$ext)})},e.prototype.collapseAll=function(){var t=this;this.data$.value.forEach(function(e){x.TreeUtils.expandNode(e,!1,t.$props.$ext)})},e.prototype.filter=function(e){var t=this.applyFilter(e.target.value);this.data$.next(t),this.filtered=!0,this.expandAll()},e.prototype.applyFilter=function(i){var r=this;return i?(i=i.toLowerCase(),x.TreeUtils.filter(this.unFilteredValue,function(e){var t=e.$py;t||(t=x.PinyinUtil.getFirstLetter(e.label),e.$py=t);var n=r.$props.$ext.dataItemProps&&r.$props.$ext.dataItemProps.idKey,o=(e.data&&e.data[n]||"")+"",a=e.label||"";return/^\w+$/.test(i)?a.startsWith(i)||o.startsWith(i)||t.startsWith(i):x.RegUtils.test(o,i)||x.RegUtils.test(t,i)})):(this.clearFilter(),this.unFilteredValue)},e.prototype.clearFilter=function(){this.filterValue="",this.data$.next($(this.unFilteredValue)),this.filtered=!1},e.prototype.getSelectedNodeValues=function(e){var t=this.getSelectedNodeValue(e);return x.CommonsUtils.flattenDeep(t)},e.prototype.onNodeExpand=function(e){this.expandedNode=e.node,!e.node.children&&this.$props.$ext.lazy?this.onLazyLoad.emit(this.getEventContext(e)):this.resolveNode(e.node)},e.prototype.onNodeSelect=function(e){this.selectedNode=e.node&&e.node[we.dataKey]||e.node,this.$props&&this.$props.$id&&x.StatesUtils.update(this.$props.$id,{selectedNode:this.selectedNode}),this.updateTouch()},e.prototype.onNodeUnSelect=function(e){this.updateTouch()},e.prototype.onTreeDataReady=function(e){var t=this.createTreeNodes(e);if(this.initSelection(t),0<(this.unFilteredValue=t).length){var n=this.$props.$ext.autoExpandLevel,o=void 0;if(this.expandedNode){var a=this.expandedNode;for(o=a.id;a.parent;)n++,a=a.parent}x.TreeUtils.expandNode(t[0],!0,this.$props.$ext,n,1,o)}else(0===t.length||1===t.length&&!t.children)&&this.onEmptyNode.emit();if(this.$props.$ext.filter){var i=this.$props.$ext.filter;t=x.CommonsUtils.isString(i)?this.applyFilter(i):i.method(t)}this.data$.next(t)},e.prototype.initSelection=function(e){var t=this;if(this._selection)return this.tree.selection=this._selection,void this.tree.propagateUp(this._selection,!0);if(this.selectedNodeValues&&e){this._selection=[];for(var n=x.CommonsUtils.getArrayValue(this.selectedNodeValues),o=0;o<n.length;o++){var a=x.TreeUtils.findNode(e,n[o],this.$props.$ext);a&&this._selection.push(a)}this.tree.selection=this._selection,this._selection.forEach(function(e){t.tree.propagateUp(e,!0)})}},e.prototype.ngOnDestroy=function(){this.$props&&this.$props.$id&&x.StatesUtils.deleteState(this.$props.$id),n.prototype.ngOnDestroy.call(this)},e.prototype.getSelectedNodeValue=function(e,t){if(x.CommonsUtils.isEmpty(e))return undefined;if(e.isVirtual)return undefined;t=t||[];var n,o=e[we.dataKey];return x.CommonsUtils.isEmpty(o)?undefined:(this.$props.$ext.dataItemProps&&this.$props.$ext.dataItemProps.valueKey?n=x.DataItemUtils.getItemValue(o,this.$props.$ext.dataItemProps.valueKey):((n={})[this.$props.$ext.dataItemProps.idKey]=o[this.$props.$ext.dataItemProps.idKey],n[this.$props.$ext.dataItemProps.labelKey]=o[this.$props.$ext.dataItemProps.labelKey],this.$props.$ext.dataItemProps.typeKey&&(n[this.$props.$ext.dataItemProps.typeKey]=o[this.$props.$ext.dataItemProps.typeKey])),t.push(n),e[we.parentKey]&&this.getSelectedNodeValue(e[we.parentKey],t),t)},e.prototype.createTreeNodes=function(e){if(!e)return[];var t=$(e);"plainArray"===this.$props.$ext.nodesFormat&&(t=x.TreeUtils.transNodes(t,{src:this.$props.$ext.dataItemProps,node:we},this.$props.$ext.root,this.$props.$ext.lazy)),t[0]&&x.TreeUtils.initNode(t[0],this.$props.$ext);var n={};return this.$props.$ext.virtualRoot?(x.CommonsUtils.isString(this.$props.$ext.virtualRoot)?n.label=this.$props.$ext.virtualRoot:n=this.$props.$ext.virtualRoot,n.children=t,n.isVirtual=!0,[n]):t},e.prototype.resolveNode=function(e){var t=this;e&&(x.TreeUtils.initNode(e,this.$props.$ext),e.children&&e.children.forEach(function(e){return x.TreeUtils.initNode(e,t.$props.$ext)}))},e.decorators=[{type:f.Component,args:[{selector:"png-tree",template:'<div class="ui-g ui-fluid">\n\n  <div *ngIf="$props.$ext.hasSearchBox" class="ui-g-12">\n     <span class="inner-addon">\n       <i class="fa fa-search text-primary left"></i>\n       <input (keyup)="filter($event)" [(ngModel)]="filterValue" pInputText placeholder="输入代码或名称首字母" title="搜索节点"/>\n       <i (click)="clearFilter()" *ngIf="filtered" class="fa fa-trash text-muted right" title="清除搜索内容"></i>\n     </span>\n  </div>\n\n  <p-card class="w-100" erAnimate="slideInLeft">\n    <span class="pull-right">\n          <i class="fa fa-arrow-circle-up mr-1" (click)="collapseAll()" title="收起全部"></i>\n          <i (click)="expandAll()" class="fa fa-arrow-circle-down mr-1" title="展开全部"></i>\n          <i (click)="load()" class="fa fa-refresh" title="刷新树"></i>\n      </span>\n    <p-tree #pngTree\n            erPropsBind\n            [props]="$props"\n            [context]="ctx"\n            [erApiData]="apiDataProps"\n            [value]="data$|async"\n            [(selection)]="selection"\n            [loading]="loading$ | async"\n            (onDataReady)="onTreeDataReady($event)"\n            (onNodeExpand)="onNodeExpand($event)"\n            (onNodeSelect)="onNodeSelect($event)"\n            (onNodeUnselect)="onNodeUnSelect($event)"\n    >\n      <ng-template pTemplate="default" let-node>\n        <ng-container *ngTemplateOutlet="template(templateNames.node,defaultNodeTpl);\n                                  context:{$implicit: node,props:$props}"></ng-container>\n      </ng-template>\n\n      <ng-container *ngIf="template(templateNames.icon)">\n        <ng-template let-node pTemplate="picture">\n          <ng-container *ngTemplateOutlet="template(templateNames.icon);\n                                  context:{$implicit: node,props:$props}"></ng-container>\n        </ng-template>\n      </ng-container>\n\n      <ng-template #defaultNodeTpl let-node let-props="props">\n        \x3c!--<input type="radio" name="tree_radio" *ngIf="props.selectionMode === \'radio\' && !node[\'children\']"/>--\x3e\n        <span [innerHTML]="node[\'label\']" [ngClass]="{\'ui-state-highlight\':node.matched}"></span>\n      </ng-template>\n\n    </p-tree>\n  </p-card>\n\n</div>\n',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}],changeDetection:f.ChangeDetectionStrategy.OnPush,styles:["/deep/ li:focus{outline:green solid 1px!important}/deep/ .ui-state-highlight{background-color:#9acd32!important;color:inherit!important;font-weight:700}/deep/ .ui-treenode-content-selected .ui-state-highlight{background-color:transparent!important;font-size:1.1em!important;font-weight:700;color:red!important}"]}]}],e.ctorParameters=function(){return[{type:f.ChangeDetectorRef}]},e.propDecorators={tree:[{type:f.ViewChild,args:["pngTree"]}],onEmptyNode:[{type:f.Output}],onLazyLoad:[{type:f.Output}]},e}(y.DataAwareControlWrapperComponent),Ie=function(a){function e(e,t,n){var o=a.call(this)||this;return o.cd=e,o.router=t,o.activatedRoute=n,o.switchable=!0,o.hideTree=!1,o.$subscriptions=o.router.events.subscribe(function(e){e instanceof r.NavigationEnd&&(o.isFormOutlet=0<e.url.indexOf("(aux:"),o.isRestore&&(o.isRestore=!1,o.refresh()),o.cd.markForCheck())}),o}return b(e,a),Object.defineProperty(e.prototype,"isFormOutlet",{get:function(){return this._isFormOutlet},set:function(e){this.isFormOutlet!==e&&(this._isFormOutlet=e)},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.pngTable.load(),this.pngTree&&this.refreshTree&&(this.refreshTree=!1,this.pngTree.load())},e.prototype.beforeRoutePropsBind=function(e){return this.tree=undefined,this.table=undefined,this.switchable=!0,this.hideTree=!1,e.caption&&x.CommonsUtils.set(e,"table.caption",e.caption),e},e.prototype.afterRoutePropsBind=function(){this.tree?(this.hideTree=!1,this.switchable=!0,this.tree.$id=x.IdUtils.getRandom(),this.tree.$container=this,x.CommonsUtils.set(this.tree,"$ext.$container",this)):this.switchable=!1,this.table&&(this.table.$id=x.IdUtils.getRandom(),this.table.$container=this,x.CommonsUtils.set(this.table,"$ext.$container",this))},e.prototype.closeTree=function(){this.hideTree=!0},e.prototype.back=function(){this.isRestore=!0,this.router.navigate(["./",{outlets:{aux:null}}],{relativeTo:this.activatedRoute})},e.decorators=[{type:f.Component,args:[{selector:"png-tree-nav-table",template:'\n    <div [hidden]="isFormOutlet">\n      <er-fluid-container>\n        <er-left-right [hideLeft]="!tree || hideTree" [switchable]="!!tree && switchable">\n          <ng-template erTypedTemplate="left">\n            <png-panel *ngIf="tree" [icon]="tree.$ext?.captionIcon || \'fa fa-tree\'" [header]="tree.$ext?.caption || \'管理树\'">\n              <png-tree erPropsBind [props]="tree" (onEmptyNode)="closeTree()"></png-tree>\n            </png-panel>\n          </ng-template>\n          <ng-template erTypedTemplate="right">\n            <div *ngIf="table">\n              <div [@fadeIn]="true">\n                <png-table erPropsBind [props]="table"></png-table>\n              </div>\n            </div>\n          </ng-template>\n        </er-left-right>\n      </er-fluid-container>\n    </div>\n    <router-outlet name="aux">\n      <ng-container *ngTemplateOutlet="goBack"></ng-container>\n    </router-outlet>\n    <ng-container *ngTemplateOutlet="goBack"></ng-container>\n    <ng-template #goBack>\n      <div *ngIf="isFormOutlet">\n        <a (click)="back()" class="btn btn-outline-primary"\n           title="返回到数据浏览"> <i class="fa fa-2x text-danger fa-sign-out fa-rotate-180"></i> 返回</a>\n\n      </div>\n    </ng-template>\n  ',animations:[s.ANIMATIONS.zoomIn,s.ANIMATIONS.fadeIn],changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:f.ChangeDetectorRef},{type:r.Router},{type:r.ActivatedRoute}]},e.propDecorators={tree:[{type:f.Input}],table:[{type:f.Input}],switchable:[{type:f.Input}],hideTree:[{type:f.Input}],pngTable:[{type:f.ViewChild,args:[be]}],pngTree:[{type:f.ViewChild,args:[Te]}]},e}(y.RouteBindComponent),Se=function(){function e(){this.active=!1}return e.decorators=[{type:f.Component,args:[{selector:"png-step",template:'\n    <div *ngIf="active" [ngClass]="styleClass" [ngStyle]="style" class="ui-widget-content ui-corner-all step-container">\n      <ng-content></ng-content>\n    </div>\n  ',styles:[".step-container {padding: 45px 25px 45px 25px; margin-bottom: 20px;}"]}]}],e.propDecorators={styleClass:[{type:f.Input}],style:[{type:f.Input}],label:[{type:f.Input}]},e}(),Pe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeIndex=0,e.stepChange=new f.EventEmitter,e.items=[],e.templateNames={header:"header",footer:"footer"},e}return b(e,t),e.prototype.ngAfterContentInit=function(){var o=this;t.prototype.ngAfterContentInit.call(this),this.steps.toArray().forEach(function(t,n){t.styleClass||(t.styleClass=o.stepStyleClass),t.style||(t.style=o.style),n===o.activeIndex&&(t.active=!0),o.items[n]={label:t.label,command:function(e){o.steps.toArray().forEach(function(e){return e.active=!1}),t.active=!0,o.activeIndex=n,o.stepChange.emit(n)}}})},e.prototype.ngOnChanges=function(t){if(this.steps){var e=function(e){if("activeIndex"===e){var o=t[e].currentValue;n.steps.toArray().forEach(function(e,t){var n=t===o;e.active=n}),n.stepChange.emit(o)}},n=this;for(var o in t)e(o)}},e.prototype.previous=function(){this.activeIndex--,this.stepChange.emit(this.activeIndex),this.ngOnChanges({activeIndex:{currentValue:this.activeIndex,previousValue:this.activeIndex+1,firstChange:!1,isFirstChange:function(){return!1}}})},e.prototype.next=function(){this.activeIndex++,this.stepChange.emit(this.activeIndex),this.ngOnChanges({activeIndex:{currentValue:this.activeIndex,previousValue:this.activeIndex-1,firstChange:!1,isFirstChange:function(){return!1}}})},e.decorators=[{type:f.Component,args:[{selector:"png-wizard",template:'\n    <ng-container *ngIf="template(templateNames.header)">\n      <ng-container *ngTemplateOutlet="template(templateNames.header)"></ng-container>\n    </ng-container>\n    <p-steps [model]="items" [(activeIndex)]="activeIndex"\n             [ngClass]="styleClass" [ngStyle]="style" [readonly]="false"></p-steps>\n    <ng-content></ng-content>\n    <button pButton type="button" *ngIf="activeIndex > 0" class="mr-2"\n            (click)="previous()" icon="fa fa-hand-o-left" label="Previous"></button>\n    <button pButton type="button" *ngIf="activeIndex < items.length - 1"\n            (click)="next()" icon="fa fa-hand-o-right" iconPos="right" label="Next"></button>\n    <ng-container *ngIf="template(templateNames.footer)">\n      <ng-container *ngTemplateOutlet="template(templateNames.footer)"></ng-container>\n    </ng-container>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush,styles:[":host::ng-deep .ui-steps ul[role=tablist]{display:flex!important;justify-content:space-around!important}"]}]}],e.propDecorators={activeIndex:[{type:f.Input}],styleClass:[{type:f.Input}],style:[{type:f.Input}],stepStyleClass:[{type:f.Input}],stepStyle:[{type:f.Input}],stepChange:[{type:f.Output}],steps:[{type:f.ContentChildren,args:[Se]}]},e}(y.BaseComponent),Oe=[I,S,P,ne,z,j,Z,E,U,W,L,A,D,Se,Te,Ie,Q,le,re,X,_,F,Y,te,Ce,be,Pe,V,N,ae],Ae={STATIC:0,OVERLAY:1,SLIM:2,HORIZONTAL:3};Ae[Ae.STATIC]="STATIC",Ae[Ae.OVERLAY]="OVERLAY",Ae[Ae.SLIM]="SLIM",Ae[Ae.HORIZONTAL]="HORIZONTAL";var De=function(o){function e(e,t){var n=o.call(this)||this;return n.renderer=e,n.cd=t,n.menuOrientation=Ae.STATIC,n.darkMenu=!0,n.onInitMenu=new f.EventEmitter,n.profileMode="inline",n.rootMenuToggleStateName="$rootMenuToggler",n.templateNames={topbar:"topbar",header:"header",main:"main",footer:"footer",profile:"profile",settings:"settings",messages:"messages",notifications:"notifications",search:"search"},n}return b(e,o),e.prototype.ngOnInit=function(){var e=this;this.onInitMenu.emit(),this.$subscriptions=x.StatesUtils.observe(d.StateNames.menu,this.rootMenuToggleStateName).pipe(m.filter(function(e){return e!==undefined})).subscribe(function(){return e._toggleMainMenu()}),this.appTitle=this.appTitle||x.ConfigUtils.getConfig().appTitle,this.appName=this.appName||x.ConfigUtils.getConfig().appName,this.appLogo=this.appLogo||x.ConfigUtils.getConfig().appLogo},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.layoutMenuScrollerViewChild.moveBar()},100)},e.prototype.onLayoutClick=function(){this.topbarItemClick||(this.activeTopbarItem=null,this.topbarMenuActive=!1),this.menuClick||((this.isHorizontal()||this.isSlim())&&(this.resetMenu=!0),(this.overlayMenuActive||this.staticMenuMobileActive)&&this.hideOverlayMenu(),this.menuHoverActive=!1),this.topbarItemClick=!1,this.menuClick=!1},e.prototype.onMenuClick=function(e){var t=this;this.menuClick=!0,this.resetMenu=!1,this.isHorizontal()||setTimeout(function(){t.layoutMenuScrollerViewChild.moveBar()},450)},e.prototype.onTopbarMenuButtonClick=function(e){this.topbarItemClick=!0,this.topbarMenuActive=!this.topbarMenuActive,this.hideOverlayMenu(),e.preventDefault()},e.prototype.onTopbarItemClick=function(e,t){this.topbarItemClick=!0,this.activeTopbarItem===t?this.activeTopbarItem=null:this.activeTopbarItem=t,e.preventDefault()},e.prototype.onTopbarSubItemClick=function(e){e.preventDefault()},e.prototype.hideOverlayMenu=function(){this.rotateMenuButton=!1,this.overlayMenuActive=!1,this.staticMenuMobileActive=!1},e.prototype.isTablet=function(){var e=window.innerWidth;return e<=1024&&640<e},e.prototype.isDesktop=function(){return 1024<window.innerWidth},e.prototype.isMobile=function(){return window.innerWidth<=640},e.prototype.isOverlay=function(){return this.menuOrientation===Ae.OVERLAY},e.prototype.isHorizontal=function(){return this.menuOrientation===Ae.HORIZONTAL},e.prototype.isSlim=function(){return this.menuOrientation===Ae.SLIM},e.prototype.changeToStaticMenu=function(){this.menuOrientation=Ae.STATIC},e.prototype.changeToOverlayMenu=function(){this.menuOrientation=Ae.OVERLAY},e.prototype.changeToHorizontalMenu=function(){this.menuOrientation=Ae.HORIZONTAL},e.prototype.changeToSlimMenu=function(){this.menuOrientation=Ae.SLIM},e.prototype._toggleMainMenu=function(){var e=x.StatesUtils.getValue(d.StateNames.rootMenu);this.menuOrientation=e&&e.orientation,this.darkMenu=e&&e.dark,this.menuClick=!0,this.rotateMenuButton=!this.rotateMenuButton,this.topbarMenuActive=!1,this.menuOrientation===Ae.OVERLAY?this.overlayMenuActive=!this.overlayMenuActive:this.isDesktop()?this.staticMenuDesktopInactive=!this.staticMenuDesktopInactive:this.staticMenuMobileActive=!this.staticMenuMobileActive,this.cd.detectChanges()},e.decorators=[{type:f.Component,args:[{selector:"png-admin-work-space",template:'<div class="layout-wrapper" (click)="onLayoutClick()"\n     [ngClass]="{\'menu-layout-static\': !isOverlay(),\n                \'menu-layout-overlay\': isOverlay(),\n                \'layout-menu-overlay-active\': overlayMenuActive,\n                \'menu-layout-horizontal\': isHorizontal(),\n                \'menu-layout-slim\': isSlim(),\n                \'layout-menu-static-inactive\': staticMenuDesktopInactive,\n                \'layout-menu-static-active\': staticMenuMobileActive}">\n\n  <png-ws-topbar></png-ws-topbar>\n\n  <div class="layout-menu-container" [ngClass]="{\'layout-menu-dark\':darkMenu}" (click)="onMenuClick($event)">\n    <p-scrollPanel #layoutMenuScroller [style]="{height: \'100%\' }">\n      <div class="menu-scroll-content">\n        <png-ws-profile *ngIf="profileMode==\'inline\'&&!isHorizontal()"></png-ws-profile>\n        <png-ws-main-menu [reset]="resetMenu" [httpMenuTag]="httpMenuTag"></png-ws-main-menu>\n      </div>\n    </p-scrollPanel>\n  </div>\n\n  <div class="layout-main">\n    <ng-container *ngTemplateOutlet="template(templateNames.main)"></ng-container>\n    <router-outlet></router-outlet>\n  </div>\n\n  <div class="layout-mask"></div>\n\n  <png-ws-footer></png-ws-footer>\n\n</div>\n',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:f.Renderer2},{type:f.ChangeDetectorRef}]},e.propDecorators={menuOrientation:[{type:f.Input}],darkMenu:[{type:f.Input}],appName:[{type:f.Input}],appTitle:[{type:f.Input}],appLogo:[{type:f.Input}],httpMenuTag:[{type:f.Input}],onInitMenu:[{type:f.Output}],layoutMenuScrollerViewChild:[{type:f.ViewChild,args:["layoutMenuScroller"]}]},e}(y.BaseComponent),ke=function(){function e(){}return e.decorators=[{type:f.NgModule,args:[{exports:[l.AutoCompleteModule,l.AccordionModule,l.BreadcrumbModule,l.ConfirmDialogModule,l.CardModule,l.CalendarModule,l.ChipsModule,l.CheckboxModule,l.ChartModule,l.EditorModule,l.InputTextModule,l.InputTextareaModule,l.FieldsetModule,l.DialogModule,l.ButtonModule,l.FileUploadModule,l.MessagesModule,l.KeyFilterModule,p.TableModule,l.TabViewModule,l.MultiSelectModule,l.SliderModule,l.DropdownModule,l.RadioButtonModule,l.PaginatorModule,l.TooltipModule,l.LightboxModule,l.ListboxModule,l.InputMaskModule,l.InputSwitchModule,l.CheckboxModule,l.RadioButtonModule,l.OverlayPanelModule,l.OrganizationChartModule,l.PanelModule,l.RatingModule,l.TreeModule,l.SelectButtonModule,l.SplitButtonModule,l.SpinnerModule,l.MenuModule,l.ScrollPanelModule,l.StepsModule,c.ToastModule,l.ToggleButtonModule]}]}],e}(),Ee=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t}return b(e,n),Object.defineProperty(e.prototype,"width",{get:function(){return this.column.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.column.height},enumerable:!0,configurable:!0}),e.prototype.cellContext=function(e){return{$event:e,$id:this.pngTable.$props.$id,column:this.column,row:this.row,rowIndex:this.rowIndex,pngTable:this.pngTable}},e.prototype.onMouseEnter=function(e){this.column.onMouseEnter&&this.column.onMouseEnter.call(this.pngTable,this.cellContext(e))},e.prototype.onMouseOver=function(e){this.column.onMouseOver&&this.column.onMouseOver.call(this.pngTable,this.cellContext(e))},e.prototype.onMouseOut=function(e){this.column.onMouseOut&&this.column.onMouseOut.call(this.pngTable,this.cellContext(e))},e.decorators=[{type:f.Component,args:[{selector:"[png-table-body-cell]",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:cellContext"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <png-table-body-cell-content\n        [customerTpl]="dataCellTpl"\n        [column]="column"\n        [row]="row"\n        [rowIndex]="rowIndex"\n      ></png-table-body-cell-content>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={column:[{type:f.Input}],row:[{type:f.Input}],rowIndex:[{type:f.Input}],dataCellTpl:[{type:f.Input}],width:[{type:f.HostBinding,args:["style.width"]}],height:[{type:f.HostBinding,args:["style.height"]}],onMouseEnter:[{type:f.HostListener,args:["mouseenter",["$event"]]}],onMouseOver:[{type:f.HostListener,args:["mouseover",["$event"]]}],onMouseOut:[{type:f.HostListener,args:["mouseout",["$event"]]}]},e}(y.BaseComponent),Me=function(o){function e(e,t){var n=o.call(this)||this;return n.pngTable=e,n.cell=t,n.DATA_ATTR=d.DataAttr,n.DATA_TYPE=d.DataType,n.OVERLAY_TYPE=d.OverlayType,n}return b(e,o),Object.defineProperty(e.prototype,"cellContent",{get:function(){var t=this;if(this.column.dataAttr===d.DataAttr.BUTTONS){var e=this.column.cellContent;return e=(e=x.CommonsUtils.getArrayValue(e)).filter(function(e){return!e.show||!0===e.show||!0===e.show.method||x.CommonsUtils.isFunction(e.show.method)&&e.show.method.call(t,t.cellContext())})}var n=this.getValue(this.column.cellContent||this.row[this.column.key]);return x.CommonsUtils.isEmpty(n)&&this.column.defaultCellContent!==undefined&&(n=this.column.defaultCellContent),this.column.contentKey?(n=x.CommonsUtils.get(n,this.column.contentKey),x.CommonsUtils.isArray(n)&&(n=n.join(","))):this.column.format?x.CommonsUtils.format(n,this.column.format):x.CommonsUtils.isFunction(this.column.formatter)?n=this.column.formatter(n):this.column.formatter||x.CommonsUtils.isTemplateStr(n)?n=x.CommonsUtils.templateStr(this.column.formatter||n,this.row):x.CommonsUtils.isJson(n)&&(n=y.DataFieldUtils.getFieldDisplayContent(n,this.column.dataField)),x.CommonsUtils.isString(n)&&this.column.maxLength&&n.length>this.column.maxLength&&(n=n.substr(0,this.column.maxLength)+"..."),!0===n?"是":!1===n?"否":n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellIcon",{get:function(){return this.getValue(this.column.cellIcon)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolTip",{get:function(){var e=this.getValue(this.column.toolTip);return!e&&this.column.maxLength&&this.row[this.column.key]&&this.row[this.column.key].length>this.column.maxLength?this.row[this.column.key]:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellClass",{get:function(){return x.CommonsUtils.getValue(this.column.cellStyleClass,this.cellContext())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellStyle",{get:function(){return x.CommonsUtils.getValue(this.column.cellStyle,this.cellContext())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"routLink",{get:function(){var t=this;if(this.column.routLink){var e,n=this.column.routLink;return x.CommonsUtils.isString(n)&&(n=[n]),this.column.routParam&&(x.CommonsUtils.isFunction(this.column.routParam)?e=this.column.routParam.call(this.pngTable,this.column,this.row)||[]:x.CommonsUtils.isArray(this.column.routParam)?e=this.column.routParam.map(function(e){return t.row[e]})||[]:x.CommonsUtils.isString(this.column.routParam)?e=[this.row[this.column.routParam]]:this.pngTable.$props.dataKey&&(e=[this.row[this.pngTable.$props.dataKey]])),e&&(n=$(n,e)),n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queryParam",{get:function(){var e,t=this;if(this.column.routQueryParams){if(x.CommonsUtils.isFunction(this.column.routQueryParams))return this.column.routQueryParams.call(this.pngTable,this.column,this.row);if(x.CommonsUtils.isArray(this.column.routQueryParams)){var n={};return this.column.routQueryParams.map(function(e){return n[e]=t.row[e]}),n}return x.CommonsUtils.isString(this.column.routQueryParams)?((e={})[this.column.routQueryParams]=this.row[this.column.routQueryParams],e):undefined}},enumerable:!0,configurable:!0}),e.prototype.iconClass=function(e){return e&&e.trim().startsWith("fa-")?"fa "+e:e},e.prototype.hasAttr=function(e){return this.column.dataAttr===e||x.CommonsUtils.isArray(this.column.dataAttr)&&0<=this.column.dataAttr.indexOf(e)},e.prototype.overlayContext=function(e,t,n){return C({},this.cellContext(n),{type:e.type,content:this.getValue(e.content),context:e.context,styleClass:this.getValue(e.styleClass),style:this.getValue(e.style),overlayStyleClass:this.getValue(e.overlayStyleClass),overlayStyle:this.getValue(e.overlayStyle),id:"overlay-cell-"+this.column.key+"-"+t})},e.prototype.treeContent=function(e){return x.CommonsUtils.isArray(e)?"共"+e.length+"项":x.CommonsUtils.isJson(e)?"共"+Object.keys(e).length+"项":e},e.prototype.overlayTreeContext=function(e,t){return C({},this.cellContext(t),{type:d.OverlayType.TREE,content:e})},e.prototype.cellContext=function(e){return this.cell.cellContext(e)},e.prototype.ngOnInit=function(){var n=this;this.column.overlays&&this.column.overlays.filter(function(e){return e.type===d.OverlayType.MENU}).forEach(function(e){if(e.content.menuItem.command){var t=e.content.menuItem.command;e.content.menuItem.command=function(e){return t.call(n,n.cellContext(e))}}})},e.prototype.cellClick=function(e){e.preventDefault(),this.column.onClick&&this.column.onClick.call(this.pngTable,this.cellContext(e))},e.prototype.toggleTip=function(e,t){t&&this.pngTable.showOverlay({$event:e,content:t,styleClass:"alert alert-info",style:{overflow:"auto",width:"300px",height:"300px"}})},e.prototype.getValue=function(e){return x.CommonsUtils.getValue(e,this.cellContext())||""},e.decorators=[{type:f.Component,args:[{selector:"png-table-body-cell-content",template:'<ng-container *ngIf="customerTpl;else default">\n  <ng-container *ngTemplateOutlet="customerTpl;context:cellContext()"></ng-container>\n</ng-container>\n<ng-template #default>\n  <ng-container *ngIf="column.overlays">\n    <ng-container *ngFor="let overlay of column.overlays; index as i">\n      <ng-container [ngSwitch]="overlay.type">\n        <ng-container *ngSwitchCase="OVERLAY_TYPE.CHART">\n          <i [ngClass]="overlay.icon || \'fa fa-bar-chart text-primary\'" class="pull-right"\n             title="显示图形" (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n        </ng-container>\n        <ng-container *ngSwitchCase="OVERLAY_TYPE.TABLE">\n          <i [ngClass]="overlay.icon || \'fa fa-eye text-primary\'" class="pull-right"\n             title="显示表格" (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n        </ng-container>\n        <ng-container *ngSwitchCase="OVERLAY_TYPE.PANEL">\n          <i [ngClass]="overlay.icon || \'fa fa-eye text-primary\'" class="pull-right"\n             title="显示更多信息" (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n        </ng-container>\n        <ng-container *ngSwitchCase="OVERLAY_TYPE.MENU">\n          <i [ngClass]="overlay.icon || \'fa fa-arrow-circle-down text-primary\'" class="pull-right"\n             title="显示菜单" (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n        </ng-container>\n        <ng-container *ngSwitchCase="OVERLAY_TYPE.FRAME">\n          <i [ngClass]="overlay.icon || \'fa fa-play text-primary\'"\n             title="显示更多内容" (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n        </ng-container>\n        <ng-container *ngSwitchCase="OVERLAY_TYPE.COMPONENT">\n          <i [ngClass]="overlay.icon || \'fa fa-eye text-primary\'"\n             title="显示更多内容" (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n        </ng-container>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n  <ng-container [ngSwitch]="column.dataAttr">\n    <ng-container *ngSwitchCase="DATA_ATTR.IMAGE">\n      <png-image [imageStyleClass]="cellClass"\n                 [imageStyle]="cellStyle"\n                 size="small"\n                 [fileId]="cellContent"\n                 [showDescription]="false"\n      >\n      </png-image>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.TAG">\n        <span erTag [pTooltip]="toolTip"\n              tooltipPosition="top"\n              class="pull-right"\n              [ngClass]="cellClass"\n              [ngStyle]="cellStyle">{{cellContent}}</span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.URL">\n      <a [pTooltip]="toolTip"\n         tooltipPosition="top"\n         [href]="routLink"\n         [ngClass]="cellClass"\n         [ngStyle]="cellStyle"\n         target="_blank">{{cellContent}}</a>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.COLOR">\n      <span [ngClass]="cellContent | lowercase"></span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.TREE">\n      <span class="pull-right">\n        {{treeContent(cellContent)}} <i class="fa fa-tree blue" title="查看内容"\n                                        (click)="pngTable.showOverlay(overlayTreeContext(cellContent,$event))"></i>\n      </span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.ICON">\n      <span class="pull-right"><i [ngClass]="iconClass(cellContent)"></i></span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.DATE">\n      <span>{{cellContent | date: \'yyyy-MM-dd\'}}</span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.TIME">\n      <span>{{cellContent | date: \'HH:mm:ss\'}}</span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.DATE_TIME">\n      <span>{{cellContent | date: \'yyyy-MM-dd HH:mm:ss\'}}</span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.UP_TO_NOW">\n      <ng-container *ngIf="cellContent">\n       <span erTag class="pull-right date-to-now" [pTooltip]="cellContent" tooltipPosition="top">\n        {{cellContent | erUpToNow}}\n      </span>\n        <i class="fa fa-clock-o pull-right"></i>\n      </ng-container>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.BADGE">\n      <span [pTooltip]="toolTip"\n            tooltipPosition="top"\n            class=\'pull-right badge\'\n            [ngClass]="cellClass"\n            [ngStyle]="cellStyle"\n            [innerHTML]="cellContent"></span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.CODE">\n      <span [pTooltip]="toolTip"\n            tooltipPosition="top"\n            class="pull-right data-code"\n            [ngClass]="cellClass"\n            [ngStyle]="cellStyle"\n            [innerHTML]="cellContent"></span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.PERCENT">\n      <span [innerHTML]="cellContent|erPercent"></span>\n    </ng-container>\n    <ng-container *ngSwitchCase="DATA_ATTR.BUTTONS">\n      <png-buttons [btns]="cellContent" [context]="cellContext()" [styleClass]="cellClass"\n                   [style]="cellStyle"></png-buttons>\n    </ng-container>\n    <ng-container *ngSwitchDefault>\n      <ng-container *ngIf="column.routLink || column.routParam">\n        <a [pTooltip]="toolTip" tooltipPosition="top"\n           [ngClass]="cellClass"\n           [ngStyle]="cellStyle"\n           [routerLink]="routLink" [queryParams]="queryParam"\n           [innerHTML]="cellContent"></a>\n      </ng-container>\n      <ng-container *ngIf="column.onClick">\n        <a href="#" [pTooltip]="toolTip" tooltipPosition="top"\n           [ngClass]="cellClass"\n           [ngStyle]="cellStyle"\n           (click)="cellClick($event)"\n           [innerHTML]="cellContent"></a>\n      </ng-container>\n      <ng-container *ngIf="!(column.routLink || column.routParam) && !column.onClick">\n              <span [innerHTML]="cellContent"\n                    [pTooltip]="toolTip"\n                    tooltipPosition="top"\n                    [ngClass]="cellClass"\n                    [ngStyle]="cellStyle"\n                    class="pull-right"\n                    (click)="toggleTip($event, toolTip)"\n              ></span>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n</ng-template>\n',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be},{type:Ee}]},e.propDecorators={column:[{type:f.Input}],row:[{type:f.Input}],rowIndex:[{type:f.Input}],selectors:[{type:f.ViewChildren,args:[y.SelectorDirective]}]},e}(y.BaseComponent),Ue=function(o){function e(e,t){var n=o.call(this)||this;return n.pngTable=e,n.cd=t,n}return b(e,o),Object.defineProperty(e.prototype,"rowContext",{get:function(){return{columns:this.columns,row:this.row,rowIndex:this.rowIndex,expanded:this.expanded,context:this.pngTable}},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var e=this;this.chk&&(this.$subscriptions=this.chk.tableService.selectionSource$.subscribe(function(){e.cd.detectChanges()}))},e.prototype.colContext=function(e){return C({},this.rowContext,e)},e.prototype.getColStyleClass=function(e){return x.CommonsUtils.getValue(e.styleClass,this.colContext(e))},e.prototype.getColStyle=function(e){return x.CommonsUtils.getValue(e.style,this.colContext(e))},e.decorators=[{type:f.Component,args:[{selector:"[png-table-body-row]",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:rowContext"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <tr *ngIf="rowHeaderTpl">\n        <ng-container *ngTemplateOutlet="rowHeaderTpl;context:rowContext"></ng-container>\n      </tr>\n      <td *ngIf="pngTable.$props.$ext.rowExpandable" class="col-expandable">\n        <a href="#" [pRowToggler]="row">\n          <i [ngClass]="expanded ? \'pi pi-chevron-down\' : \'pi pi-chevron-right\'"></i>\n        </a>\n      </td>\n      <td *ngIf="pngTable.$props.$ext.hasRowCheckbox" class="col-checkbox">\n        <p-tableCheckbox #chk [value]="row"></p-tableCheckbox>\n      </td>\n      <td *ngIf="pngTable.$props.$ext.hasRowRadioButton" class="col-radio">\n        <p-tableRadioButton [value]="row"></p-tableRadioButton>\n      </td>\n      <ng-container *ngFor="let col of columns">\n        <td png-table-body-cell class="col-data col-data-{{col.key}}"\n            [ngClass]="getColStyleClass(col)"\n            [ngStyle]="getColStyle(col)"\n            [customerTpl]="cellTpl"\n            [column]="col"\n            [row]="row"\n            [rowIndex]="rowIndex"\n            [dataCellTpl]="dataCellTpl"\n        >\n        </td>\n      </ng-container>\n      <tr *ngIf="rowFooterTpl">\n        <ng-container *ngTemplateOutlet="rowFooterTpl;context:rowContext"></ng-container>\n      </tr>\n    </ng-template>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be},{type:f.ChangeDetectorRef}]},e.propDecorators={columns:[{type:f.Input}],row:[{type:f.Input}],rowIndex:[{type:f.Input}],expanded:[{type:f.Input}],rowHeaderTpl:[{type:f.Input}],rowFooterTpl:[{type:f.Input}],cellTpl:[{type:f.Input}],dataCellTpl:[{type:f.Input}],chk:[{type:f.ViewChild,args:["chk"]}]},e}(y.BaseComponent),Re=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t.onSimpleSearch=new f.EventEmitter,t}return b(e,n),e.prototype.search=function(e){this.onSimpleSearch.emit(e)},e.prototype.openPanel=function(){x.StatesUtils.update(d.StateNames.popup,{header:"查询条件定义",content:this.searchBuilderPanel,visible:!0,minWidth:700,contentMaxHeight:400})},e.prototype.refresh=function(){this.pngTable.load()},e.decorators=[{type:f.Component,args:[{selector:"png-table-caption",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:{$implicit:pngTable}"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <div>\n        <span class="pull-left table-caption" [innerHTML]="caption|erSafeHtml"></span>\n        <span class="pull-right d-inline"><i class="fa fa-refresh text-primary" title="刷新表格" (click)="refresh()"></i></span>\n      </div>\n      <div class="clearfix"></div>\n      <div *ngIf="hasSearchBox || hasAddAction || hasSearchInput">\n        <div class="d-flex align-items-start">\n          <div class="pl-3 py-3" *ngIf="hasAddAction">\n            <png-button erPropsBind [props]="addButton" [outputContext]="{pngTable: pngTable}"></png-button>\n          </div>\n          <div class="ml-auto py-3" *ngIf="hasSearchInput && !hasSearchBox">\n            <png-search-box title="综合搜索，输入回车键执行" (onSearch)="search($event)"></png-search-box>\n          </div>\n          <div class="ml-auto" *ngIf="hasSearchBox">\n            <button pButton icon="fa fa-search" label="高级查询" (click)="openPanel()"></button>\n            <ng-template #searchBuilderPanel>\n              <png-table-query-builder></png-table-query-builder>\n            </ng-template>\n          </div>\n        </div>\n      </div>\n    </ng-template>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={caption:[{type:f.Input}],hasAddAction:[{type:f.Input}],hasSearchInput:[{type:f.Input}],hasSearchBox:[{type:f.Input}],addButton:[{type:f.Input}],onSimpleSearch:[{type:f.Output}],searchBuilderPanel:[{type:f.ViewChild,args:["searchBuilderPanel"]}]},e}(y.BaseComponent),Ve=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onColumnsChange=new f.EventEmitter,e}return b(e,t),e.prototype.changeColumns=function(e){e.value.forEach(function(e){return e.hidden=!1}),this.onColumnsChange.emit(e)},e.decorators=[{type:f.Component,args:[{selector:"png-table-column-selector",template:'\n\n    <p-multiSelect [style]="{height: \'30px\', minWidth: \'150px\'}"\n                   [ngClass]="styleClass"\n                   [ngStyle]="style"\n                   [options]="optionColumns"\n                   [(ngModel)]="columns"\n                   optionLabel="label"\n                   [selectedItemsLabel]="\'当前显示{0}(\'+optionColumns?.length+\')个列\'"\n                   defaultLabel="选择显示字段"\n                   (onChange)="changeColumns($event)"\n    >\n    </p-multiSelect>\n\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.propDecorators={columns:[{type:f.Input}],optionColumns:[{type:f.Input}],styleClass:[{type:f.Input}],style:[{type:f.Input}],onColumnsChange:[{type:f.Output}]},e}(y.BaseComponent),Ne=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t.customerContent=!1,t}return b(e,n),Object.defineProperty(e.prototype,"dataColumns",{get:function(){return this.columns.filter(function(e){return!1!==e.isDataColumn&&!e.isActionColumn})},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){e.rowId&&(this.pngTable.$props.$ext.onExpandRowContent?(this.customerContent=!0,this.expandContent$=this.pngTable.$props.$ext.onExpandRowContent.method(this.rowId)):this.expandContent$=y.ApiUtils.getById(this.pngTable.$props.$ext.apiDataProps.apiEntry,this.rowId,{tag:this.rowId,payload:{fields:this.pngTable.$props.$ext.expandRowFields||this.pngTable.dataColumnNames}}))},e.prototype.content=function(n,e){if(n.key){if(n.cellContent)return console.log("cellcontent"),n.cellContent({row:e});var o=e[n.key];if(x.CommonsUtils.isJson(o)){var t=void 0;if(n.dataField&&(t=y.DataFieldUtils.getDefaultFieldName(n.dataField)),t)return x.CommonsUtils.get(o,t);var a={};Object.keys(o).forEach(function(e){var t=x.CommonsUtils.get(n,"dataField.fields."+e+".label");t?a[t]=o[e]:a[e]=o[e]}),o=a}return x.CommonsUtils.getText(o)}},e.decorators=[{type:f.Component,args:[{selector:"[png-table-expanded-row]",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:{$implicit:rowId,context:pngTable}"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <td colspan="100%">\n        <p-card styleClass="ui-card-shadow w-100 ui-table-expanded-content" >\n          <er-http-status [tag]="rowId" erPosition></er-http-status>\n          <ng-container *ngIf="expandContent$|async as expandContent">\n            <div class="row w-100 m-3" style="font-size: 16px">\n              <ng-container *ngIf="!customerContent">\n                <ng-container *ngFor="let col of dataColumns">\n                  <span class="col-2 my-3"><b class="pull-right" [innerHTML]="col.label"></b></span>\n                  <ng-container *ngIf="col.expandViewContent;else defaultView">\n                    <er-dyna-content [content]="col.expandViewContent" [context]="{data: expandContent, col: col}"></er-dyna-content>\n                  </ng-container>\n                  <ng-template #defaultView>\n                    <span class="col-4 my-3">{{content(col, expandContent)}}</span>\n                  </ng-template>\n                </ng-container>\n              </ng-container>\n              <ng-container *ngIf="customerContent">\n                <er-dyna-content [content]="expandContent"></er-dyna-content>\n              </ng-container>\n            </div>\n          </ng-container>\n        </p-card>\n      </td>\n    </ng-template>\n\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={rowId:[{type:f.Input}],columns:[{type:f.Input}],styleClass:[{type:f.Input}],style:[{type:f.Input}]},e}(y.BaseComponent),Le=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t}return b(e,n),e.decorators=[{type:f.Component,args:[{selector:"tr[png-table-footer]",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl; context:{columns:columns,context:pngTable}"></ng-container>\n    </ng-container>\n    <ng-template #default></ng-template>\n  '}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={columns:[{type:f.Input}]},e}(y.BaseComponent),Be=function(o){function e(e,t){var n=o.call(this)||this;return n.pngTable=e,n.cd=t,n.OVERLAY_TYPE=d.OverlayType,n.onFilterBtnClick=new f.EventEmitter,n.onAggsBtnClick=new f.EventEmitter,n}return b(e,o),Object.defineProperty(e.prototype,"colClass",{get:function(){return x.CommonsUtils.isFunction(this.column.colClass)?this.column.colClass.call(this.pngTable,this.column):this.column.colClass||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.column.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colStyle",{get:function(){return x.CommonsUtils.isFunction(this.column.colStyle)?this.column.colStyle.call(this.pngTable,this.column):this.column.colStyle||""},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var n=this;this.column.headerOverlays&&this.column.headerOverlays.filter(function(e){return e.type===d.OverlayType.MENU}).forEach(function(e){if(e.content.menuItem.command){var t=e.content.menuItem.command;e.content.menuItem.command=function(e){return t.call(n,n.headerContext(e))}}})},e.prototype.filterClick=function(e){this.onFilterBtnClick.emit({event:e,column:this.column})},e.prototype.aggsClick=function(e){this.onAggsBtnClick.emit({$event:e,column:this.column})},e.prototype.headerContext=function(e){return{$event:e,$id:this.pngTable.$props.$id,column:this.column,pngTable:this.pngTable}},e.prototype.overlayContext=function(e,t,n){return{$event:n,type:e.type,content:x.CommonsUtils.getValue(e.content,this.headerContext(n)),context:e.context,styleClass:x.CommonsUtils.getValue(e.styleClass,this.headerContext(n)),style:x.CommonsUtils.getValue(e.style,this.headerContext(n)),overlayStyleClass:x.CommonsUtils.getValue(e.overlayStyleClass,this.headerContext(n)),overlayStyle:x.CommonsUtils.getValue(e.overlayStyle,this.headerContext(n)),id:"overlay-header-"+this.column.key+"-"+t}},e.decorators=[{type:f.Component,args:[{selector:"[png-table-header-col]",template:'\n    <span *ngIf="!column.sortable" [innerHTML]="column.label|erSafeHtml"></span>\n    <span *ngIf="column.sortable" title="排序" [pSortableColumn]="column.key" [innerHTML]="column.label|erSafeHtml"></span>\n    <p-sortIcon *ngIf="column.sortable" [field]="column.key"></p-sortIcon>\n    <span *ngIf="column.filterable" class="pull-right">\n              <i class="fa fa-filter" title="输入查询内容" [ngClass]="{\'ui-state-highlight\': column.filters && column.filters.length>0}"\n                 (click)="filterClick($event)"></i>\n            </span>\n    <span *ngIf="column.aggable" class="pull-right">\n              <i class="fa fa-sum" title="选择统计方法" [ngClass]="{\'ui-state-highlight\': column.aggProps && column.aggProps.length>0}"\n                 (click)="aggsClick($event)"></i>\n            </span>\n    <ng-container *ngIf="column.headerOverlays">\n      <ng-container *ngFor="let overlay of column.headerOverlays; index as i">\n        <ng-container [ngSwitch]="overlay.type">\n          <ng-container *ngSwitchCase="OVERLAY_TYPE.CHART">\n            <i [ngClass]="overlay.icon || \'fa fa-bar-chart text-primary\'" class="pull-right"\n               (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n          </ng-container>\n          <ng-container *ngSwitchCase="OVERLAY_TYPE.TABLE">\n            <i [ngClass]="overlay.icon || \'fa fa-eye text-primary\'" class="pull-right"\n               (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n          </ng-container>\n          <ng-container *ngSwitchCase="OVERLAY_TYPE.PANEL">\n            <i [ngClass]="overlay.icon || \'fa fa-eye text-primary\'" class="pull-right"\n               (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n          </ng-container>\n          <ng-container *ngSwitchCase="OVERLAY_TYPE.MENU">\n            <i [ngClass]="overlay.icon || \'fa fa-arrow-circle-down text-primary\'" class="pull-right"\n               (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n          </ng-container>\n          <ng-container *ngSwitchCase="OVERLAY_TYPE.FRAME">\n            <i [ngClass]="overlay.icon || \'fa fa-play text-primary\'"\n               (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n          </ng-container>\n          <ng-container *ngSwitchCase="OVERLAY_TYPE.COMPONENT">\n            <i [ngClass]="overlay.icon || \'fa fa-eye text-primary\'"\n               (click)="pngTable.showOverlay(overlayContext(overlay,i,$event))"></i>\n          </ng-container>\n        </ng-container>\n      </ng-container>\n    </ng-container>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be},{type:f.ChangeDetectorRef}]},e.propDecorators={column:[{type:f.Input}],onFilterBtnClick:[{type:f.Output}],onAggsBtnClick:[{type:f.Output}],colClass:[{type:f.HostBinding,args:["class"]}],width:[{type:f.HostBinding,args:["style.width"]}],colStyle:[{type:f.HostBinding,args:["style"]}]},e}(y.BaseComponent),Fe=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t.onFiltersSet=new f.EventEmitter,t.onAggKeysSet=new f.EventEmitter,t}return b(e,n),e.prototype.showFilterPanel=function(e){this.filterColumn=e.column;var t=this.filterColumn.filters;t&&0<t.length?this.queryValue=t[0]:this.queryValue=undefined,this.filterPanel.toggle(e.event)},e.prototype.clearFilterColumn=function(){this.filterColumn=undefined},e.prototype.clearAggColumn=function(){this.aggColumn=undefined},e.prototype.showAggsPanel=function(e){var t=this;this.availableAggs=[],this.aggColumn=e.column;var n=this.aggColumn.dataType||d.DataType.STRING;this.aggMethods=(this.aggColumn.aggProps||[]).map(function(e){return e.method}),Object.keys(d.AggMethodsProps).forEach(function(e){(!d.AggMethodsProps[e].dataTypes||d.AggMethodsProps[e].dataTypes&&0<=d.AggMethodsProps[e].dataTypes.indexOf(n))&&t.availableAggs.push({label:d.AggMethodsProps[e].label,key:d.AggMethodsProps[e].key})}),this.aggPanel.toggle(e.$event)},e.prototype.setAggs=function(){this.onAggKeysSet.emit({column:this.aggColumn,methods:this.aggMethods})},e.prototype.updateFilters=function(e){this.filterPanel.hide(),this.onFiltersSet.emit(e)},e.decorators=[{type:f.Component,args:[{selector:"[png-table-header]",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:{$implicit:columns,context:pngTable}"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <th *ngIf="pngTable.$props.$ext.rowExpandable" class="col-expandable"></th>\n      <th *ngIf="pngTable.$props.$ext.hasRowCheckbox" class="col-checkbox" title="全选">\n        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>\n      </th>\n      <th *ngIf="pngTable.$props.$ext.hasRowRadioButton" class="col-radio"></th>\n      <th *ngFor="let column of columns" pReorderableColumn pResizableColumn\n          png-table-header-col\n          [column]="column"\n          (onFilterBtnClick)="showFilterPanel($event)"\n          (onAggsBtnClick)="showAggsPanel($event)"\n      >\n      </th>\n    </ng-template>\n    <div class="d-none">\n      <p-overlayPanel #filterPanel appendTo="body"\n                      [dismissable]="false" (onHide)="clearFilterColumn()"\n                      [showCloseIcon]="true">\n        <ng-container *ngIf="filterColumn">\n          <png-field-data-filter [column]="filterColumn" [queryValue]="queryValue"\n                                 (onFilterChange)="updateFilters($event)"></png-field-data-filter>\n        </ng-container>\n      </p-overlayPanel>\n      <p-overlayPanel #aggPanel appendTo="body"\n                      [dismissable]="true" (onHide)="clearAggColumn()"\n                      [showCloseIcon]="true">\n        <div class="shadow" style="width:150px;margin-bottom:10px">\n          <h6>可选统计方式</h6>\n          <ng-container *ngFor="let agg of availableAggs">\n            <div style="font-size: .8em">\n              <p-checkbox name="aggs" [value]="agg[\'key\']" [label]="agg[\'label\']"\n                          [(ngModel)]="aggMethods" (onChange)="setAggs()"></p-checkbox>\n            </div>\n          </ng-container>\n        </div>\n      </p-overlayPanel>\n    </div>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={columns:[{type:f.Input}],onFiltersSet:[{type:f.Output}],onAggKeysSet:[{type:f.Output}],filterPanel:[{type:f.ViewChild,args:["filterPanel"]}],aggPanel:[{type:f.ViewChild,args:["aggPanel"]}]},e}(y.BaseComponent),He=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t.onFilterChange=new f.EventEmitter,t}return b(e,n),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},set:function(e){!this.queryKey&&e&&(this.queryKey=y.DataFieldUtils.getDefaultFieldName(e.dataField)||e.key),!this.queryDataType&&e&&(this.queryDataType=e.filterDataType||e.dataType),!this.queryDataAttr&&e&&e.dataAttr&&(this.queryDataAttr=x.CommonsUtils.getArrayValue(e.dataAttr)[0]),this._column=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataField",{get:function(){return this._dataField},set:function(e){!this.queryKey&&e&&(this.queryKey=y.DataFieldUtils.getDefaultFieldName(e)),!this.queryDataType&&e&&(this.queryDataType=e.dataType),this._dataField=e},enumerable:!0,configurable:!0}),e.prototype.onFilter=function(){this.onFilterChange.emit({key:this.queryKey,column:this.column,value:this.queryValue})},e.prototype.clearFilter=function(){this.queryValue=undefined,this.onFilter()},e.decorators=[{type:f.Component,args:[{selector:"png-field-data-filter",template:'\n    <div class="d-flex justify-content-end align-items-end">\n      <png-query-input [queryKey]="queryKey" [queryDataType]="queryDataType" [queryDataAttr]="queryDataAttr"\n                       [(queryValue)]="queryValue"></png-query-input>\n      <ng-container *ngIf="queryValue">\n      <span class="ml-2">\n       <p-button\n         type="button"\n         icon="fa fa-search"\n         label="查询"\n         (click)="onFilter()"\n       ></p-button>\n    </span>\n        <span class="ml-2">\n    <p-button\n      type="button"\n      icon="fa fa-trash"\n      label="清除"\n      (click)="clearFilter()"\n    ></p-button>\n    </span>\n      </ng-container>\n    </div>\n  '}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={queryKey:[{type:f.Input}],queryDataType:[{type:f.Input}],queryDataAttr:[{type:f.Input}],queryValue:[{type:f.Input}],onFilterChange:[{type:f.Output}],column:[{type:f.Input}],dataField:[{type:f.Input}]},e}(y.BaseComponent),_e=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t.qbConfig={},t.switches=[{label:"并且",value:"and",icon:"fa fa-fw fa-cc-paypal"},{label:"或者",value:"or",icon:"fa fa-fw fa-cc-visa"},{label:"非",value:"not",icon:"fa fa-fw fa-cc-mastercard"}],t}return b(e,n),e.prototype.ngOnInit=function(){this.qbConfig.fields=this.pngTable.$props.columns.filter(function(e){return e.dataField}).map(function(e){return e.dataField}),this.qbConfig.operators=function(e){return Object.keys(d.EsQueryMethods).map(function(e){return{label:d.EsQueryMethods[e].label,value:d.EsQueryMethods[e].key}})}},e.decorators=[{type:f.Component,args:[{selector:"png-table-query-builder",template:'\n    <er-query-builder [config]="qbConfig">\n      \x3c!--<ng-template erTypedTemplate="switchGroup" let-qb="qb">--\x3e\n      \x3c!--<p-selectButton [options]="switches" [ngModel]="qb.value.condition"></p-selectButton>--\x3e\n      \x3c!--</ng-template>--\x3e\n      \x3c!--<ng-template erTypedTemplate="buttonGroup" let-qb="qb">--\x3e\n      \x3c!--<p-button label="条件" icon="fa fa-plus" (onClick)="qb.addRule()"></p-button>--\x3e\n      \x3c!--<p-button label="组" icon="fa fa-group" (onClick)="qb.addRuleSet()"></p-button>--\x3e\n      \x3c!--<ng-container *ngIf="!!parentRuleSet && qb.config.allowRuleSet">--\x3e\n      \x3c!--<p-button icon="fa fa-minus" (onClick)="qb.removeRuleSet()"></p-button>--\x3e\n      \x3c!--</ng-container>--\x3e\n      \x3c!--</ng-template>--\x3e\n      <ng-template erTypedTemplate="input" let-rule let-qb="qb">\n        <png-query-input [options]="pngTable.$props.$ext"></png-query-input>\n      </ng-template>\n    </er-query-builder>\n  ',providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:f.forwardRef(function(){return e}),multi:!0}],changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be}]},e}(y.BaseComponent),qe=function(n){function e(e){var t=n.call(this)||this;return t.pngTable=e,t.DATA_TYPE=d.DataType,t.DATA_ATTR=d.DataAttr,t.options={},t.queryValueChange=new f.EventEmitter,t.isTime=!1,t.autoCompleteProps$=new u.BehaviorSubject(undefined),t}return b(e,n),Object.defineProperty(e.prototype,"queryValue",{get:function(){return this._queryValue},set:function(e){this._queryValue=e,this.queryValueChange.emit(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){if(n.prototype.ngOnInit.call(this),this.autoProps={inputStyle:{"min-width":"200px"},appendTo:"body",forceSelection:!1,$ext:{apiDataProps:C({},this.pngTable.getTableQuery(),{searchFields:this.queryKey,returnFields:this.queryKey,aggProps:{name:this.queryKey,field:this.queryKey},dataPath:"aggs."+this.queryKey}),dataItemProps:{showCounter:!0,dropDownOptionKey:x.DataItemUtils.ITEM_LABEL_KEY,valueKey:x.DataItemUtils.ITEM_LABEL_KEY}}},this.sliderProps={range:!0,$ext:{apiDataProps:C({},this.pngTable.getTableQuery(),{aggProps:[{name:"max",field:this.queryKey,method:d.AggMethods.MAX},{name:"min",field:this.queryKey,method:d.AggMethods.MIN}]})}},this.queryDataType===d.DataType.DATE&&this.queryDataAttr){var e=x.CommonsUtils.getArrayValue(this.queryDataAttr);0<=e.indexOf(d.DataAttr.DATE)&&(this.isTime=!1),0<=e.indexOf(d.DataAttr.TIME)&&(this.isTime=!0)}},e.decorators=[{type:f.Component,args:[{selector:"png-query-input",template:'\n    <ng-container [ngSwitch]="queryDataType">\n      <ng-container *ngSwitchCase="DATA_TYPE.NUMBER">\n        <png-slider [(ngModel)]="queryValue"\n                    erPropsBind\n                    [props]="sliderProps"\n        >\n        </png-slider>\n      </ng-container>\n      <ng-container *ngSwitchCase="DATA_TYPE.BOOLEAN">\n        <p-inputSwitch [(ngModel)]="queryValue">\n        </p-inputSwitch>\n      </ng-container>\n      <ng-container *ngSwitchCase="DATA_TYPE.DATE">\n        <ng-container *ngIf="!isTime">\n          <png-calendar erPropsBind [(ngModel)]="queryValue"\n                        [props]="{ selectionMode: \'range\',placeholder:\'请选择日期\'}">\n          </png-calendar>\n        </ng-container>\n        <ng-container *ngIf="isTime">\n          <png-calendar erPropsBind [(ngModel)]="queryValue"\n                        [props]="{ timeOnly: true, selectionMode: \'range\',placeholder:\'请选择时间\'}"\n          >\n          </png-calendar>\n        </ng-container>\n      </ng-container>\n      <ng-container *ngSwitchDefault>\n        <png-auto-complete\n          [(ngModel)]="queryValue"\n          erPropsBind\n          [props]="autoProps"\n        >\n        </png-auto-complete>\n        \x3c!--<input type="text" pInputText [(ngModel)]="queryValue" placeholder="输入查询标准">--\x3e\n      </ng-container>\n    </ng-container>\n  ',styles:["/deep/ .ui-multiselect{min-width:150px}/deep/ .ui-multiselect-label-container label{margin:0!important}/deep/ .ui-slider{width:100px;margin:5px}"]}]}],e.ctorParameters=function(){return[{type:be}]},e.propDecorators={queryKey:[{type:f.Input}],queryDataType:[{type:f.Input}],queryDataAttr:[{type:f.Input}],options:[{type:f.Input}],autoProps:[{type:f.Input}],sliderProps:[{type:f.Input}],queryValueChange:[{type:f.Output}],queryValue:[{type:f.Input}]},e}(y.BaseComponent),ze=function(o){function e(e,t){var n=o.call(this)||this;return n.pngTable=e,n.cd=t,n}return b(e,o),e.prototype.ngOnChanges=function(e){var i=this;e.aggValues&&(e.aggValues.currentValue?(this.colAggValues={},Object.keys(e.aggValues.currentValue).forEach(function(e){var t=e;0<e.indexOf("-")&&(t=e.substr(0,e.indexOf("-")));var n=e.substr(e.indexOf("-")+1),o=i.colAggValues[t];o||(o=[],i.colAggValues[t]=o);var a={};a.type=d.AggMethodsProps[n]&&d.AggMethodsProps[n].label,x.CommonsUtils.isArray(i.aggValues[e])?a.values=i.aggValues[e]:a.value=i.aggValues[e],o.push(a)})):this.colAggValues=undefined,this.cd.detectChanges())},e.prototype.cellClass=function(e){return x.CommonsUtils.getValue(e.aggCellClass,e)},e.prototype.cellStyle=function(e){return x.CommonsUtils.getValue(e.aggCellStyle,e)},e.decorators=[{type:f.Component,args:[{selector:"[png-table-summary]",template:'\n    <ng-container *ngIf="customerTpl;else default">\n      <ng-container *ngTemplateOutlet="customerTpl;context:{$implicit:aggValues,columns:columns,context:pngTable}"></ng-container>\n    </ng-container>\n    <ng-template #default>\n      <th *ngIf="pngTable.$props.$ext.rowExpandable" class="col-expandable col-summary"></th>\n      <th *ngIf="pngTable.$props.$ext.hasRowCheckbox" class="col-checkbox col-summary"></th>\n      <th *ngIf="pngTable.$props.$ext.hasRowRadioButton" class="col-radio col-summary"></th>\n      <ng-container *ngIf="colAggValues">\n        <th *ngFor="let col of columns" [width]="col.width" class="text-right col-summary col-summary-{{col.key}}">\n          <ng-container *ngFor="let agg of colAggValues[col.key]">\n            <ng-container *ngIf="agg.value">\n              <div [ngClass]="cellClass(col)" style="font-size: 0.8em"\n                   [ngStyle]="cellStyle(col)">{{agg.type}}: {{agg.value | floor: 2}}\n              </div>\n            </ng-container>\n            <ng-container *ngIf="agg.values">\n              <div [ngClass]="cellClass(col)" style="font-size: 0.8em"\n                   [ngStyle]="cellStyle(col)"> {{agg.type}}:\n              </div>\n              <ul>\n                <ng-container *ngFor="let data of agg.values">\n                  <li class="border-bottom"><span class="">{{data.label}}:</span><span class="badge badge-pill btn-info">{{data.value}}</span></li>\n                </ng-container>\n              </ul>\n            </ng-container>\n          </ng-container>\n        </th>\n      </ng-container>\n    </ng-template>\n\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:be},{type:f.ChangeDetectorRef}]},e.propDecorators={columns:[{type:f.Input}],aggValues:[{type:f.Input}]},e}(y.BaseComponent),Ke=[Re,Fe,Be,He,Ue,Me,Ee,Ne,Le,ze,Ve,_e,qe],je=function(){function e(){}return e.decorators=[{type:f.NgModule,args:[{imports:[g.FormsModule,g.ReactiveFormsModule,y.ErCoreModule,ke],declarations:$(Oe,Ke),exports:$([ke],Oe),entryComponents:Oe}]}],e}(),Ye=function(){function e(e){this.ws=e}return Object.defineProperty(e.prototype,"elapseTime$",{get:function(){return x.StatesUtils.observe(d.StateNames.httpTimer).pipe(m.distinctUntilChanged(),m.map(function(e){return e&&e.elapsed}))},enumerable:!0,configurable:!0}),e.decorators=[{type:f.Component,args:[{selector:"png-ws-footer",template:'<div class="layout-footer">\n  <span class="footer-text-left">\n     <img [src]="ws.appLogo"/>\n  </span>\n  <span class="footer-text-right">\n    <span class="text-muted small" *ngIf="elapseTime$|async as elapseTime">网络访问耗时：{{elapseTime}}毫秒</span>\n  </span>\n</div>\n',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:De}]},e}(),We=function(){function e(e){this.ws=e}return e.prototype.toggleMainMenu=function(){x.StatesUtils.toggle(d.StateNames.menu,this.ws.rootMenuToggleStateName),event.preventDefault()},e.decorators=[{type:f.Component,args:[{selector:"png-ws-topbar",template:'<div class="topbar clearfix">\n  <div class="topbar-left">\n    <img [src]="ws.appLogo" class="topbar-logo"/>\n    <span class="topbar-title">{{ws.appTitle}}</span>\n  </div>\n\n  <div class="topbar-right">\n    <a id="menu-button" href="#" (click)="toggleMainMenu()"\n       [ngClass]="{\'menu-button-rotate\': ws.rotateMenuButton}">\n      <i class="fa fa-angle-left"></i>\n    </a>\n\n    <a id="topbar-menu-button" href="#" (click)="ws.onTopbarMenuButtonClick($event)">\n      <i class="fa fa-bars"></i>\n    </a>\n\n    <span [innerHTML]="ws.appName|erSafeHtml"></span>\n\n    <ul class="topbar-items fadeInDown" [ngClass]="{\'topbar-items-visible\': ws.topbarMenuActive}">\n      \x3c!--<li #profile class="profile-item" *ngIf="ws.profileMode===\'top\'||ws.isHorizontal()"--\x3e\n      \x3c!--[ngClass]="{\'active-top-menu\':ws.activeTopbarItem === profile}">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarItemClick($event,profile)">--\x3e\n      \x3c!--<img class="profile-image" src="assets/layout/images/avatar.png" />--\x3e\n      \x3c!--<span class="topbar-item-name">Isabel Lopez</span>--\x3e\n      \x3c!--<span class="topbar-item-role">Marketing</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--<ul class="layout-menu fadeInDown">--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-user"></i>--\x3e\n      \x3c!--<span>Profile</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-user-secret"></i>--\x3e\n      \x3c!--<span>Privacy</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-cog"></i>--\x3e\n      \x3c!--<span>Settings</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-sign-out"></i>--\x3e\n      \x3c!--<span>Logout</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--</ul>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li #settings [ngClass]="{\'active-top-menu\':ws.activeTopbarItem === settings}">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarItemClick($event,settings)">--\x3e\n      \x3c!--<i class="topbar-icon fa fa-fw fa-cog"></i>--\x3e\n      \x3c!--<span class="topbar-item-name">Settings</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--<ul class="layout-menu fadeInDown">--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-paint-brush"></i>--\x3e\n      \x3c!--<span>Change Theme</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-star-o"></i>--\x3e\n      \x3c!--<span>Favorites</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-lock"></i>--\x3e\n      \x3c!--<span>Lock Screen</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-picture-o"></i>--\x3e\n      \x3c!--<span>Wallpaper</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--</ul>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li #messages [ngClass]="{\'active-top-menu\':ws.activeTopbarItem === messages}">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarItemClick($event,messages)">--\x3e\n      \x3c!--<i class="topbar-icon animated swing fa fa-fw fa-envelope-o"></i>--\x3e\n      \x3c!--<span class="topbar-badge animated rubberBand">5</span>--\x3e\n      \x3c!--<span class="topbar-item-name">Messages</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--<ul class="layout-menu fadeInDown">--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" class="topbar-message" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<img src="assets/layout/images/avatar1.png" width="35"/>--\x3e\n      \x3c!--<span>Give me a call</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" class="topbar-message" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<img src="assets/layout/images/avatar2.png" width="35"/>--\x3e\n      \x3c!--<span>Sales reports attached</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" class="topbar-message" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<img src="assets/layout/images/avatar3.png" width="35"/>--\x3e\n      \x3c!--<span>About your invoice</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" class="topbar-message" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<img src="assets/layout/images/avatar2.png" width="35"/>--\x3e\n      \x3c!--<span>Meeting today at 10pm</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" class="topbar-message" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<img src="assets/layout/images/avatar4.png" width="35"/>--\x3e\n      \x3c!--<span>Out of office</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--</ul>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li #notifications [ngClass]="{\'active-top-menu\':ws.activeTopbarItem === notifications}">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarItemClick($event,notifications)">--\x3e\n      \x3c!--<i class="topbar-icon fa fa-fw fa-bell-o"></i>--\x3e\n      \x3c!--<span class="topbar-badge animated rubberBand">4</span>--\x3e\n      \x3c!--<span class="topbar-item-name">Notifications</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--<ul class="layout-menu fadeInDown">--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-tasks"></i>--\x3e\n      \x3c!--<span>Pending tasks</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-calendar-check-o"></i>--\x3e\n      \x3c!--<span>Meeting today at 3pm</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-download"></i>--\x3e\n      \x3c!--<span>Download documents</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--<li role="menuitem">--\x3e\n      \x3c!--<a href="#" (click)="ws.onTopbarSubItemClick($event)">--\x3e\n      \x3c!--<i class="fa fa-fw fa-plane"></i>--\x3e\n      \x3c!--<span>Book flight</span>--\x3e\n      \x3c!--</a>--\x3e\n      \x3c!--</li>--\x3e\n      \x3c!--</ul>--\x3e\n      \x3c!--</li>--\x3e\n      <li #search class="search-item" [ngClass]="{\'active-top-menu\':ws.activeTopbarItem === search}"\n          (click)="ws.onTopbarItemClick($event,search)">\n        <div class="topbar-search">\n          <input type="text" style="border-radius: 15px" placeholder="请输入搜索关键字" />\n          <i class="fa fa-search"></i>\n        </div>\n      </li>\n    </ul>\n  </div>\n</div>\n',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:De}]},e}(),Qe=function(){function e(e){this.ws=e,this.theme="blue",this.layout="blue",this.version="v4"}return e.prototype.ngOnInit=function(){this.menus$=x.StatesUtils.observe(d.StateNames.rootMenu).pipe(m.map(function(e){return e&&e.menuItems||[]}),m.distinctUntilChanged())},e.prototype.changeTheme=function(e){var t=document.getElementById("theme-css");"v3"===this.version?t.href="assets/theme/theme-"+e+".css":t.href="assets/theme/theme-"+e+"-v4.css",this.theme=e},e.prototype.changeLayout=function(e,t){var n=document.getElementById("layout-css");"v3"===this.version?n.href="assets/layout/css/layout-"+e+".css":n.href="assets/layout/css/layout-"+e+"-v4.css",this.layout=e,t&&(this.ws.darkMenu=!0)},e.prototype.changeVersion=function(e){var t=document.getElementById("theme-css"),n=document.getElementById("layout-css");"v3"===e?(this.version="v3",t.href="assets/theme/theme-"+this.theme+".css",n.href="assets/layout/css/layout-"+this.layout+".css"):(t.href="assets/theme/theme-"+this.theme+"-v4.css",n.href="assets/layout/css/layout-"+this.layout+"-v4.css",this.version="-v4")},e.decorators=[{type:f.Component,args:[{selector:"png-ws-main-menu",template:'\n    <ul png-ws-sub-menu\n        erAnimate="fadeInDown"\n        class="layout-menu layout-main-menu clearfix"\n        [erHttpState]="httpMenuTag"\n        [item]="menus$|async" [root]="true"\n        [reset]="reset"\n        [visible]="true"\n        [parentActive]="true"></ul>\n  ',changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:De}]},e.propDecorators={reset:[{type:f.Input}],httpMenuTag:[{type:f.Input}]},e}(),Ge=function(){function e(e,t){this.ws=e,this.wsMenu=t}return Object.defineProperty(e.prototype,"reset",{get:function(){return this._reset},set:function(e){this._reset=e,this._reset&&(this.ws.isHorizontal()||this.ws.isSlim())&&(this.activeIndex=null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentActive",{get:function(){return this._parentActive},set:function(e){this._parentActive=e,this._parentActive||(this.activeIndex=null)},enumerable:!0,configurable:!0}),e.prototype.itemClick=function(e,t,n){var o=this;if(this.root&&(this.ws.menuHoverActive=!this.ws.menuHoverActive),t.disabled)return e.preventDefault(),!0;this.activeIndex=this.activeIndex===n?null:n,t.command&&t.command({originalEvent:e,item:t,menu:this.wsMenu,ws:this.ws}),(t.items||!t.url&&!t.routerLink)&&(setTimeout(function(){o.ws.layoutMenuScrollerViewChild.moveBar()},450),e.preventDefault()),t.items||(this.ws.isHorizontal()||this.ws.isSlim()?this.ws.resetMenu=!0:this.ws.resetMenu=!1,this.ws.overlayMenuActive=!1,this.ws.staticMenuMobileActive=!1,this.ws.menuHoverActive=!this.ws.menuHoverActive)},e.prototype.onMouseEnter=function(e){this.root&&this.ws.menuHoverActive&&(this.ws.isHorizontal()||this.ws.isSlim())&&!this.ws.isMobile()&&!this.ws.isTablet()&&(this.activeIndex=e)},e.prototype.isActive=function(e){return this.activeIndex===e},e.decorators=[{type:f.Component,args:[{selector:"[png-ws-sub-menu]",template:'<ng-template ngFor let-child let-i="index" [ngForOf]="(root ? item : item.items)">\n  <li [ngClass]="{\'active-menuitem\': isActive(i)}" [class]="child.badgeStyleClass"\n      *ngIf="child.visible === false ? false : true">\n    <a [href]="child.url||\'#\'" (click)="itemClick($event,child,i)" (mouseenter)="onMouseEnter(i)"\n       class="ripplelink" *ngIf="!child.routerLink"\n       [attr.tabindex]="!visible ? \'-1\' : null" [attr.target]="child.target">\n      <i [ngClass]="child.icon"></i><span>{{child.label}}</span>\n      <i class="fa fa-fw fa-angle-down menuitem-toggle-icon" *ngIf="child.items"></i>\n      <span class="menuitem-badge" *ngIf="child.badge">{{child.badge}}</span>\n    </a>\n\n    <a (click)="itemClick($event,child,i)" (mouseenter)="onMouseEnter(i)" class="ripplelink" *ngIf="child.routerLink"\n       [routerLink]="child.routerLink" routerLinkActive="active-menuitem-routerlink"\n       [routerLinkActiveOptions]="{exact: true}" [attr.tabindex]="!visible ? \'-1\' : null" [attr.target]="child.target">\n      <i [ngClass]="child.icon"></i><span>{{child.label}}</span>\n      <i class="fa fa-fw fa-angle-down menuitem-toggle-icon" *ngIf="child.items"></i>\n      <span class="menuitem-badge" *ngIf="child.badge">{{child.badge}}</span>\n    </a>\n    <div class="layout-menu-tooltip">\n      <div class="layout-menu-tooltip-arrow"></div>\n      <div class="layout-menu-tooltip-text">{{child.label}}</div>\n    </div>\n    <div class="submenu-arrow" *ngIf="child.items"></div>\n    <ul png-ws-sub-menu [item]="child" *ngIf="child.items" [visible]="isActive(i)" [reset]="reset"\n        [parentActive]="isActive(i)"\n        [@children]="(ws.isSlim()||ws.isHorizontal())&&root ? isActive(i) ?\n                     \'visible\' : \'hidden\' : isActive(i) ? \'visibleAnimated\' : \'hiddenAnimated\'"></ul>\n  </li>\n</ng-template>',animations:[h.trigger("children",[h.state("hiddenAnimated",h.style({height:"0px"})),h.state("visibleAnimated",h.style({height:"*"})),h.state("visible",h.style({display:"block"})),h.state("hidden",h.style({display:"none"})),h.transition("visibleAnimated => hiddenAnimated",h.animate("400ms cubic-bezier(0.86, 0, 0.07, 1)")),h.transition("hiddenAnimated => visibleAnimated",h.animate("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])],changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:De},{type:Qe}]},e.propDecorators={item:[{type:f.Input}],root:[{type:f.Input}],visible:[{type:f.Input}],reset:[{type:f.Input}],parentActive:[{type:f.Input}]},e}(),Ze=function(){function e(e){this.ws=e,this.profileRouter=x.ConfigUtils.getConfig().auth.profileRouter,this.changePwdRouter=x.ConfigUtils.getConfig().auth.changePwdRouter,this.avatar="assets/layout/images/avatar.png"}return Object.defineProperty(e.prototype,"user",{get:function(){return y.AuthUtils.getCurrentUser()},enumerable:!0,configurable:!0}),e.prototype.onClick=function(e){this.active=!this.active,e.preventDefault()},e.prototype.logout=function(){y.AuthUtils.logout()},e.prototype.change=function(){y.RouteUtils.nav(this.changePwdRouter)},e.decorators=[{type:f.Component,args:[{selector:"png-ws-profile",template:'<div class="profile" [ngClass]="{\'profile-expanded\':active}">\n  <a href="#" (click)="onClick($event)">\n    <img class="profile-image" [src]="user?.avatar || avatar"/>\n    <span class="profile-name">{{user?.fullName}}</span>\n    <i class="fa fa-fw fa-caret-down"></i>\n    <span class="profile-role">{{user?.mainRole}}</span>\n  </a>\n</div>\n\n<ul id="profile-menu" class="layout-menu" [@menu]="active ? \'visible\' : \'hidden\'">\n  <li role="menuitem">\n    <a href="#" [routerLink]="profileRouter" [attr.tabindex]="!active ? \'-1\' : null">\n      <i class="fa fa-fw fa-user"></i>\n      <span>个人信息</span>\n    </a>\n    <div class="layout-menu-tooltip">\n      <div class="layout-menu-tooltip-arrow"></div>\n      <div class="layout-menu-tooltip-text"><a [routerLink]="profileRouter">个人信息</a></div>\n    </div>\n  </li>\n  <li role="menuitem">\n    <a href="#" [routerLink]="changePwdRouter" [attr.tabindex]="!active ? \'-1\' : null">\n      <i class="fa fa-fw fa-user-secret"></i>\n      <span>修改密码</span>\n    </a>\n    <div class="layout-menu-tooltip">\n      <div class="layout-menu-tooltip-arrow"></div>\n      <div class="layout-menu-tooltip-text"><a [routerLink]="changePwdRouter">修改密码</a></div>\n    </div>\n  </li>\n  \x3c!--<li role="menuitem">--\x3e\n  \x3c!--<a href="#" [attr.tabindex]="!active ? \'-1\' : null">--\x3e\n  \x3c!--<i class="fa fa-fw fa-cog"></i>--\x3e\n  \x3c!--<span>个性设置</span>--\x3e\n  \x3c!--</a>--\x3e\n  \x3c!--<div class="layout-menu-tooltip">--\x3e\n  \x3c!--<div class="layout-menu-tooltip-arrow"></div>--\x3e\n  \x3c!--<div class="layout-menu-tooltip-text">个性设置</div>--\x3e\n  \x3c!--</div>--\x3e\n  \x3c!--</li>--\x3e\n  <li role="menuitem">\n    <a href="#" [attr.tabindex]="!active ? \'-1\' : null">\n      <i class="fa fa-fw fa-sign-out"></i>\n      <span (click)="logout()">退出登录</span>\n    </a>\n    <div class="layout-menu-tooltip">\n      <div class="layout-menu-tooltip-arrow"></div>\n      <div class="layout-menu-tooltip-text" (click)="logout()">退出登录</div>\n    </div>\n  </li>\n</ul>\n',animations:[h.trigger("menu",[h.state("hidden",h.style({height:"0px"})),h.state("visible",h.style({height:"*"})),h.transition("visible => hidden",h.animate("400ms cubic-bezier(0.86, 0, 0.07, 1)")),h.transition("hidden => visible",h.animate("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])],changeDetection:f.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:De}]},e}(),Je=function(){function e(){}return e.decorators=[{type:f.NgModule,args:[{imports:[g.FormsModule,y.ErCoreModule,ke],declarations:[Ye,Qe,Ge,Ze,We,De],exports:[De]}]}],e}();e.PngAdminWorkSpaceComponent=De,e.PrimeNgComponentsModule=ke,e.ErPrimeNgModule=je,e.PngAdminWorkSpaceModule=Je,e.PngTableComponent=be,e.PngAutoCompleteComponent=I,e.PngConfirmDialogComponent=U,e.PngCalendarComponent=A,e.PngOverlayPanelComponent=W,e.PngPanelComponent=Q,e.PngPopupDialogComponent=Z,e.PngAlertComponent=z,e.PngAnnounceComponent=j,e.PngInputComponent=L,e.PngOptionItemComponent=Y,e.PngSearchBoxComponent=ne,e.ValidateMessageTooltipComponent=Ce,e.PngSliderComponent=le,e.PngTreeNavTableComponent=Ie,e.PngButtonComponent=S,e.PngButtonsComponent=P,e.PngCheckBoxComponent=E,e.PngImageComponent=N,e.PngSelectComponent=re,e.PngMultiSelectComponent=_,e.PngListBoxComponent=F,e.PngRadioComponent=X,e.PngRatingComponent=te,e.PngTreeComponent=Te,e.PNG_TREE_NODE_KEYS=we,e.PngWizardComponent=Pe,e.PngStepComponent=Se,e.PngChartComponent=D,e.PngFileUploadComponent=V,e.PngSelectButtonComponent=ae,e.PngComponents=Oe,e.defaultPngColumnProps=pe,e.defaultPngTableProps=ce,e.defaultRowIndexColumn=ue,e.defaultOrderedRowIndexColumn={label:"行号",width:"50px",cellClass:"text-right",sortable:!1,filterable:!1,aggable:!1,order:-100,isDataColumn:!1,cellContent:function(e){return e.rowIndex+1},cellStyleClass:function(e){return 0===e.rowIndex?"badge badge-pill white bg-red No-1":1===e.rowIndex?"badge badge-pill black bg-yellow No-2":2===e.rowIndex?"badge badge-pill white bg-blue No-3":"badge badge-pill badge-dark"}},e.defaultActionColumn=ge,e.defaultAddButton=de,e.defaultViewButton=me,e.defaultEditButton=he,e.defaultDeleteButton=fe,e.defaultAuditButton=ye,e.defaultDownloadButton=xe,e.defaultOverlayColumnProps={sortable:!1,filterable:!1,aggable:!1},e.defaultOverlayTableProps={alwaysShowPaginator:!1,scrollable:!0,scrollWidth:"800px",paginatorPosition:"bottom"},e.ɵa=Ke,e.ɵg=Me,e.ɵh=Ee,e.ɵf=Ue,e.ɵb=Re,e.ɵl=Ve,e.ɵi=Ne,e.ɵj=Le,e.ɵd=Be,e.ɵc=Fe,e.ɵe=He,e.ɵm=_e,e.ɵn=qe,e.ɵk=ze,e.ɵo=Ye,e.ɵs=We,e.ɵp=Qe,e.ɵq=Ge,e.ɵr=Ze,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=er-primeng.umd.min.js.map