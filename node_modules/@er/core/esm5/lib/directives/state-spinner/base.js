/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Input } from '@angular/core';
import { ConfigUtils } from '@er/utils';
import { BaseDirective } from '../../bases/directive';
/**
 * @abstract
 */
var SpinnerBaseDirective = /** @class */ (function (_super) {
    tslib_1.__extends(SpinnerBaseDirective, _super);
    function SpinnerBaseDirective(el, renderer) {
        var _this = _super.call(this) || this;
        _this.el = el;
        _this.renderer = renderer;
        _this.position = 'right';
        return _this;
    }
    /**
     * @return {?}
     */
    SpinnerBaseDirective.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.onInit();
    };
    /**
     * @return {?}
     */
    SpinnerBaseDirective.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.spinElement = this.createElement('span', ['spinner', this.position, 'd-none']);
        if (!this.spinnerClass) {
            this.spinnerClass = ConfigUtils.getConfig().onLoading || 'fa fa-cog fa-spin fa-spin-2x';
        }
        /** @type {?} */
        var spinnerEle = this.createElement('i', this.spinnerClass.split(' '));
        this.renderer.appendChild(this.spinElement, spinnerEle);
        this.placeSpin();
    };
    /**
     * @protected
     * @return {?}
     */
    SpinnerBaseDirective.prototype.placeSpin = /**
     * @protected
     * @return {?}
     */
    function () {
        /** @type {?} */
        var element = this.el.nativeElement;
        if (element instanceof HTMLDivElement) {
            this.addSpin(element);
        }
        else if (element instanceof HTMLButtonElement) {
            this.appendChildSpin(element);
        }
        else if (element instanceof HTMLImageElement) {
            this.replaceWithWrapper();
        }
        else if (element instanceof HTMLUListElement) {
            this.replaceWithWrapper();
        }
        else if (element instanceof HTMLInputElement) {
            switch (element.type) {
                case 'text':
                case 'file': {
                    this.replaceWithWrapper();
                    break;
                }
                case 'checkbox':
                case 'radio':
                case 'button': {
                    this.replaceWithWrapper('span');
                    break;
                }
                default:
                    this.replaceWithWrapper();
            }
        }
        else {
            this.replaceWithWrapper();
        }
    };
    /**
     * @protected
     * @param {?} parent
     * @return {?}
     */
    SpinnerBaseDirective.prototype.appendChildSpin = /**
     * @protected
     * @param {?} parent
     * @return {?}
     */
    function (parent) {
        this.renderer.appendChild(parent, this.spinElement);
    };
    /**
     * @protected
     * @param {?} parent
     * @return {?}
     */
    SpinnerBaseDirective.prototype.addSpin = /**
     * @protected
     * @param {?} parent
     * @return {?}
     */
    function (parent) {
        this.renderer.addClass(parent, 'spin-container');
        this.renderer.removeClass(this.spinElement, this.position);
        this.renderer.addClass(this.spinElement, 'fa-2x');
        this.renderer.addClass(this.spinElement, 'center');
        this.appendChildSpin(parent);
    };
    /**
     * @protected
     * @param {?=} tag
     * @return {?}
     */
    SpinnerBaseDirective.prototype.replaceWithWrapper = /**
     * @protected
     * @param {?=} tag
     * @return {?}
     */
    function (tag) {
        if (tag === void 0) { tag = 'div'; }
        this.containerElement = this.createElement(tag, ['spin-container']);
        /** @type {?} */
        var parent = this.el.nativeElement.parentNode;
        this.renderer.insertBefore(parent, this.containerElement, this.el.nativeElement);
        this.renderer.removeChild(parent, this.el.nativeElement);
        if (tag !== 'div') {
            this.renderer.addClass(this.spinElement, 'spin-inline');
            if (this.position === 'left') {
                this.renderer.appendChild(this.containerElement, this.spinElement);
                this.renderer.appendChild(this.containerElement, this.el.nativeElement);
            }
        }
        else {
            this.renderer.appendChild(this.containerElement, this.el.nativeElement);
            this.renderer.appendChild(this.containerElement, this.spinElement);
        }
    };
    /**
     * @protected
     * @param {?} tag
     * @param {?} classNames
     * @return {?}
     */
    SpinnerBaseDirective.prototype.createElement = /**
     * @protected
     * @param {?} tag
     * @param {?} classNames
     * @return {?}
     */
    function (tag, classNames) {
        var _this = this;
        /** @type {?} */
        var element = this.renderer.createElement(tag);
        if (classNames) {
            classNames.forEach(function (className) {
                return _this.renderer.addClass(element, className);
            });
        }
        return element;
    };
    SpinnerBaseDirective.propDecorators = {
        spinnerClass: [{ type: Input }],
        position: [{ type: Input }]
    };
    return SpinnerBaseDirective;
}(BaseDirective));
export { SpinnerBaseDirective };
if (false) {
    /** @type {?} */
    SpinnerBaseDirective.prototype.spinnerClass;
    /** @type {?} */
    SpinnerBaseDirective.prototype.position;
    /** @type {?} */
    SpinnerBaseDirective.prototype.spinElement;
    /** @type {?} */
    SpinnerBaseDirective.prototype.containerElement;
    /**
     * @type {?}
     * @protected
     */
    SpinnerBaseDirective.prototype.el;
    /**
     * @type {?}
     * @protected
     */
    SpinnerBaseDirective.prototype.renderer;
    /**
     * @abstract
     * @return {?}
     */
    SpinnerBaseDirective.prototype.onInit = function () { };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Blci9jb3JlLyIsInNvdXJjZXMiOlsibGliL2RpcmVjdGl2ZXMvc3RhdGUtc3Bpbm5lci9iYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUE0QixLQUFLLEVBQW9CLE1BQU0sZUFBZSxDQUFDO0FBQ2xGLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDdEMsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLHVCQUF1QixDQUFDOzs7O0FBR3BEO0lBQW1ELGdEQUFhO0lBUTlELDhCQUFzQixFQUFjLEVBQVksUUFBbUI7UUFBbkUsWUFDRSxpQkFBTyxTQUNSO1FBRnFCLFFBQUUsR0FBRixFQUFFLENBQVk7UUFBWSxjQUFRLEdBQVIsUUFBUSxDQUFXO1FBTDFELGNBQVEsR0FBZ0MsT0FBTyxDQUFDOztJQU96RCxDQUFDOzs7O0lBSUQsdUNBQVE7OztJQUFSO1FBQ0UsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ2hCLENBQUM7Ozs7SUFFRCw4Q0FBZTs7O0lBQWY7UUFDRSxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUNwRixJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRTtZQUN0QixJQUFJLENBQUMsWUFBWSxHQUFHLFdBQVcsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxTQUFTLElBQUksOEJBQThCLENBQUM7U0FDekY7O1lBQ0ssVUFBVSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3hFLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFD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ImltcG9ydCB7QWZ0ZXJWaWV3SW5pdCwgRWxlbWVudFJlZiwgSW5wdXQsIE9uSW5pdCwgUmVuZGVyZXIyfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q29uZmlnVXRpbHN9IGZyb20gJ0Blci91dGlscyc7XG5pbXBvcnQge0Jhc2VEaXJlY3RpdmV9IGZyb20gJy4uLy4uL2Jhc2VzL2RpcmVjdGl2ZSc7XG5cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFNwaW5uZXJCYXNlRGlyZWN0aXZlIGV4dGVuZHMgQmFzZURpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XG5cbiAgQElucHV0KCkgc3Bpbm5lckNsYXNzOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHBvc2l0aW9uOiAnbGVmdCcgfCAncmlnaHQnIHwgJ2NlbnRlcicgPSAncmlnaHQnO1xuXG4gIHNwaW5FbGVtZW50OiBhbnk7XG4gIGNvbnRhaW5lckVsZW1lbnQ6IGFueTtcblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgZWw6IEVsZW1lbnRSZWYsIHByb3RlY3RlZCByZW5kZXJlcjogUmVuZGVyZXIyKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIGFic3RyYWN0IG9uSW5pdCgpOiB2b2lkO1xuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMub25Jbml0KCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgdGhpcy5zcGluRWxlbWVudCA9IHRoaXMuY3JlYXRlRWxlbWVudCgnc3BhbicsIFsnc3Bpbm5lcicsIHRoaXMucG9zaXRpb24sICdkLW5vbmUnXSk7XG4gICAgaWYgKCF0aGlzLnNwaW5uZXJDbGFzcykge1xuICAgICAgdGhpcy5zcGlubmVyQ2xhc3MgPSBDb25maWdVdGlscy5nZXRDb25maWcoKS5vbkxvYWRpbmcgfHwgJ2ZhIGZhLWNvZyBmYS1zcGluIGZhLXNwaW4tMngnO1xuICAgIH1cbiAgICBjb25zdCBzcGlubmVyRWxlID0gdGhpcy5jcmVhdGVFbGVtZW50KCdpJywgdGhpcy5zcGlubmVyQ2xhc3Muc3BsaXQoJyAnKSk7XG4gICAgdGhpcy5yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLnNwaW5FbGVtZW50LCBzcGlubmVyRWxlKTtcbiAgICB0aGlzLnBsYWNlU3BpbigpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHBsYWNlU3BpbigpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50O1xuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgIHRoaXMuYWRkU3BpbihlbGVtZW50KTtcbiAgICB9IGVsc2UgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MQnV0dG9uRWxlbWVudCkge1xuICAgICAgdGhpcy5hcHBlbmRDaGlsZFNwaW4oZWxlbWVudCk7XG4gICAgfSBlbHNlIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCkge1xuICAgICAgdGhpcy5yZXBsYWNlV2l0aFdyYXBwZXIoKTtcbiAgICB9IGVsc2UgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MVUxpc3RFbGVtZW50KSB7XG4gICAgICB0aGlzLnJlcGxhY2VXaXRoV3JhcHBlcigpO1xuICAgIH0gZWxzZSBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICAgIHN3aXRjaCAoZWxlbWVudC50eXBlKSB7XG4gICAgICAgIGNhc2UgJ3RleHQnOlxuICAgICAgICBjYXNlICdmaWxlJzoge1xuICAgICAgICAgIHRoaXMucmVwbGFjZVdpdGhXcmFwcGVyKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnY2hlY2tib3gnOlxuICAgICAgICBjYXNlICdyYWRpbyc6XG4gICAgICAgIGNhc2UgJ2J1dHRvbic6IHtcbiAgICAgICAgICB0aGlzLnJlcGxhY2VXaXRoV3JhcHBlcignc3BhbicpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhpcy5yZXBsYWNlV2l0aFdyYXBwZXIoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZXBsYWNlV2l0aFdyYXBwZXIoKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgYXBwZW5kQ2hpbGRTcGluKHBhcmVudCkge1xuICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQocGFyZW50LCB0aGlzLnNwaW5FbGVtZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBhZGRTcGluKHBhcmVudCkge1xuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MocGFyZW50LCAnc3Bpbi1jb250YWluZXInKTtcbiAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKHRoaXMuc3BpbkVsZW1lbnQsIHRoaXMucG9zaXRpb24pO1xuICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5zcGluRWxlbWVudCwgJ2ZhLTJ4Jyk7XG4gICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLnNwaW5FbGVtZW50LCAnY2VudGVyJyk7XG4gICAgdGhpcy5hcHBlbmRDaGlsZFNwaW4ocGFyZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCByZXBsYWNlV2l0aFdyYXBwZXIodGFnID0gJ2RpdicpIHtcbiAgICB0aGlzLmNvbnRhaW5lckVsZW1lbnQgPSB0aGlzLmNyZWF0ZUVsZW1lbnQodGFnLCBbJ3NwaW4tY29udGFpbmVyJ10pO1xuICAgIGNvbnN0IHBhcmVudCA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5wYXJlbnROb2RlO1xuICAgIHRoaXMucmVuZGVyZXIuaW5zZXJ0QmVmb3JlKHBhcmVudCwgdGhpcy5jb250YWluZXJFbGVtZW50LCB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpO1xuICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2hpbGQocGFyZW50LCB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpO1xuICAgIGlmICh0YWcgIT09ICdkaXYnKSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMuc3BpbkVsZW1lbnQsICdzcGluLWlubGluZScpO1xuICAgICAgaWYgKHRoaXMucG9zaXRpb24gPT09ICdsZWZ0Jykge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyRWxlbWVudCwgdGhpcy5zcGluRWxlbWVudCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXJFbGVtZW50LCB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyRWxlbWVudCwgdGhpcy5lbC5uYXRpdmVFbGVtZW50KTtcbiAgICAgIHRoaXMucmVuZGVyZXIuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXJFbGVtZW50LCB0aGlzLnNwaW5FbGVtZW50KTtcbiAgICB9XG4gIH1cblxuXG4gIHByb3RlY3RlZCBjcmVhdGVFbGVtZW50KHRhZywgY2xhc3NOYW1lczogc3RyaW5nW10pOiBhbnkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnJlbmRlcmVyLmNyZWF0ZUVsZW1lbnQodGFnKTtcbiAgICBpZiAoY2xhc3NOYW1lcykge1xuICAgICAgY2xhc3NOYW1lcy5mb3JFYWNoKGNsYXNzTmFtZSA9PlxuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkpO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfVxuXG59XG4iXX0=