/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { DataAttr, DataType, RegPatterns } from '@er/types';
import { CommonsUtils, ConfigUtils } from '@er/utils';
import * as esb from 'elastic-builder';
import { LogUtils } from '../log';
export class DataFieldUtils {
    /**
     * @param {?} dataField
     * @return {?}
     */
    static getFieldDefaultProps(dataField) {
        switch (dataField.dataAttr) {
            case DataAttr.DATA_CODE:
                return DataFieldUtils.getDataCodeFieldProps(dataField);
            case DataAttr.URL:
                dataField.dataType = DataType.STRING;
                dataField.pattern = RegPatterns.url;
                break;
            case DataAttr.PHONE:
                dataField.dataType = DataType.STRING;
                dataField.pattern = RegPatterns.phone;
                break;
            case DataAttr.ID_CARD:
                dataField.dataType = DataType.STRING;
                break;
            case DataAttr.EMAIL:
                dataField.dataType = DataType.STRING;
                dataField.pattern = RegPatterns.email;
                break;
            case DataAttr.CURRENCY:
                dataField.defaultValue = 0;
                dataField.dataType = DataType.NUMBER;
                dataField.pattern = RegPatterns.pNumeric;
                break;
        }
        return dataField;
    }
    /**
     * @param {?} field
     * @return {?}
     */
    static getDefaultFieldName(field) {
        if (field) {
            if (field.defaultKey) {
                return field.defaultKey;
            }
            else {
                return field.key;
            }
        }
    }
    /**
     * @param {?} fieldValue
     * @param {?} field
     * @return {?}
     */
    static getFieldDisplayContent(fieldValue, field) {
        if (!fieldValue) {
            return '';
        }
        if (field) {
            if (CommonsUtils.isJson(fieldValue)) {
                /** @type {?} */
                let key;
                if (field) {
                    key = DataFieldUtils.getDefaultFieldName(field);
                }
                if (key) {
                    return CommonsUtils.get(fieldValue, key);
                }
                else {
                    /** @type {?} */
                    const trans = {};
                    Object.keys(fieldValue).forEach(sub => {
                        /** @type {?} */
                        const label = CommonsUtils.get(field, `fields.${sub}.label`)
                            && CommonsUtils.get(field, `refer.entity.${sub}.label`)
                            && CommonsUtils.get(field, `refer.${sub}.label`);
                        if (label) {
                            trans[label] = fieldValue[sub];
                        }
                        else {
                            trans[sub] = fieldValue[sub];
                        }
                    });
                    fieldValue = trans;
                }
            }
        }
        if (CommonsUtils.isBoolean(fieldValue)) {
            return fieldValue ? '是' : '否';
        }
        else {
            return CommonsUtils.getText(fieldValue);
        }
    }
    /**
     * @private
     * @param {?} dataField
     * @return {?}
     */
    static getDataCodeFieldProps(dataField) {
        /** @type {?} */
        const props = ConfigUtils.getConfig().dataFieldProps.dataCode;
        if (!dataField.catCode) {
            LogUtils.error('DataFieldUtils', `dataCode字段没有定义【catCode】属性`, dataField);
            return;
        }
        return (/** @type {?} */ ({
            dataType: DataType.JSON,
            sortKey: props.codeKey,
            aggKey: props.codeKey,
            defaultKey: props.nameKey,
            apiDataProps: (/** @type {?} */ ({
                apiEntry: props.apiEntry,
                searchFields: [props.nameKey, props.codeKey, props.abbrKey],
                returnFields: [props.nameKey, props.codeKey],
                query: [
                    esb.termQuery(`${props.catKey}.code`, dataField.catCode),
                    props.inUseKey ? esb.boolQuery().mustNot(esb.termQuery(props.inUseKey, false)) : undefined
                ],
                sort: props.codeKey,
                size: 10
            })),
            dataItemProps: {
                labelKey: props.nameKey,
                valueKey: [props.nameKey, props.codeKey],
                idKey: props.codeKey,
                template: (item) => {
                    return `<span><b>${item[props.nameKey]}</b></span>  <span class="badge badge-info"> ${item[props.codeKey]}</span> `;
                }
            }
        }));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvY29yZS8iLCJzb3VyY2VzIjpbImxpYi91dGlscy9kYXRhLWZpZWxkL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQWUsUUFBUSxFQUFhLFFBQVEsRUFBRSxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDbkYsT0FBTyxFQUFDLFlBQVksRUFBRSxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDcEQsT0FBTyxLQUFLLEdBQUcsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBRWhDLE1BQU0sT0FBTyxjQUFjOzs7OztJQUV6QixNQUFNLENBQUMsb0JBQW9CLENBQUMsU0FBb0I7UUFDOUMsUUFBUSxTQUFTLENBQUMsUUFBUSxFQUFFO1lBQzFCLEtBQUssUUFBUSxDQUFDLFNBQVM7Z0JBQ3JCLE9BQU8sY0FBYyxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pELEtBQUssUUFBUSxDQUFDLEdBQUc7Z0JBQ2YsU0FBUyxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDO2dCQUNyQyxTQUFTLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQyxHQUFHLENBQUM7Z0JBQ3BDLE1BQU07WUFDUixLQUFLLFFBQVEsQ0FBQyxLQUFLO2dCQUNqQixTQUFTLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUM7Z0JBQ3JDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQztnQkFDdEMsTUFBTTtZQUNSLEtBQUssUUFBUSxDQUFDLE9BQU87Z0JBQ25CLFNBQVMsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQztnQkFDckMsTUFBTTtZQUNSLEtBQUssUUFBUSxDQUFDLEtBQUs7Z0JBQ2pCLFNBQVMsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDLE1BQU0s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YXRhRmllbGQsIERhdGFUeXBlLCBSZWdQYXR0ZXJuc30gZnJvbSAnQGVyL3R5cGVzJztcbmltcG9ydCB7Q29tbW9uc1V0aWxzLCBDb25maWdVdGlsc30gZnJvbSAnQGVyL3V0aWxzJztcbmltcG9ydCAqIGFzIGVzYiBmcm9tICdlbGFzdGljLWJ1aWxkZXInO1xuaW1wb3J0IHtMb2dVdGlsc30gZnJvbSAnLi4vbG9nJztcblxuZXhwb3J0IGNsYXNzIERhdGFGaWVsZFV0aWxzIHtcblxuICBzdGF0aWMgZ2V0RmllbGREZWZhdWx0UHJvcHMoZGF0YUZpZWxkOiBEYXRhRmllbGQpIHtcbiAgICBzd2l0Y2ggKGRhdGFGaWVsZC5kYXRhQXR0cikge1xuICAgICAgY2FzZSBEYXRhQXR0ci5EQVRBX0NPREU6XG4gICAgICAgIHJldHVybiBEYXRhRmllbGRVdGlscy5nZXREYXRhQ29kZUZpZWxkUHJvcHMoZGF0YUZpZWxkKTtcbiAgICAgIGNhc2UgRGF0YUF0dHIuVVJMOlxuICAgICAgICBkYXRhRmllbGQuZGF0YVR5cGUgPSBEYXRhVHlwZS5TVFJJTkc7XG4gICAgICAgIGRhdGFGaWVsZC5wYXR0ZXJuID0gUmVnUGF0dGVybnMudXJsO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRGF0YUF0dHIuUEhPTkU6XG4gICAgICAgIGRhdGFGaWVsZC5kYXRhVHlwZSA9IERhdGFUeXBlLlNUUklORztcbiAgICAgICAgZGF0YUZpZWxkLnBhdHRlcm4gPSBSZWdQYXR0ZXJucy5waG9uZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIERhdGFBdHRyLklEX0NBUkQ6XG4gICAgICAgIGRhdGFGaWVsZC5kYXRhVHlwZSA9IERhdGFUeXBlLlNUUklORztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIERhdGFBdHRyLkVNQUlMOlxuICAgICAgICBkYXRhRmllbGQuZGF0YVR5cGUgPSBEYXRhVHlwZS5TVFJJTkc7XG4gICAgICAgIGRhdGFGaWVsZC5wYXR0ZXJuID0gUmVnUGF0dGVybnMuZW1haWw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBEYXRhQXR0ci5DVVJSRU5DWTpcbiAgICAgICAgZGF0YUZpZWxkLmRlZmF1bHRWYWx1ZSA9IDA7XG4gICAgICAgIGRhdGFGaWVsZC5kYXRhVHlwZSA9IERhdGFUeXBlLk5VTUJFUjtcbiAgICAgICAgZGF0YUZpZWxkLnBhdHRlcm4gPSBSZWdQYXR0ZXJucy5wTnVtZXJpYztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiBkYXRhRmllbGQ7XG4gIH1cblxuICBzdGF0aWMgZ2V0RGVmYXVsdEZpZWxkTmFtZShmaWVsZDogRGF0YUZpZWxkKSB7XG4gICAgaWYgKGZpZWxkKSB7XG4gICAgICBpZiAoZmllbGQuZGVmYXVsdEtleSkge1xuICAgICAgICByZXR1cm4gZmllbGQuZGVmYXVsdEtleTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmaWVsZC5rZXk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGdldEZpZWxkRGlzcGxheUNvbnRlbnQoZmllbGRWYWx1ZTogYW55LCBmaWVsZDogRGF0YUZpZWxkKSB7XG4gICAgaWYgKCFmaWVsZFZhbHVlKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIGlmIChmaWVsZCkge1xuICAgICAgaWYgKENvbW1vbnNVdGlscy5pc0pzb24oZmllbGRWYWx1ZSkpIHtcbiAgICAgICAgbGV0IGtleTtcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAga2V5ID0gRGF0YUZpZWxkVXRpbHMuZ2V0RGVmYXVsdEZpZWxkTmFtZShmaWVsZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgIHJldHVybiBDb21tb25zVXRpbHMuZ2V0KGZpZWxkVmFsdWUsIGtleSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgdHJhbnMgPSB7fTtcbiAgICAgICAgICBPYmplY3Qua2V5cyhmaWVsZFZhbHVlKS5mb3JFYWNoKHN1YiA9PiB7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IENvbW1vbnNVdGlscy5nZXQoZmllbGQsIGBmaWVsZHMuJHtzdWJ9LmxhYmVsYClcbiAgICAgICAgICAgICAgJiYgQ29tbW9uc1V0aWxzLmdldChmaWVsZCwgYHJlZmVyLmVudGl0eS4ke3N1Yn0ubGFiZWxgKVxuICAgICAgICAgICAgICAmJiBDb21tb25zVXRpbHMuZ2V0KGZpZWxkLCBgcmVmZXIuJHtzdWJ9LmxhYmVsYCk7XG4gICAgICAgICAgICBpZiAobGFiZWwpIHtcbiAgICAgICAgICAgICAgdHJhbnNbbGFiZWxdID0gZmllbGRWYWx1ZVtzdWJdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdHJhbnNbc3ViXSA9IGZpZWxkVmFsdWVbc3ViXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBmaWVsZFZhbHVlID0gdHJhbnM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKENvbW1vbnNVdGlscy5pc0Jvb2xlYW4oZmllbGRWYWx1ZSkpIHtcbiAgICAgIHJldHVybiBmaWVsZFZhbHVlID8gJ+aYrycgOiAn5ZCmJztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIENvbW1vbnNVdGlscy5nZXRUZXh0KGZpZWxkVmFsdWUpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldERhdGFDb2RlRmllbGRQcm9wcyhkYXRhRmllbGQ6IERhdGFGaWVsZCkge1xuICAgIGNvbnN0IHByb3BzID0gQ29uZmlnVXRpbHMuZ2V0Q29uZmlnKCkuZGF0YUZpZWxkUHJvcHMuZGF0YUNvZGU7XG4gICAgaWYgKCFkYXRhRmllbGQuY2F0Q29kZSkge1xuICAgICAgTG9nVXRpbHMuZXJyb3IoJ0RhdGFGaWVsZFV0aWxzJywgYGRhdGFDb2Rl5a2X5q615rKh5pyJ5a6a5LmJ44CQY2F0Q29kZeOAkeWxnuaAp2AsIGRhdGFGaWVsZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiA8RGF0YUZpZWxkPntcbiAgICAgIGRhdGFUeXBlOiBEYXRhVHlwZS5KU09OLFxuICAgICAgc29ydEtleTogcHJvcHMuY29kZUtleSxcbiAgICAgIGFnZ0tleTogcHJvcHMuY29kZUtleSxcbiAgICAgIGRlZmF1bHRLZXk6IHByb3BzLm5hbWVLZXksXG4gICAgICBhcGlEYXRhUHJvcHM6IDxBcGlEYXRhUHJvcHM+e1xuICAgICAgICBhcGlFbnRyeTogcHJvcHMuYXBpRW50cnksXG4gICAgICAgIHNlYXJjaEZpZWxkczogW3Byb3BzLm5hbWVLZXksIHByb3BzLmNvZGVLZXksIHByb3BzLmFiYnJLZXldLFxuICAgICAgICByZXR1cm5GaWVsZHM6IFtwcm9wcy5uYW1lS2V5LCBwcm9wcy5jb2RlS2V5XSxcbiAgICAgICAgcXVlcnk6IFtcbiAgICAgICAgICBlc2IudGVybVF1ZXJ5KGAke3Byb3BzLmNhdEtleX0uY29kZWAsIGRhdGFGaWVsZC5jYXRDb2RlKSxcbiAgICAgICAgICBwcm9wcy5pblVzZUtleSA/IGVzYi5ib29sUXVlcnkoKS5tdXN0Tm90KGVzYi50ZXJtUXVlcnkocHJvcHMuaW5Vc2VLZXksIGZhbHNlKSkgOiB1bmRlZmluZWRcbiAgICAgICAgXSxcbiAgICAgICAgc29ydDogcHJvcHMuY29kZUtleSxcbiAgICAgICAgc2l6ZTogMTBcbiAgICAgIH0sXG4gICAgICBkYXRhSXRlbVByb3BzOiB7XG4gICAgICAgIGxhYmVsS2V5OiBwcm9wcy5uYW1lS2V5LFxuICAgICAgICB2YWx1ZUtleTogW3Byb3BzLm5hbWVLZXksIHByb3BzLmNvZGVLZXldLFxuICAgICAgICBpZEtleTogcHJvcHMuY29kZUtleSxcbiAgICAgICAgdGVtcGxhdGU6IChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGA8c3Bhbj48Yj4ke2l0ZW1bcHJvcHMubmFtZUtleV19PC9iPjwvc3Bhbj4gIDxzcGFuIGNsYXNzPVwiYmFkZ2UgYmFkZ2UtaW5mb1wiPiAke2l0ZW1bcHJvcHMuY29kZUtleV19PC9zcGFuPiBgO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxufVxuIl19