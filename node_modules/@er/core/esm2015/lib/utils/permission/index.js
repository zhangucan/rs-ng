/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { CommonsUtils, ConfigUtils } from '@er/utils';
import { NgxPermissionsService, NgxRolesService } from 'ngx-permissions';
import { of } from 'rxjs';
import { DiUtils } from '../di';
export class PermissionUtils {
    /**
     * @return {?}
     */
    static getPermissionsService() {
        if (!PermissionUtils._permissionsService) {
            PermissionUtils._permissionsService = DiUtils.get(NgxPermissionsService);
        }
        return PermissionUtils._permissionsService;
    }
    /**
     * @return {?}
     */
    static getRolesService() {
        if (!PermissionUtils._rolesService) {
            PermissionUtils._rolesService = DiUtils.get(NgxRolesService);
        }
        return PermissionUtils._rolesService;
    }
    /**
     * @param {?} roles
     * @return {?}
     */
    static getRolePermissions(roles) {
        return (ConfigUtils.getConfig().auth.getRolePermissions
            && ConfigUtils.getConfig().auth.getRolePermissions(roles))
            || of([]);
    }
    /**
     * @param {?} permissionName
     * @return {?}
     */
    static HasModulePermission(permissionName) {
        /** @type {?} */
        const permissions = PermissionUtils.getPermissionsService().getPermissions();
        /** @type {?} */
        const matched = Object.keys(permissions).some(name => {
            return name === permissionName
                || name.startsWith(permissionName + ':');
        });
        return matched && Object.keys(matched).length > 0;
    }
    /**
     * @param {?} permissions
     * @param {?=} validationFunction
     * @return {?}
     */
    static addPermissions(permissions, validationFunction) {
        PermissionUtils.getPermissionsService().addPermission(permissions, validationFunction);
    }
    /**
     * @param {?} roleName
     * @param {?=} validationFunction
     * @return {?}
     */
    static addRole(roleName, validationFunction) {
        if (!validationFunction) {
            validationFunction = () => true;
        }
        PermissionUtils.getRolesService().addRole(roleName, validationFunction);
    }
    /**
     * @param {?} roles
     * @return {?}
     */
    static addRoles(roles) {
        /** @type {?} */
        const _roles = CommonsUtils.getArrayValue(roles);
        if (_roles) {
            /** @type {?} */
            const roleService = PermissionUtils.getRolesService();
            _roles.filter(role => !!role).forEach(role => roleService.addRole(role, () => true));
        }
    }
    /**
     * @param {?} role
     * @return {?}
     */
    static hasRole(role) {
        /** @type {?} */
        const userRoles = PermissionUtils.getRolesService().getRoles();
        return userRoles.hasOwnProperty(role);
    }
    /**
     * @param {?} roles
     * @return {?}
     */
    static hasAnyRole(roles) {
        /** @type {?} */
        const _roles = CommonsUtils.getArrayValue(roles);
        /** @type {?} */
        const userRoles = PermissionUtils.getRolesService().getRoles();
        return _roles.some(role => userRoles.hasOwnProperty(role));
    }
    /**
     * @param {?} roles
     * @return {?}
     */
    static hasAllRoles(roles) {
        /** @type {?} */
        const _roles = CommonsUtils.getArrayValue(roles);
        /** @type {?} */
        const userRoles = PermissionUtils.getRolesService().getRoles();
        return _roles.every(role => userRoles.hasOwnProperty(role));
    }
    /**
     * @return {?}
     */
    static getPermissions() {
        return PermissionUtils.getPermissionsService().permissions$;
    }
    /**
     * @return {?}
     */
    static getRoles() {
        return PermissionUtils.getRolesService().roles$;
    }
    /**
     * @param {?} permission
     * @return {?}
     */
    static hasPermission(permission) {
        /** @type {?} */
        const userPermissions = PermissionUtils.getPermissionsService().getPermissions();
        return userPermissions.hasOwnProperty(permission);
    }
    /**
     * @param {?} permissios
     * @return {?}
     */
    static hasAnyPermission(permissios) {
        /** @type {?} */
        const _permissions = CommonsUtils.getArrayValue(permissios);
        /** @type {?} */
        const userPermissions = PermissionUtils.getPermissionsService().getPermissions();
        return _permissions.some(permisiion => userPermissions.hasOwnProperty(permisiion));
    }
    /**
     * @param {?} permissions
     * @return {?}
     */
    static hasAllPermissions(permissions) {
        /** @type {?} */
        const _permissions = CommonsUtils.getArrayValue(permissions);
        /** @type {?} */
        const userPermissions = PermissionUtils.getPermissionsService().getPermissions();
        return _permissions.every(permisiion => userPermissions.hasOwnProperty(permisiion));
    }
    /**
     * @param {?} roleOrPermission
     * @return {?}
     */
    static hasAuth(roleOrPermission) {
        return PermissionUtils.hasAnyRole(roleOrPermission) || PermissionUtils.hasAnyPermission(roleOrPermission);
    }
    /**
     * @param {?} roleOrPermissions
     * @return {?}
     */
    static hasAllAuths(roleOrPermissions) {
        return PermissionUtils.hasAllRoles(roleOrPermissions) || PermissionUtils.hasAllPermissions(roleOrPermissions);
    }
    /**
     * @return {?}
     */
    static clearRoles() {
        PermissionUtils.getRolesService().flushRoles();
    }
    /**
     * @return {?}
     */
    static clearPermission() {
        PermissionUtils.getPermissionsService().flushPermissions();
    }
}
PermissionUtils._permissionsService = null;
PermissionUtils._rolesService = null;
if (false) {
    /** @type {?} */
    PermissionUtils._permissionsService;
    /** @type {?} */
    PermissionUtils._rolesService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvY29yZS8iLCJzb3VyY2VzIjpbImxpYi91dGlscy9wZXJtaXNzaW9uL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsWUFBWSxFQUFFLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNwRCxPQUFPLEVBQUMscUJBQXFCLEVBQUUsZUFBZSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFHdkUsT0FBTyxFQUFhLEVBQUUsRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUNwQyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sT0FBTyxDQUFDO0FBRzlCLE1BQU0sT0FBTyxlQUFlOzs7O0lBTTFCLE1BQU0sQ0FBQyxxQkFBcUI7UUFDMUIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxtQkFBbUIsRUFBRTtZQUN4QyxlQUFlLENBQUMsbUJBQW1CLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1NBQzFFO1FBQ0QsT0FBTyxlQUFlLENBQUMsbUJBQW1CLENBQUM7SUFDN0MsQ0FBQzs7OztJQUVELE1BQU0sQ0FBQyxlQUFlO1FBQ3BCLElBQUksQ0FBQyxlQUFlLENBQUMsYUFBYSxFQUFFO1lBQ2xDLGVBQWUsQ0FBQyxhQUFhLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztTQUM5RDtRQUNELE9BQU8sZUFBZSxDQUFDLGFBQWEsQ0FBQztJQUN2QyxDQUFDOzs7OztJQUVELE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxLQUF3QjtRQUNoRCxPQUFPLENBQUMsV0FBVyxDQUFDLFNBQVMsRUFBRSxDQUFDLElBQUksQ0FBQyxrQkFBa0I7ZUFDbEQsV0FBVyxDQUFDLFNBQVMsRUFBRSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztlQUN2RCxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDZCxDQUFDOzs7OztJQUVELE1B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QUFDLGVBQWUsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ2pELENBQUM7Ozs7SUFFRCxNQUFNLENBQUMsZUFBZTtRQUNwQixlQUFlLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzdELENBQUM7O0FBNUdNLG1DQUFtQixHQUEwQixJQUFJLENBQUM7QUFFbEQsNkJBQWEsR0FBb0IsSUFBSSxDQUFDOzs7SUFGN0Msb0NBQXlEOztJQUV6RCw4QkFBNkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbW1vbnNVdGlscywgQ29uZmlnVXRpbHN9IGZyb20gJ0Blci91dGlscyc7XG5pbXBvcnQge05neFBlcm1pc3Npb25zU2VydmljZSwgTmd4Um9sZXNTZXJ2aWNlfSBmcm9tICduZ3gtcGVybWlzc2lvbnMnO1xuaW1wb3J0IHtOZ3hQZXJtaXNzaW9uc09iamVjdH0gZnJvbSAnbmd4LXBlcm1pc3Npb25zL3NlcnZpY2UvcGVybWlzc2lvbnMuc2VydmljZSc7XG5pbXBvcnQge05neFJvbGVzT2JqZWN0fSBmcm9tICduZ3gtcGVybWlzc2lvbnMvc2VydmljZS9yb2xlcy5zZXJ2aWNlJztcbmltcG9ydCB7T2JzZXJ2YWJsZSwgb2Z9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtEaVV0aWxzfSBmcm9tICcuLi9kaSc7XG5cblxuZXhwb3J0IGNsYXNzIFBlcm1pc3Npb25VdGlscyB7XG5cbiAgc3RhdGljIF9wZXJtaXNzaW9uc1NlcnZpY2U6IE5neFBlcm1pc3Npb25zU2VydmljZSA9IG51bGw7XG5cbiAgc3RhdGljIF9yb2xlc1NlcnZpY2U6IE5neFJvbGVzU2VydmljZSA9IG51bGw7XG5cbiAgc3RhdGljIGdldFBlcm1pc3Npb25zU2VydmljZSgpIHtcbiAgICBpZiAoIVBlcm1pc3Npb25VdGlscy5fcGVybWlzc2lvbnNTZXJ2aWNlKSB7XG4gICAgICBQZXJtaXNzaW9uVXRpbHMuX3Blcm1pc3Npb25zU2VydmljZSA9IERpVXRpbHMuZ2V0KE5neFBlcm1pc3Npb25zU2VydmljZSk7XG4gICAgfVxuICAgIHJldHVybiBQZXJtaXNzaW9uVXRpbHMuX3Blcm1pc3Npb25zU2VydmljZTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRSb2xlc1NlcnZpY2UoKSB7XG4gICAgaWYgKCFQZXJtaXNzaW9uVXRpbHMuX3JvbGVzU2VydmljZSkge1xuICAgICAgUGVybWlzc2lvblV0aWxzLl9yb2xlc1NlcnZpY2UgPSBEaVV0aWxzLmdldChOZ3hSb2xlc1NlcnZpY2UpO1xuICAgIH1cbiAgICByZXR1cm4gUGVybWlzc2lvblV0aWxzLl9yb2xlc1NlcnZpY2U7XG4gIH1cblxuICBzdGF0aWMgZ2V0Um9sZVBlcm1pc3Npb25zKHJvbGVzOiBzdHJpbmcgfCBzdHJpbmdbXSk6IE9ic2VydmFibGU8c3RyaW5nW10+IHtcbiAgICByZXR1cm4gKENvbmZpZ1V0aWxzLmdldENvbmZpZygpLmF1dGguZ2V0Um9sZVBlcm1pc3Npb25zXG4gICAgICAmJiBDb25maWdVdGlscy5nZXRDb25maWcoKS5hdXRoLmdldFJvbGVQZXJtaXNzaW9ucyhyb2xlcykpXG4gICAgICB8fCBvZihbXSk7XG4gIH1cblxuICBzdGF0aWMgSGFzTW9kdWxlUGVybWlzc2lvbihwZXJtaXNzaW9uTmFtZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHBlcm1pc3Npb25zID0gUGVybWlzc2lvblV0aWxzLmdldFBlcm1pc3Npb25zU2VydmljZSgpLmdldFBlcm1pc3Npb25zKCk7XG4gICAgY29uc3QgbWF0Y2hlZCA9IE9iamVjdC5rZXlzKHBlcm1pc3Npb25zKS5zb21lKG5hbWUgPT4ge1xuICAgICAgcmV0dXJuIG5hbWUgPT09IHBlcm1pc3Npb25OYW1lXG4gICAgICAgIHx8IG5hbWUuc3RhcnRzV2l0aChwZXJtaXNzaW9uTmFtZSArICc6Jyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hdGNoZWQgJiYgT2JqZWN0LmtleXMobWF0Y2hlZCkubGVuZ3RoID4gMDtcbiAgfVxuXG4gIHN0YXRpYyBhZGRQZXJtaXNzaW9ucyhwZXJtaXNzaW9uczogc3RyaW5nIHwgc3RyaW5nW10sIHZhbGlkYXRpb25GdW5jdGlvbj86IChwZXJtaXNzaW9uTmFtZSwgcGVybWlzc2lvbnNPYmplY3QpID0+IGJvb2xlYW4pIHtcbiAgICBQZXJtaXNzaW9uVXRpbHMuZ2V0UGVybWlzc2lvbnNTZXJ2aWNlKCkuYWRkUGVybWlzc2lvbihwZXJtaXNzaW9ucywgdmFsaWRhdGlvbkZ1bmN0aW9uKTtcbiAgfVxuXG4gIHN0YXRpYyBhZGRSb2xlKHJvbGVOYW1lOiBzdHJpbmcsIHZhbGlkYXRpb25GdW5jdGlvbj86IEZ1bmN0aW9uIHwgc3RyaW5nW10pIHtcbiAgICBpZiAoIXZhbGlkYXRpb25GdW5jdGlvbikge1xuICAgICAgdmFsaWRhdGlvbkZ1bmN0aW9uID0gKCkgPT4gdHJ1ZTtcbiAgICB9XG4gICAgUGVybWlzc2lvblV0aWxzLmdldFJvbGVzU2VydmljZSgpLmFkZFJvbGUocm9sZU5hbWUsIHZhbGlkYXRpb25GdW5jdGlvbik7XG4gIH1cblxuICBzdGF0aWMgYWRkUm9sZXMocm9sZXM6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgX3JvbGVzOiBzdHJpbmdbXSA9IENvbW1vbnNVdGlscy5nZXRBcnJheVZhbHVlKHJvbGVzKTtcbiAgICBpZiAoX3JvbGVzKSB7XG4gICAgICBjb25zdCByb2xlU2VydmljZSA9IFBlcm1pc3Npb25VdGlscy5nZXRSb2xlc1NlcnZpY2UoKTtcbiAgICAgIF9yb2xlcy5maWx0ZXIocm9sZSA9PiAhIXJvbGUpLmZvckVhY2gocm9sZSA9PiByb2xlU2VydmljZS5hZGRSb2xlKHJvbGUsICgpID0+IHRydWUpKTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgaGFzUm9sZShyb2xlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCB1c2VyUm9sZXM6IE5neFJvbGVzT2JqZWN0ID0gUGVybWlzc2lvblV0aWxzLmdldFJvbGVzU2VydmljZSgpLmdldFJvbGVzKCk7XG4gICAgcmV0dXJuIHVzZXJSb2xlcy5oYXNPd25Qcm9wZXJ0eShyb2xlKTtcbiAgfVxuXG4gIHN0YXRpYyBoYXNBbnlSb2xlKHJvbGVzOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xuICAgIGNvbnN0IF9yb2xlcyA9IENvbW1vbnNVdGlscy5nZXRBcnJheVZhbHVlKHJvbGVzKTtcbiAgICBjb25zdCB1c2VyUm9sZXM6IE5neFJvbGVzT2JqZWN0ID0gUGVybWlzc2lvblV0aWxzLmdldFJvbGVzU2VydmljZSgpLmdldFJvbGVzKCk7XG4gICAgcmV0dXJuIF9yb2xlcy5zb21lKHJvbGUgPT4gdXNlclJvbGVzLmhhc093blByb3BlcnR5KHJvbGUpKTtcbiAgfVxuXG4gIHN0YXRpYyBoYXNBbGxSb2xlcyhyb2xlczogc3RyaW5nIHwgc3RyaW5nW10pIHtcbiAgICBjb25zdCBfcm9sZXMgPSBDb21tb25zVXRpbHMuZ2V0QXJyYXlWYWx1ZShyb2xlcyk7XG4gICAgY29uc3QgdXNlclJvbGVzOiBOZ3hSb2xlc09iamVjdCA9IFBlcm1pc3Npb25VdGlscy5nZXRSb2xlc1NlcnZpY2UoKS5nZXRSb2xlcygpO1xuICAgIHJldHVybiBfcm9sZXMuZXZlcnkocm9sZSA9PiB1c2VyUm9sZXMuaGFzT3duUHJvcGVydHkocm9sZSkpO1xuICB9XG5cbiAgc3RhdGljIGdldFBlcm1pc3Npb25zKCk6IE9ic2VydmFibGU8Tmd4UGVybWlzc2lvbnNPYmplY3Q+IHtcbiAgICByZXR1cm4gUGVybWlzc2lvblV0aWxzLmdldFBlcm1pc3Npb25zU2VydmljZSgpLnBlcm1pc3Npb25zJDtcbiAgfVxuXG4gIHN0YXRpYyBnZXRSb2xlcygpOiBPYnNlcnZhYmxlPE5neFJvbGVzT2JqZWN0PiB7XG4gICAgcmV0dXJuIFBlcm1pc3Npb25VdGlscy5nZXRSb2xlc1NlcnZpY2UoKS5yb2xlcyQ7XG4gIH1cblxuICBzdGF0aWMgaGFzUGVybWlzc2lvbihwZXJtaXNzaW9uOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCB1c2VyUGVybWlzc2lvbnM6IE5neFBlcm1pc3Npb25zT2JqZWN0ID0gUGVybWlzc2lvblV0aWxzLmdldFBlcm1pc3Npb25zU2VydmljZSgpLmdldFBlcm1pc3Npb25zKCk7XG4gICAgcmV0dXJuIHVzZXJQZXJtaXNzaW9ucy5oYXNPd25Qcm9wZXJ0eShwZXJtaXNzaW9uKTtcbiAgfVxuXG4gIHN0YXRpYyBoYXNBbnlQZXJtaXNzaW9uKHBlcm1pc3Npb3M6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgX3Blcm1pc3Npb25zID0gQ29tbW9uc1V0aWxzLmdldEFycmF5VmFsdWUocGVybWlzc2lvcyk7XG4gICAgY29uc3QgdXNlclBlcm1pc3Npb25zOiBOZ3hQZXJtaXNzaW9uc09iamVjdCA9IFBlcm1pc3Npb25VdGlscy5nZXRQZXJtaXNzaW9uc1NlcnZpY2UoKS5nZXRQZXJtaXNzaW9ucygpO1xuICAgIHJldHVybiBfcGVybWlzc2lvbnMuc29tZShwZXJtaXNpaW9uID0+IHVzZXJQZXJtaXNzaW9ucy5oYXNPd25Qcm9wZXJ0eShwZXJtaXNpaW9uKSk7XG4gIH1cblxuICBzdGF0aWMgaGFzQWxsUGVybWlzc2lvbnMocGVybWlzc2lvbnM6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgX3Blcm1pc3Npb25zID0gQ29tbW9uc1V0aWxzLmdldEFycmF5VmFsdWUocGVybWlzc2lvbnMpO1xuICAgIGNvbnN0IHVzZXJQZXJtaXNzaW9uczogTmd4UGVybWlzc2lvbnNPYmplY3QgPSBQZXJtaXNzaW9uVXRpbHMuZ2V0UGVybWlzc2lvbnNTZXJ2aWNlKCkuZ2V0UGVybWlzc2lvbnMoKTtcbiAgICByZXR1cm4gX3Blcm1pc3Npb25zLmV2ZXJ5KHBlcm1pc2lpb24gPT4gdXNlclBlcm1pc3Npb25zLmhhc093blByb3BlcnR5KHBlcm1pc2lpb24pKTtcbiAgfVxuXG4gIHN0YXRpYyBoYXNBdXRoKHJvbGVPclBlcm1pc3Npb246IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIFBlcm1pc3Npb25VdGlscy5oYXNBbnlSb2xlKHJvbGVPclBlcm1pc3Npb24pIHx8IFBlcm1pc3Npb25VdGlscy5oYXNBbnlQZXJtaXNzaW9uKHJvbGVPclBlcm1pc3Npb24pO1xuICB9XG5cbiAgc3RhdGljIGhhc0FsbEF1dGhzKHJvbGVPclBlcm1pc3Npb25zOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xuICAgIHJldHVybiBQZXJtaXNzaW9uVXRpbHMuaGFzQWxsUm9sZXMocm9sZU9yUGVybWlzc2lvbnMpIHx8IFBlcm1pc3Npb25VdGlscy5oYXNBbGxQZXJtaXNzaW9ucyhyb2xlT3JQZXJtaXNzaW9ucyk7XG4gIH1cblxuICBzdGF0aWMgY2xlYXJSb2xlcygpIHtcbiAgICBQZXJtaXNzaW9uVXRpbHMuZ2V0Um9sZXNTZXJ2aWNlKCkuZmx1c2hSb2xlcygpO1xuICB9XG5cbiAgc3RhdGljIGNsZWFyUGVybWlzc2lvbigpIHtcbiAgICBQZXJtaXNzaW9uVXRpbHMuZ2V0UGVybWlzc2lvbnNTZXJ2aWNlKCkuZmx1c2hQZXJtaXNzaW9ucygpO1xuICB9XG59XG4iXX0=