/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { BrowserOsUtils, CommonsUtils, ConfigUtils } from '@er/utils';
import { HTTP_STATE$, ROUTE_STATE$ } from '../../states/all';
import { AuthUtils } from '../../utils/auth';
import { PermissionUtils } from '../../utils/permission';
/**
 * @abstract
 */
export class AppConfigComponent {
    /**
     * @param {?} rootViewContainerRef
     */
    constructor(rootViewContainerRef) {
        this.rootViewContainerRef = rootViewContainerRef;
    }
    /**
     * @return {?}
     */
    get loadingClass() {
        return ConfigUtils.getConfig().onLoading;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        /** @type {?} */
        const browserSupport = BrowserOsUtils.checkBrowser();
        this.resolveBrowserSupport(browserSupport);
        ConfigUtils.configApp(this.appConfig());
        setTimeout(() => {
            this.httpState$ = HTTP_STATE$;
            this.routeState$ = ROUTE_STATE$;
        }, 0);
        /** @type {?} */
        const user = AuthUtils.getCurrentUser();
        if (!CommonsUtils.isEmpty(user)) {
            PermissionUtils.addPermissions(user.permissions);
            PermissionUtils.addRoles(user.roles);
            if (user.roles && ConfigUtils.getConfig().auth.defaultRules) {
                PermissionUtils.addRoles(ConfigUtils.getConfig().auth.defaultRules);
            }
        }
    }
    /**
     * @param {?} browserSupport
     * @return {?}
     */
    resolveBrowserSupport(browserSupport) {
        if (!browserSupport.version) {
            alert('当前浏览器版本太低，请升级浏览器!');
        }
        else if (!browserSupport.features) {
            alert('当前浏览器功能不全，请更换浏览器!');
        }
    }
}
if (false) {
    /** @type {?} */
    AppConfigComponent.prototype.httpState$;
    /** @type {?} */
    AppConfigComponent.prototype.routeState$;
    /** @type {?} */
    AppConfigComponent.prototype.inValidBrowser;
    /** @type {?} */
    AppConfigComponent.prototype.rootViewContainerRef;
    /**
     * @abstract
     * @return {?}
     */
    AppConfigComponent.prototype.appConfig = function () { };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLWNvbmZpZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZXIvY29yZS8iLCJzb3VyY2VzIjpbImxpYi9iYXNlcy9hYnN0cmFjdC9hcHAtY29uZmlnLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEsT0FBTyxFQUFDLGNBQWMsRUFBa0IsWUFBWSxFQUFFLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUVwRixPQUFPLEVBQUMsV0FBVyxFQUFFLFlBQVksRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQzNELE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUMzQyxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sd0JBQXdCLENBQUM7Ozs7QUFFdkQsTUFBTSxPQUFnQixrQkFBa0I7Ozs7SUFRdEMsWUFBbUIsb0JBQXNDO1FBQXRDLHlCQUFvQixHQUFwQixvQkFBb0IsQ0FBa0I7SUFDekQsQ0FBQzs7OztJQUVELElBQUksWUFBWTtRQUNkLE9BQU8sV0FBVyxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsQ0FBQztJQUMzQyxDQUFDOzs7O0lBRUQsUUFBUTs7Y0FDQSxjQUFjLEdBQUcsY0FBYyxDQUFDLFlBQVksRUFBRTtRQUNwRCxJQUFJLENBQUMscUJBQXFCLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDM0MsV0FBVyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUN4QyxVQUFVLENBQUMsR0FBRyxFQUFFO1lBQ2QsSUFBSSxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUM7WUFDOUIsSUFBSSxDQUFDLFdBQVcsR0FBRyxZQUFZLENBQUM7UUFDbEMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDOztjQUNBLElBQUksR0FBRyxTQUFTLENBQUMsY0FBYyxFQUFFO1FBQ3ZDLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQy9CLGVBQWUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ2pELGVBQWUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3JDLElBQUksSUFBSSxDQUFDLEtBQUssSUFBSSxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRTtnQkFDM0QsZUFBZSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO2FBQ3JFO1NBQ0Y7SUFDSCxDQUFDOzs7OztJQUVELHFCQUFxQixDQUFDLGNBQThCO1FBQ2xELElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFO1lBQzNCLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1NBQzVCO2FBQU0sSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLEVBQUU7WUFDbkMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUM7U0FDNUI7SUFDSCxDQUFDO0NBS0Y7OztJQTFDQyx3Q0FBZ0M7O0lBRWhDLHlDQUFpQzs7SUFFakMsNENBQXdCOztJQUVaLGtEQUE2Qzs7Ozs7SUFpQ3pELHlEQUFrQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7T25Jbml0LCBWaWV3Q29udGFpbmVyUmVmfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Q29uZmlnTW9kZWx9IGZyb20gJ0Blci90eXBlcyc7XG5pbXBvcnQge0Jyb3dzZXJPc1V0aWxzLCBCcm93c2VyU3VwcG9ydCwgQ29tbW9uc1V0aWxzLCBDb25maWdVdGlsc30gZnJvbSAnQGVyL3V0aWxzJztcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0hUVFBfU1RBVEUkLCBST1VURV9TVEFURSR9IGZyb20gJy4uLy4uL3N0YXRlcy9hbGwnO1xuaW1wb3J0IHtBdXRoVXRpbHN9IGZyb20gJy4uLy4uL3V0aWxzL2F1dGgnO1xuaW1wb3J0IHtQZXJtaXNzaW9uVXRpbHN9IGZyb20gJy4uLy4uL3V0aWxzL3Blcm1pc3Npb24nO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQXBwQ29uZmlnQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICBodHRwU3RhdGUkOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xuXG4gIHJvdXRlU3RhdGUkOiBPYnNlcnZhYmxlPGJvb2xlYW4+O1xuXG4gIGluVmFsaWRCcm93c2VyOiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyByb290Vmlld0NvbnRhaW5lclJlZjogVmlld0NvbnRhaW5lclJlZikge1xuICB9XG5cbiAgZ2V0IGxvYWRpbmdDbGFzcygpIHtcbiAgICByZXR1cm4gQ29uZmlnVXRpbHMuZ2V0Q29uZmlnKCkub25Mb2FkaW5nO1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgY29uc3QgYnJvd3NlclN1cHBvcnQgPSBCcm93c2VyT3NVdGlscy5jaGVja0Jyb3dzZXIoKTtcbiAgICB0aGlzLnJlc29sdmVCcm93c2VyU3VwcG9ydChicm93c2VyU3VwcG9ydCk7XG4gICAgQ29uZmlnVXRpbHMuY29uZmlnQXBwKHRoaXMuYXBwQ29uZmlnKCkpO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5odHRwU3RhdGUkID0gSFRUUF9TVEFURSQ7XG4gICAgICB0aGlzLnJvdXRlU3RhdGUkID0gUk9VVEVfU1RBVEUkO1xuICAgIH0sIDApO1xuICAgIGNvbnN0IHVzZXIgPSBBdXRoVXRpbHMuZ2V0Q3VycmVudFVzZXIoKTtcbiAgICBpZiAoIUNvbW1vbnNVdGlscy5pc0VtcHR5KHVzZXIpKSB7XG4gICAgICBQZXJtaXNzaW9uVXRpbHMuYWRkUGVybWlzc2lvbnModXNlci5wZXJtaXNzaW9ucyk7XG4gICAgICBQZXJtaXNzaW9uVXRpbHMuYWRkUm9sZXModXNlci5yb2xlcyk7XG4gICAgICBpZiAodXNlci5yb2xlcyAmJiBDb25maWdVdGlscy5nZXRDb25maWcoKS5hdXRoLmRlZmF1bHRSdWxlcykge1xuICAgICAgICBQZXJtaXNzaW9uVXRpbHMuYWRkUm9sZXMoQ29uZmlnVXRpbHMuZ2V0Q29uZmlnKCkuYXV0aC5kZWZhdWx0UnVsZXMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlc29sdmVCcm93c2VyU3VwcG9ydChicm93c2VyU3VwcG9ydDogQnJvd3NlclN1cHBvcnQpIHtcbiAgICBpZiAoIWJyb3dzZXJTdXBwb3J0LnZlcnNpb24pIHtcbiAgICAgIGFsZXJ0KCflvZPliY3mtY/op4jlmajniYjmnKzlpKrkvY7vvIzor7fljYfnuqfmtY/op4jlmaghJyk7XG4gICAgfSBlbHNlIGlmICghYnJvd3NlclN1cHBvcnQuZmVhdHVyZXMpIHtcbiAgICAgIGFsZXJ0KCflvZPliY3mtY/op4jlmajlip/og73kuI3lhajvvIzor7fmm7TmjaLmtY/op4jlmaghJyk7XG4gICAgfVxuICB9XG5cbiAgYWJzdHJhY3QgYXBwQ29uZmlnKCk6IENvbmZpZ01vZGVsO1xuXG5cbn1cbiJdfQ==