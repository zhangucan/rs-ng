!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("@angular/common"),require("rxjs/operators")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","rxjs/operators"],factory):factory(global.dynamicComponent={},global.ng.core,global.ng.common,global.Rx)}(this,function(exports,core,common,operators){"use strict";var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}function isFunction(x){return"function"==typeof x}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(value){value&&(new Error).stack;_enable_super_gross_mode_that_will_cause_bad_things=value},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(err){setTimeout(function(){throw err})}var empty={closed:!0,next:function(value){},error:function(err){if(config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)},complete:function(){}},isArray=Array.isArray||function(x){return x&&"number"==typeof x.length};function isObject(x){return null!=x&&"object"==typeof x}var tryCatchTarget,errorObject={e:{}};function tryCatcher(){try{return tryCatchTarget.apply(this,arguments)}catch(e){return errorObject.e=e,errorObject}}function tryCatch(fn){return tryCatchTarget=fn,tryCatcher}var UnsubscriptionError=function(_super){function UnsubscriptionError(errors){var _this=_super.call(this,errors?errors.length+" errors occurred during unsubscription:\n  "+errors.map(function(err,i){return i+1+") "+err.toString()}).join("\n  "):"")||this;return _this.errors=errors,_this.name="UnsubscriptionError",Object.setPrototypeOf(_this,UnsubscriptionError.prototype),_this}return __extends(UnsubscriptionError,_super),UnsubscriptionError}(Error),Subscription=function(){function Subscription(unsubscribe){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,unsubscribe&&(this._unsubscribe=unsubscribe)}var empty;return Subscription.prototype.unsubscribe=function(){var errors,hasErrors=!1;if(!this.closed){var _parent=this._parent,_parents=this._parents,_unsubscribe=this._unsubscribe,_subscriptions=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var index=-1,len=_parents?_parents.length:0;_parent;)_parent.remove(this),_parent=++index<len&&_parents[index]||null;if(isFunction(_unsubscribe))tryCatch(_unsubscribe).call(this)===errorObject&&(hasErrors=!0,errors=errors||(errorObject.e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(errorObject.e.errors):[errorObject.e]));if(isArray(_subscriptions))for(index=-1,len=_subscriptions.length;++index<len;){var sub=_subscriptions[index];if(isObject(sub))if(tryCatch(sub.unsubscribe).call(sub)===errorObject){hasErrors=!0,errors=errors||[];var err=errorObject.e;err instanceof UnsubscriptionError?errors=errors.concat(flattenUnsubscriptionErrors(err.errors)):errors.push(err)}}if(hasErrors)throw new UnsubscriptionError(errors)}},Subscription.prototype.add=function(teardown){if(!teardown||teardown===Subscription.EMPTY)return Subscription.EMPTY;if(teardown===this)return this;var subscription=teardown;switch(typeof teardown){case"function":subscription=new Subscription(teardown);case"object":if(subscription.closed||"function"!=typeof subscription.unsubscribe)return subscription;if(this.closed)return subscription.unsubscribe(),subscription;if("function"!=typeof subscription._addParent){var tmp=subscription;(subscription=new Subscription)._subscriptions=[tmp]}break;default:throw new Error("unrecognized teardown "+teardown+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(subscription),subscription._addParent(this),subscription},Subscription.prototype.remove=function(subscription){var subscriptions=this._subscriptions;if(subscriptions){var subscriptionIndex=subscriptions.indexOf(subscription);-1!==subscriptionIndex&&subscriptions.splice(subscriptionIndex,1)}},Subscription.prototype._addParent=function(parent){var _parent=this._parent,_parents=this._parents;_parent&&_parent!==parent?_parents?-1===_parents.indexOf(parent)&&_parents.push(parent):this._parents=[parent]:this._parent=parent},Subscription.EMPTY=((empty=new Subscription).closed=!0,empty),Subscription}();function flattenUnsubscriptionErrors(errors){return errors.reduce(function(errs,err){return errs.concat(err instanceof UnsubscriptionError?err.errors:err)},[])}var rxSubscriber="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("rxSubscriber"):"@@rxSubscriber",Subscriber=function(_super){function Subscriber(destinationOrNext,error,complete){var _this=_super.call(this)||this;switch(_this.syncErrorValue=null,_this.syncErrorThrown=!1,_this.syncErrorThrowable=!1,_this.isStopped=!1,arguments.length){case 0:_this.destination=empty;break;case 1:if(!destinationOrNext){_this.destination=empty;break}if("object"==typeof destinationOrNext){if(isTrustedSubscriber(destinationOrNext)){var trustedSubscriber=destinationOrNext[rxSubscriber]();_this.syncErrorThrowable=trustedSubscriber.syncErrorThrowable,(_this.destination=trustedSubscriber).add(_this)}else _this.syncErrorThrowable=!0,_this.destination=new SafeSubscriber(_this,destinationOrNext);break}default:_this.syncErrorThrowable=!0,_this.destination=new SafeSubscriber(_this,destinationOrNext,error,complete)}return _this}return __extends(Subscriber,_super),Subscriber.prototype[rxSubscriber]=function(){return this},Subscriber.create=function(next,error,complete){var subscriber=new Subscriber(next,error,complete);return subscriber.syncErrorThrowable=!1,subscriber},Subscriber.prototype.next=function(value){this.isStopped||this._next(value)},Subscriber.prototype.error=function(err){this.isStopped||(this.isStopped=!0,this._error(err))},Subscriber.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},Subscriber.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,_super.prototype.unsubscribe.call(this))},Subscriber.prototype._next=function(value){this.destination.next(value)},Subscriber.prototype._error=function(err){this.destination.error(err),this.unsubscribe()},Subscriber.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},Subscriber.prototype._unsubscribeAndRecycle=function(){var _parent=this._parent,_parents=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=_parent,this._parents=_parents,this},Subscriber}(Subscription),SafeSubscriber=function(_super){function SafeSubscriber(_parentSubscriber,observerOrNext,error,complete){var next,_this=_super.call(this)||this;_this._parentSubscriber=_parentSubscriber;var context=_this;return isFunction(observerOrNext)?next=observerOrNext:observerOrNext&&(next=observerOrNext.next,error=observerOrNext.error,complete=observerOrNext.complete,observerOrNext!==empty&&(isFunction((context=Object.create(observerOrNext)).unsubscribe)&&_this.add(context.unsubscribe.bind(context)),context.unsubscribe=_this.unsubscribe.bind(_this))),_this._context=context,_this._next=next,_this._error=error,_this._complete=complete,_this}return __extends(SafeSubscriber,_super),SafeSubscriber.prototype.next=function(value){if(!this.isStopped&&this._next){var _parentSubscriber=this._parentSubscriber;config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,this._next,value)&&this.unsubscribe():this.__tryOrUnsub(this._next,value)}},SafeSubscriber.prototype.error=function(err){if(!this.isStopped){var _parentSubscriber=this._parentSubscriber,useDeprecatedSynchronousErrorHandling=config.useDeprecatedSynchronousErrorHandling;if(this._error)useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,this._error,err):this.__tryOrUnsub(this._error,err),this.unsubscribe();else if(_parentSubscriber.syncErrorThrowable)useDeprecatedSynchronousErrorHandling?(_parentSubscriber.syncErrorValue=err,_parentSubscriber.syncErrorThrown=!0):hostReportError(err),this.unsubscribe();else{if(this.unsubscribe(),useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}}},SafeSubscriber.prototype.complete=function(){var _this=this;if(!this.isStopped){var _parentSubscriber=this._parentSubscriber;if(this._complete){var wrappedComplete=function(){return _this._complete.call(_this._context)};config.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,wrappedComplete):this.__tryOrUnsub(wrappedComplete),this.unsubscribe()}else this.unsubscribe()}},SafeSubscriber.prototype.__tryOrUnsub=function(fn,value){try{fn.call(this._context,value)}catch(err){if(this.unsubscribe(),config.useDeprecatedSynchronousErrorHandling)throw err;hostReportError(err)}},SafeSubscriber.prototype.__tryOrSetError=function(parent,fn,value){if(!config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{fn.call(this._context,value)}catch(err){return config.useDeprecatedSynchronousErrorHandling?(parent.syncErrorValue=err,parent.syncErrorThrown=!0):(hostReportError(err),!0)}return!1},SafeSubscriber.prototype._unsubscribe=function(){var _parentSubscriber=this._parentSubscriber;this._context=null,this._parentSubscriber=null,_parentSubscriber.unsubscribe()},SafeSubscriber}(Subscriber);function isTrustedSubscriber(obj){return obj instanceof Subscriber||"syncErrorThrowable"in obj&&obj[rxSubscriber]}var observable="function"==typeof Symbol&&Symbol.observable||"@@observable";function noop(){}var Observable=function(){function Observable(subscribe){this._isScalar=!1,subscribe&&(this._subscribe=subscribe)}return Observable.prototype.lift=function(operator){var observable$$1=new Observable;return observable$$1.source=this,observable$$1.operator=operator,observable$$1},Observable.prototype.subscribe=function(observerOrNext,error,complete){var operator=this.operator,sink=function(nextOrObserver,error,complete){if(nextOrObserver){if(nextOrObserver instanceof Subscriber)return nextOrObserver;if(nextOrObserver[rxSubscriber])return nextOrObserver[rxSubscriber]()}return nextOrObserver||error||complete?new Subscriber(nextOrObserver,error,complete):new Subscriber(empty)}(observerOrNext,error,complete);if(operator?operator.call(sink,this.source):sink.add(this.source||!sink.syncErrorThrowable?this._subscribe(sink):this._trySubscribe(sink)),config.useDeprecatedSynchronousErrorHandling&&sink.syncErrorThrowable&&(sink.syncErrorThrowable=!1,sink.syncErrorThrown))throw sink.syncErrorValue;return sink},Observable.prototype._trySubscribe=function(sink){try{return this._subscribe(sink)}catch(err){config.useDeprecatedSynchronousErrorHandling&&(sink.syncErrorThrown=!0,sink.syncErrorValue=err),sink.error(err)}},Observable.prototype.forEach=function(next,promiseCtor){var _this=this;return new(promiseCtor=getPromiseCtor(promiseCtor))(function(resolve,reject){var subscription;subscription=_this.subscribe(function(value){try{next(value)}catch(err){reject(err),subscription&&subscription.unsubscribe()}},reject,resolve)})},Observable.prototype._subscribe=function(subscriber){var source=this.source;return source&&source.subscribe(subscriber)},Observable.prototype[observable]=function(){return this},Observable.prototype.pipe=function(){for(var fns,operations=[],_i=0;_i<arguments.length;_i++)operations[_i]=arguments[_i];return 0===operations.length?this:((fns=operations)?1===fns.length?fns[0]:function(input){return fns.reduce(function(prev,fn){return fn(prev)},input)}:noop)(this)},Observable.prototype.toPromise=function(promiseCtor){var _this=this;return new(promiseCtor=getPromiseCtor(promiseCtor))(function(resolve,reject){var value;_this.subscribe(function(x){return value=x},function(err){return reject(err)},function(){return resolve(value)})})},Observable.create=function(subscribe){return new Observable(subscribe)},Observable}();function getPromiseCtor(promiseCtor){if(promiseCtor||(promiseCtor=config.Promise||Promise),!promiseCtor)throw new Error("no Promise impl found");return promiseCtor}var ObjectUnsubscribedError=function(_super){function ObjectUnsubscribedError(){var _this=_super.call(this,"object unsubscribed")||this;return _this.name="ObjectUnsubscribedError",Object.setPrototypeOf(_this,ObjectUnsubscribedError.prototype),_this}return __extends(ObjectUnsubscribedError,_super),ObjectUnsubscribedError}(Error),SubjectSubscription=function(_super){function SubjectSubscription(subject,subscriber){var _this=_super.call(this)||this;return _this.subject=subject,_this.subscriber=subscriber,_this.closed=!1,_this}return __extends(SubjectSubscription,_super),SubjectSubscription.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var subject=this.subject,observers=subject.observers;if(this.subject=null,observers&&0!==observers.length&&!subject.isStopped&&!subject.closed){var subscriberIndex=observers.indexOf(this.subscriber);-1!==subscriberIndex&&observers.splice(subscriberIndex,1)}}},SubjectSubscription}(Subscription),SubjectSubscriber=function(_super){function SubjectSubscriber(destination){var _this=_super.call(this,destination)||this;return _this.destination=destination,_this}return __extends(SubjectSubscriber,_super),SubjectSubscriber}(Subscriber),Subject=function(_super){function Subject(){var _this=_super.call(this)||this;return _this.observers=[],_this.closed=!1,_this.isStopped=!1,_this.hasError=!1,_this.thrownError=null,_this}return __extends(Subject,_super),Subject.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},Subject.prototype.lift=function(operator){var subject=new AnonymousSubject(this,this);return subject.operator=operator,subject},Subject.prototype.next=function(value){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var observers=this.observers,len=observers.length,copy=observers.slice(),i=0;i<len;i++)copy[i].next(value)},Subject.prototype.error=function(err){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=err,this.isStopped=!0;for(var observers=this.observers,len=observers.length,copy=observers.slice(),i=0;i<len;i++)copy[i].error(err);this.observers.length=0},Subject.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var observers=this.observers,len=observers.length,copy=observers.slice(),i=0;i<len;i++)copy[i].complete();this.observers.length=0},Subject.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},Subject.prototype._trySubscribe=function(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return _super.prototype._trySubscribe.call(this,subscriber)},Subject.prototype._subscribe=function(subscriber){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(subscriber.error(this.thrownError),Subscription.EMPTY):this.isStopped?(subscriber.complete(),Subscription.EMPTY):(this.observers.push(subscriber),new SubjectSubscription(this,subscriber))},Subject.prototype.asObservable=function(){var observable=new Observable;return observable.source=this,observable},Subject.create=function(destination,source){return new AnonymousSubject(destination,source)},Subject}(Observable),AnonymousSubject=function(_super){function AnonymousSubject(destination,source){var _this=_super.call(this)||this;return _this.destination=destination,_this.source=source,_this}return __extends(AnonymousSubject,_super),AnonymousSubject.prototype.next=function(value){var destination=this.destination;destination&&destination.next&&destination.next(value)},AnonymousSubject.prototype.error=function(err){var destination=this.destination;destination&&destination.error&&this.destination.error(err)},AnonymousSubject.prototype.complete=function(){var destination=this.destination;destination&&destination.complete&&this.destination.complete()},AnonymousSubject.prototype._subscribe=function(subscriber){return this.source?this.source.subscribe(subscriber):Subscription.EMPTY},AnonymousSubject}(Subject);Error,Error,Error;var COMPONENT_INJECTOR=new core.InjectionToken("ComponentInjector"),ComponentOutletInjectorDirective=function(){function ComponentOutletInjectorDirective(componentOutlet){this.componentOutlet=componentOutlet}return Object.defineProperty(ComponentOutletInjectorDirective.prototype,"componentRef",{get:function(){return this.componentOutlet._componentRef},enumerable:!0,configurable:!0}),ComponentOutletInjectorDirective}();ComponentOutletInjectorDirective.decorators=[{type:core.Directive,args:[{selector:"[ngComponentOutlet]",exportAs:"ndcComponentOutletInjector"}]}],ComponentOutletInjectorDirective.ctorParameters=function(){return[{type:common.NgComponentOutlet,decorators:[{type:core.Host}]}]};var DynamicAttributesDirective=function(){function DynamicAttributesDirective(renderer,differs,injector,componentInjectorType,componentOutletInjector){this.renderer=renderer,this.differs=differs,this.injector=injector,this.componentInjectorType=componentInjectorType,this.componentOutletInjector=componentOutletInjector,this._attrsDiffer=this.differs.find({}).create(),this._componentInjector=this.injector.get(this.componentInjectorType,null)}return Object.defineProperty(DynamicAttributesDirective.prototype,"_attributes",{get:function(){return this.ndcDynamicAttributes||this.ngComponentOutletNdcDynamicAttributes},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicAttributesDirective.prototype,"_compInjector",{get:function(){return this.componentOutletInjector||this._componentInjector},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicAttributesDirective.prototype,"_nativeElement",{get:function(){return this._compInjector.componentRef&&this._compInjector.componentRef.location.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicAttributesDirective.prototype,"_compType",{get:function(){return this._compInjector.componentRef&&this._compInjector.componentRef.componentType},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicAttributesDirective.prototype,"_isCompChanged",{get:function(){return this._lastCompType!==this._compType&&(this._lastCompType=this._compType,!0)},enumerable:!0,configurable:!0}),DynamicAttributesDirective.prototype.ngDoCheck=function(){var isCompChanged=this._isCompChanged,changes=this._attrsDiffer.diff(this._attributes);changes&&(this._lastAttrActions=this._changesToAttrActions(changes)),(changes||isCompChanged&&this._lastAttrActions)&&this._updateAttributes(this._lastAttrActions)},DynamicAttributesDirective.prototype.setAttribute=function(name,value,namespace){this._nativeElement&&this.renderer.setAttribute(this._nativeElement,name,value,namespace)},DynamicAttributesDirective.prototype.removeAttribute=function(name,namespace){this._nativeElement&&this.renderer.removeAttribute(this._nativeElement,name,namespace)},DynamicAttributesDirective.prototype._updateAttributes=function(actions){var _this=this;this._compType&&(Object.keys(actions.set).forEach(function(key){return _this.setAttribute(key,actions.set[key])}),actions.remove.forEach(function(key){return _this.removeAttribute(key)}))},DynamicAttributesDirective.prototype._changesToAttrActions=function(changes){var attrActions={set:{},remove:[]};return changes.forEachAddedItem(function(r){return attrActions.set[r.key]=r.currentValue}),changes.forEachChangedItem(function(r){return attrActions.set[r.key]=r.currentValue}),changes.forEachRemovedItem(function(r){return attrActions.remove.push(r.key)}),attrActions},DynamicAttributesDirective}();function createNewChange(val){return new core.SimpleChange(void 0,val,!0)}function setChangeFromRecord(isFirstChanges,setter){return function(record){return setter(record,function(record,isFirstChange){return void 0===isFirstChange&&(isFirstChange=!1),isFirstChange?createNewChange(record.currentValue):new core.SimpleChange(record.previousValue,record.currentValue,!1)}(record,isFirstChanges))}}DynamicAttributesDirective.decorators=[{type:core.Directive,args:[{selector:"[ndcDynamicAttributes],[ngComponentOutletNdcDynamicAttributes]",exportAs:"ndcDynamicAttributes"}]}],DynamicAttributesDirective.ctorParameters=function(){return[{type:core.Renderer2},{type:core.KeyValueDiffers},{type:core.Injector},{type:void 0,decorators:[{type:core.Inject,args:[COMPONENT_INJECTOR]}]},{type:ComponentOutletInjectorDirective,decorators:[{type:core.Optional},{type:core.Host}]}]};var defaultOpts={isFirstChanges:!(DynamicAttributesDirective.propDecorators={ndcDynamicAttributes:[{type:core.Input}],ngComponentOutletNdcDynamicAttributes:[{type:core.Input}]}),onlyNewChanges:!1};function changesFromRecord(opts){return void 0===opts&&(opts=defaultOpts),opts.onlyNewChanges?(isFirstChanges=opts.isFirstChanges,function(changes){return setChangeFromRecord(isFirstChanges,function(record,change){changes[record.key]||(changes[record.key]=change)})}):function(isFirstChanges){return function(changes){return setChangeFromRecord(isFirstChanges,function(record,change){return changes[record.key]=change})}}(opts.isFirstChanges);var isFirstChanges}function noop$1(){}var recordToChanges=changesFromRecord({isFirstChanges:!0}),recordToNewChanges=changesFromRecord({onlyNewChanges:!0}),IoService=function(){function IoService(_differs,_cfr){this._differs=_differs,this._cfr=_cfr,this.checkInit=this.failInit,this._lastComponentInst=null,this._inputsDiffer=this._differs.find({}).create(),this._compFactory=null,this._outputsShouldDisconnect$=new Subject,this._outputsChanged=function(){return!1}}return Object.defineProperty(IoService.prototype,"_compRef",{get:function(){return this._compInjector.componentRef},enumerable:!0,configurable:!0}),Object.defineProperty(IoService.prototype,"_componentInst",{get:function(){return this._compRef?this._compRef.instance:null},enumerable:!0,configurable:!0}),Object.defineProperty(IoService.prototype,"_componentInstChanged",{get:function(){return this._lastComponentInst!==this._componentInst&&(this._lastComponentInst=this._componentInst,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(IoService.prototype,"_compCdr",{get:function(){return this._compRef?this._compRef.injector.get(core.ChangeDetectorRef):null},enumerable:!0,configurable:!0}),IoService.prototype.ngOnDestroy=function(){this._disconnectOutputs()},IoService.prototype.init=function(componentInjector,options){if(void 0===options&&(options={}),this.checkInit=componentInjector?noop$1:this.failInit,this._compInjector=componentInjector,options.trackOutputChanges){var outputsDiffer_1=this._differs.find({}).create();this._outputsChanged=function(outputs){return!!outputsDiffer_1.diff(outputs)}}},IoService.prototype.update=function(inputs,outputs,inputsChanged,outputsChanged){this.checkInit(),this.updateIO(inputs,outputs);var compChanged=this._componentInstChanged;if(compChanged||inputsChanged){var inputsChanges=this._getInputsChanges(this._inputs);inputsChanges&&this._updateInputChanges(inputsChanges),this.updateInputs(compChanged||!this._lastInputChanges)}(compChanged||outputsChanged)&&this.bindOutputs()},IoService.prototype.maybeUpdate=function(){if(this.checkInit(),this._componentInstChanged)return this.updateInputs(!0),void this.bindOutputs();if(this._outputsChanged(this._outputs)&&this.bindOutputs(),this._inputs){var inputsChanges=this._getInputsChanges(this._inputs);if(inputsChanges){var isNotFirstChange=!!this._lastInputChanges;this._updateInputChanges(inputsChanges),isNotFirstChange&&this.updateInputs()}}},IoService.prototype.updateIO=function(inputs,outputs){this._inputs=inputs,this._outputs=outputs},IoService.prototype.updateInputs=function(isFirstChange){void 0===isFirstChange&&(isFirstChange=!1),isFirstChange&&this._updateCompFactory();var compInst=this._componentInst,inputs=this._inputs;inputs&&compInst&&(inputs=this._resolveInputs(inputs),Object.keys(inputs).forEach(function(p){return compInst[p]=inputs[p]}),this._compCdr&&this._compCdr.markForCheck(),this.notifyOnInputChanges(this._lastInputChanges,isFirstChange))},IoService.prototype.bindOutputs=function(){var _this=this;this._disconnectOutputs();var compInst=this._componentInst,outputs=this._outputs;outputs&&compInst&&(outputs=this._resolveOutputs(outputs),Object.keys(outputs).filter(function(p){return compInst[p]}).forEach(function(p){return compInst[p].pipe(operators.takeUntil(_this._outputsShouldDisconnect$)).subscribe(outputs[p])}))},IoService.prototype.notifyOnInputChanges=function(changes,forceFirstChanges){void 0===changes&&(changes={}),this._componentInst.ngOnChanges&&(forceFirstChanges&&(changes=this._collectFirstChanges()),this._componentInst.ngOnChanges(changes))},IoService.prototype._disconnectOutputs=function(){this._outputsShouldDisconnect$.next()},IoService.prototype._getInputsChanges=function(inputs){return this._inputsDiffer.diff(this._inputs)},IoService.prototype._updateInputChanges=function(differ){this._lastInputChanges=this._collectChangesFromDiffer(differ)},IoService.prototype._collectFirstChanges=function(){var changes={},inputs=this._inputs;return Object.keys(inputs).forEach(function(prop){return changes[prop]=createNewChange(inputs[prop])}),this._resolveChanges(changes)},IoService.prototype._collectChangesFromDiffer=function(differ){var changes={};return differ.forEachAddedItem(recordToChanges(changes)),differ.forEachItem(recordToNewChanges(changes)),this._resolveChanges(changes)},IoService.prototype._resolveCompFactory=function(){try{try{return this._cfr.resolveComponentFactory(this._compRef.componentType)}catch(e){return this._cfr.resolveComponentFactory(this._compRef.instance.constructor)}}catch(e){return null}},IoService.prototype._updateCompFactory=function(){this._compFactory=this._resolveCompFactory()},IoService.prototype._resolveInputs=function(inputs){return this._compFactory?this._remapIO(inputs,this._compFactory.inputs):inputs},IoService.prototype._resolveOutputs=function(outputs){return this._compFactory?this._remapIO(outputs,this._compFactory.outputs):outputs},IoService.prototype._resolveChanges=function(changes){return this._compFactory?this._remapIO(changes,this._compFactory.inputs):changes},IoService.prototype._remapIO=function(io,mapping){var _this=this,newIO={};return Object.keys(io).forEach(function(key){var newKey=_this._findPropByTplInMapping(key,mapping)||key;newIO[newKey]=io[key]}),newIO},IoService.prototype._findPropByTplInMapping=function(tplName,mapping){for(var _i=0,mapping_1=mapping;_i<mapping_1.length;_i++){var map=mapping_1[_i];if(map.templateName===tplName)return map.propName}return null},IoService.prototype.failInit=function(){throw Error("IoService: ComponentInjector was not set! Please call init() method!")},IoService}();IoService.decorators=[{type:core.Injectable}],IoService.ctorParameters=function(){return[{type:core.KeyValueDiffers},{type:core.ComponentFactoryResolver}]};var IoFactoryService=function(){function IoFactoryService(differs,cfr){this.differs=differs,this.cfr=cfr}return IoFactoryService.prototype.create=function(){return new IoService(this.differs,this.cfr)},IoFactoryService}();IoFactoryService.decorators=[{type:core.Injectable}],IoFactoryService.ctorParameters=function(){return[{type:core.KeyValueDiffers},{type:core.ComponentFactoryResolver}]};var WINDOW_REF=new core.InjectionToken("WindowRef"),WindowRefService=function(injector){this.injector=injector,this.nativeWindow=this.injector.get(WINDOW_REF,null)};WindowRefService.decorators=[{type:core.Injectable}],WindowRefService.ctorParameters=function(){return[{type:core.Injector}]};var DynamicDirectivesDirective=function(){function DynamicDirectivesDirective(injector,iterableDiffers,ioFactoryService,windowRef,componentInjectorType,componentOutletInjector){this.injector=injector,this.iterableDiffers=iterableDiffers,this.ioFactoryService=ioFactoryService,this.windowRef=windowRef,this.componentInjectorType=componentInjectorType,this.componentOutletInjector=componentOutletInjector,this.ndcDynamicDirectivesCreated=new core.EventEmitter,this.componentInjector=this.injector.get(this.componentInjectorType,null),this.dirRef=new Map,this.dirIo=new Map,this.dirsDiffer=this.iterableDiffers.find([]).create(function(_,def){return def.type})}return Object.defineProperty(DynamicDirectivesDirective.prototype,"directives",{get:function(){return this.ndcDynamicDirectives||this.ngComponentOutletNdcDynamicDirectives},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"compInjector",{get:function(){return this.componentOutletInjector||this.componentInjector},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"componentRef",{get:function(){return this.compInjector.componentRef},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"compInstance",{get:function(){return this.componentRef&&this.componentRef.instance},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"isCompChanged",{get:function(){return this.lastCompInstance!==this.compInstance&&(this.lastCompInstance=this.compInstance,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"hostInjector",{get:function(){return this.componentRef.injector},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"hostVcr",{get:function(){return this.componentRef._viewRef._viewContainerRef},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirectivesDirective.prototype,"reflect",{get:function(){return this.windowRef.nativeWindow.Reflect},enumerable:!0,configurable:!0}),DynamicDirectivesDirective.prototype.ngDoCheck=function(){if(!this.maybeDestroyDirectives()){var dirsChanges=this.dirsDiffer.diff(this.directives);if(!dirsChanges)return this.updateDirectives();this.processDirChanges(dirsChanges)}},DynamicDirectivesDirective.prototype.ngOnDestroy=function(){this.destroyAllDirectives()},DynamicDirectivesDirective.prototype.maybeDestroyDirectives=function(){return!this.isCompChanged&&this.componentRef||(this.dirsDiffer.diff([]),this.destroyAllDirectives()),!this.componentRef},DynamicDirectivesDirective.prototype.processDirChanges=function(changes){var _this=this;changes.forEachRemovedItem(function(_a){var item=_a.item;return _this.destroyDirective(item)});var createdDirs=[];changes.forEachAddedItem(function(_a){var item=_a.item;return createdDirs.push(_this.initDirective(item))}),createdDirs.length&&this.ndcDynamicDirectivesCreated.emit(createdDirs.filter(Boolean))},DynamicDirectivesDirective.prototype.updateDirectives=function(){var _this=this;this.directives.forEach(function(dir){return _this.updateDirective(dir)})},DynamicDirectivesDirective.prototype.updateDirective=function(dirDef){var io=this.dirIo.get(dirDef.type);io.update(dirDef.inputs,dirDef.outputs,!1,!1),io.maybeUpdate()},DynamicDirectivesDirective.prototype.initDirective=function(dirDef){if(!this.dirRef.has(dirDef.type)){var instance=this.createDirective(dirDef.type),dir={instance:instance,type:dirDef.type,injector:this.hostInjector,hostComponent:this.componentRef.instance,hostView:this.componentRef.hostView,location:this.componentRef.location,changeDetectorRef:this.componentRef.changeDetectorRef,onDestroy:this.componentRef.onDestroy};return this.initDirIO(dir,dirDef.inputs,dirDef.outputs),this.callInitHooks(instance),this.dirRef.set(dir.type,dir),dir}},DynamicDirectivesDirective.prototype.destroyAllDirectives=function(){var _this=this;this.dirRef.forEach(function(dir){return _this.destroyDirRef(dir)}),this.dirRef.clear(),this.dirIo.clear()},DynamicDirectivesDirective.prototype.destroyDirective=function(dirDef){this.destroyDirRef(this.dirRef.get(dirDef.type)),this.dirRef.delete(dirDef.type),this.dirIo.delete(dirDef.type)},DynamicDirectivesDirective.prototype.initDirIO=function(dir,inputs,outputs){var io=this.ioFactoryService.create();io.init({componentRef:this.dirToCompDef(dir)},{trackOutputChanges:!0}),io.update(inputs,outputs,!!inputs,!!outputs),this.dirIo.set(dir.type,io)},DynamicDirectivesDirective.prototype.dirToCompDef=function(dir){return Object.assign({},this.componentRef,{destroy:this.componentRef.destroy,onDestroy:this.componentRef.onDestroy,injector:this.componentRef.injector,instance:dir.instance,componentType:dir.type})},DynamicDirectivesDirective.prototype.destroyDirRef=function(dir){this.dirIo.get(dir.type).ngOnDestroy(),"ngOnDestroy"in dir.instance&&dir.instance.ngOnDestroy()},DynamicDirectivesDirective.prototype.createDirective=function(dirType){var ctor,_this=this,resolvedParams=(ctor=dirType,this.reflect.getMetadata("design:paramtypes",ctor)).map(function(p){return _this.resolveDep(p)});return new(dirType.bind.apply(dirType,[void 0].concat(resolvedParams)))},DynamicDirectivesDirective.prototype.resolveDep=function(dep){return this.maybeResolveVCR(dep)||this.hostInjector.get(dep)},DynamicDirectivesDirective.prototype.maybeResolveVCR=function(dep){if(dep===core.ViewContainerRef)return this.hostVcr},DynamicDirectivesDirective.prototype.callInitHooks=function(obj){this.callHook(obj,"ngOnInit"),this.callHook(obj,"ngDoCheck"),this.callHook(obj,"ngAfterContentInit"),this.callHook(obj,"ngAfterContentChecked"),this.callHook(obj,"ngAfterViewInit"),this.callHook(obj,"ngAfterViewChecked")},DynamicDirectivesDirective.prototype.callHook=function(obj,hook,args){void 0===args&&(args=[]),obj[hook]&&obj[hook].apply(obj,args)},DynamicDirectivesDirective}();DynamicDirectivesDirective.decorators=[{type:core.Directive,args:[{selector:"[ndcDynamicDirectives],[ngComponentOutletNdcDynamicDirectives]"}]}],DynamicDirectivesDirective.ctorParameters=function(){return[{type:core.Injector},{type:core.IterableDiffers},{type:IoFactoryService},{type:WindowRefService},{type:void 0,decorators:[{type:core.Inject,args:[COMPONENT_INJECTOR]}]},{type:ComponentOutletInjectorDirective,decorators:[{type:core.Host},{type:core.Optional}]}]},DynamicDirectivesDirective.propDecorators={ndcDynamicDirectives:[{type:core.Input}],ngComponentOutletNdcDynamicDirectives:[{type:core.Input}],ndcDynamicDirectivesCreated:[{type:core.Output}]};var DynamicComponent=function(){function DynamicComponent(_vcr,_cfr){this._vcr=_vcr,this._cfr=_cfr,this.ndcDynamicCreated=new core.EventEmitter}return DynamicComponent.prototype.ngOnChanges=function(changes){changes.ndcDynamicComponent&&this.createDynamicComponent()},DynamicComponent.prototype.createDynamicComponent=function(){this._vcr.clear(),this.componentRef=null,this.ndcDynamicComponent&&(this.componentRef=this._vcr.createComponent(this._cfr.resolveComponentFactory(this.ndcDynamicComponent),0,this._resolveInjector(),this.ndcDynamicContent),this.ndcDynamicCreated.emit(this.componentRef))},DynamicComponent.prototype._resolveInjector=function(){var injector=this.ndcDynamicInjector||this._vcr.parentInjector;return this.ndcDynamicProviders&&(injector=core.Injector.create({providers:this.ndcDynamicProviders,parent:injector})),injector},DynamicComponent}();DynamicComponent.decorators=[{type:core.Component,args:[{selector:"ndc-dynamic",template:""}]}],DynamicComponent.ctorParameters=function(){return[{type:core.ViewContainerRef},{type:core.ComponentFactoryResolver}]},DynamicComponent.propDecorators={ndcDynamicComponent:[{type:core.Input}],ndcDynamicInjector:[{type:core.Input}],ndcDynamicProviders:[{type:core.Input}],ndcDynamicContent:[{type:core.Input}],ndcDynamicCreated:[{type:core.Output}]};var DynamicDirective=function(){function DynamicDirective(_injector,ioService,_componentInjectorType,_componentOutletInjector){this._injector=_injector,this.ioService=ioService,this._componentInjectorType=_componentInjectorType,this._componentOutletInjector=_componentOutletInjector,this._componentInjector=this._injector.get(this._componentInjectorType,null),this.ioService.init(this._compInjector)}return Object.defineProperty(DynamicDirective.prototype,"_inputs",{get:function(){return this.ndcDynamicInputs||this.ngComponentOutletNdcDynamicInputs},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirective.prototype,"_outputs",{get:function(){return this.ndcDynamicOutputs||this.ngComponentOutletNdcDynamicOutputs},enumerable:!0,configurable:!0}),Object.defineProperty(DynamicDirective.prototype,"_compInjector",{get:function(){return this._componentOutletInjector||this._componentInjector},enumerable:!0,configurable:!0}),DynamicDirective.prototype.ngOnChanges=function(changes){this.ioService.update(this._inputs,this._outputs,this._inputsChanged(changes),this._outputsChanged(changes))},DynamicDirective.prototype.ngDoCheck=function(){this.ioService.maybeUpdate()},DynamicDirective.prototype._inputsChanged=function(changes){return"ngComponentOutletNdcDynamicInputs"in changes||"ndcDynamicInputs"in changes},DynamicDirective.prototype._outputsChanged=function(changes){return"ngComponentOutletNdcDynamicOutputs"in changes||"ndcDynamicOutputs"in changes},DynamicDirective}();function windowRefFactory(){return window}DynamicDirective.decorators=[{type:core.Directive,args:[{selector:"[ndcDynamicInputs],[ndcDynamicOutputs],[ngComponentOutletNdcDynamicInputs],[ngComponentOutletNdcDynamicOutputs]",providers:[IoService]}]}],DynamicDirective.ctorParameters=function(){return[{type:core.Injector},{type:IoService},{type:void 0,decorators:[{type:core.Inject,args:[COMPONENT_INJECTOR]}]},{type:ComponentOutletInjectorDirective,decorators:[{type:core.Host},{type:core.Optional}]}]},DynamicDirective.propDecorators={ndcDynamicInputs:[{type:core.Input}],ngComponentOutletNdcDynamicInputs:[{type:core.Input}],ndcDynamicOutputs:[{type:core.Input}],ngComponentOutletNdcDynamicOutputs:[{type:core.Input}]};var DynamicModule=function(){function DynamicModule(){}return DynamicModule.withComponents=function(components,componentInjector){return void 0===componentInjector&&(componentInjector=DynamicComponent),{ngModule:DynamicModule,providers:[{provide:core.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:components,multi:!0},{provide:COMPONENT_INJECTOR,useValue:componentInjector},IoFactoryService,{provide:WINDOW_REF,useFactory:windowRefFactory},WindowRefService]}},DynamicModule}();DynamicModule.decorators=[{type:core.NgModule,args:[{imports:[common.CommonModule],declarations:[DynamicComponent,DynamicDirective,ComponentOutletInjectorDirective,DynamicAttributesDirective,DynamicDirectivesDirective],exports:[DynamicComponent,DynamicDirective,ComponentOutletInjectorDirective,DynamicAttributesDirective,DynamicDirectivesDirective]}]}],exports.windowRefFactory=windowRefFactory,exports.DynamicModule=DynamicModule,exports.DynamicDirective=DynamicDirective,exports.DynamicComponent=DynamicComponent,exports.DynamicAttributesDirective=DynamicAttributesDirective,exports.dynamicDirectiveDef=function(type,inputs,outputs){return{type:type,inputs:inputs,outputs:outputs}},exports.DynamicDirectivesDirective=DynamicDirectivesDirective,exports.ɵa=COMPONENT_INJECTOR,exports.ɵc=ComponentOutletInjectorDirective,exports.ɵd=IoFactoryService,exports.ɵb=IoService,exports.ɵe=WINDOW_REF,exports.ɵf=WindowRefService,Object.defineProperty(exports,"__esModule",{value:!0})});